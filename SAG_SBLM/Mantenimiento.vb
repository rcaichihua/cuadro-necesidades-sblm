Imports System.Data.OleDb
Imports System.Data.SqlClient
Imports System.Net
Imports System.Text
Imports Microsoft.Office.Interop
Imports System.Security.Cryptography
Imports CrystalDecisions.CrystalReports.Engine

Public Class Mantenimiento
    Dim Cn As New OleDb.OleDbConnection(My.Settings.Conexion)
    Dim Recorrido As Integer = 0
    Public Sub New()
        Try
            Cn.Open()
        Catch ex As Exception
            Dim Resultado = MessageBox.Show("Existe un Problema en la Conexión a la Base de Datos ¿Deseas Configurar el Acceso?", "..:: Sistema :...", MessageBoxButtons.YesNo, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1)
            Select Case Resultado
                Case DialogResult.Yes
                    Dim Formulario As New frmConfigurar_Base
                    Formulario.ShowDialog()
                Case DialogResult.No
                    End
            End Select
        End Try
    End Sub
    Protected Overrides Sub Finalize()
        MyBase.Finalize()
    End Sub
    Public Function LLenar_DT(ByVal Tabla As String) As DataTable
        Dim DT As New DataTable
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = Tabla
        Dim Das As New OleDb.OleDbDataAdapter
        Das.SelectCommand = Cm
        Das.Fill(DT)
        Return DT
    End Function
    Public Function Verificar_Duplicidad_Grid(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView) As Boolean
        Verificar_Duplicidad_Grid = True
        If Verificar_Duplicidad_Grid = True Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                If Codigo.Trim = DataGridView.Rows(Recorrido).Cells.Item(0).Value Then
                    Verificar_Duplicidad_Grid = False
                End If
            Next
        End If
    End Function
    Public Function Verificar_Duplicidad_Grid_Global(ByVal Columna As Integer, ByVal Dato As String, ByVal DataGridView As System.Windows.Forms.DataGridView) As Boolean
        Verificar_Duplicidad_Grid_Global = True
        If Verificar_Duplicidad_Grid_Global = True Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                If Dato.Trim = DataGridView.Rows(Recorrido).Cells.Item(1).Value & "." & DataGridView.Rows(Recorrido).Cells.Item(2).Value & "." & DataGridView.Rows(Recorrido).Cells.Item(17).Value & "." & DataGridView.Rows(Recorrido).Cells.Item(11).Value Then
                    Verificar_Duplicidad_Grid_Global = False
                End If
            Next
        End If
    End Function
    Public Function Verificar_Duplicidad_Grid_CN(ByVal Columna As Integer, ByVal Dato As String, ByVal DataGridView As System.Windows.Forms.DataGridView) As Boolean
        Verificar_Duplicidad_Grid_CN = True
        If Verificar_Duplicidad_Grid_CN = True Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                If Dato.Trim = DataGridView.Rows(Recorrido).Cells.Item(1).Value & "." & DataGridView.Rows(Recorrido).Cells.Item(2).Value & "." & DataGridView.Rows(Recorrido).Cells.Item(17).Value & "." & DataGridView.Rows(Recorrido).Cells.Item(11).Value Then
                    Verificar_Duplicidad_Grid_CN = False
                End If
            Next
        End If
    End Function
    Public Sub Combo(ByVal Combo As System.Windows.Forms.ComboBox, ByVal Tabla As String, ByVal Campo_Value As String, ByVal Campo_Mostrar As String)
        Dim Da As New OleDb.OleDbDataAdapter(Tabla, Cn)
        Dim Ds As New DataSet
        Da.Fill(Ds)
        Combo.DataSource = Ds.Tables(0)
        Combo.ValueMember = Ds.Tables(0).Columns(Campo_Value).Caption
        Combo.DisplayMember = Ds.Tables(0).Columns(Campo_Mostrar).Caption
    End Sub
    Public Function LLenar_Combo(ByVal Tabla As String, ByVal Control As ComboBox, ByVal Campo_Texto As String) As DataTable
        Dim Dt As New DataTable
        Dt = Llenar_Tabla(Tabla)
        Dim I As Integer
        Control.Items.Clear()
        Control.Items.Add("Todos...")
        If Dt.Rows.Count > 0 Then
            For I = 0 To Dt.Rows.Count - 1
                Control.Items.Add(Dt.Rows(I).Item(Campo_Texto))
            Next I
        End If
        Return Dt
    End Function
    Public Function LLenar_Combo_Solo(ByVal Tabla As String, ByVal Control As ComboBox, ByVal Campo_Texto As String) As DataTable
        Dim Dt As New DataTable
        Dt = Llenar_Tabla(Tabla)
        Dim I As Integer
        Control.Items.Clear()
        If Dt.Rows.Count > 0 Then
            For I = 0 To Dt.Rows.Count - 1
                Control.Items.Add(Dt.Rows(I).Item(Campo_Texto).ToString)
            Next I
        End If
        Return Dt
    End Function
    Public Function Llenar_Tabla(ByVal Tabla As String) As DataTable
        Dim Da As New OleDb.OleDbDataAdapter(Tabla, Cn)
        Dim Dt As New DataTable
        Da.Fill(Dt)
        Return Dt
    End Function
    Public Sub Llamar_Formulario_Unico(ByVal Formulario As Form, ByVal MDI As Form)
        Dim FormularioLlamado As New Form
        Dim EsCargado As Boolean = False
        Try
            For Each FormularioLlamado In MDI.MdiChildren
                If FormularioLlamado.Text = Formulario.Text Then
                    EsCargado = True
                    Exit For
                End If
            Next
            If Not EsCargado Then
                Formulario.MdiParent = MDI
                Formulario.Show()
            ElseIf EsCargado Then
                FormularioLlamado.Focus()
            End If
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Critical, "Error")
        End Try
        Formulario = Nothing
        FormularioLlamado = Nothing
    End Sub
    Public Sub Llenar_Componentes(Optional ByVal TT As String = Nothing, Optional ByVal G As String = Nothing, Optional ByVal SG As String = Nothing, Optional ByVal SGD As String = Nothing, Optional ByVal E As String = Nothing, Optional ByVal ED As String = Nothing, Optional ByVal FF As String = Nothing, Optional ByVal R As String = Nothing, Optional ByVal UO As String = Nothing, Optional ByVal Meta As String = Nothing, Optional ByVal CA As String = Nothing, Optional ByVal Tipo_Recurso As String = Nothing, Optional ByVal Periodo As String = Nothing, Optional ByVal Comprobante As String = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Tipo_Transaccion Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And  Tipo_Transaccion ='" & TT & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Tipo_Transaccion = Ds.Tables(0).Rows(0).Item("Transaccion").ToString
        Else
            Variable_Tipo_Transaccion = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_Genericas Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And Tipo_Transaccion='" & TT & "' And Generica ='" & G & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Generica = Ds.Tables(0).Rows(0).Item("Descripcion").ToString
        Else
            Variable_Generica = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_SubGenericas Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And  Tipo_Transaccion='" & TT & "' And Generica ='" & G & "' And Sub_Generica='" & SG & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_SubGenerica = Ds.Tables(0).Rows(0).Item("Descripcion").ToString
        Else
            Variable_SubGenerica = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_SubGenericas_Detalle Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And  Tipo_Transaccion='" & TT & "' And Generica ='" & G & "' And Sub_Generica='" & SG & "' And Sub_Generica_Detalle='" & SGD & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_SubGenerica_Detalle = Ds.Tables(0).Rows(0).Item("Descripcion").ToString
        Else
            Variable_SubGenerica_Detalle = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_Especificas Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And  Tipo_Transaccion='" & TT & "' And Generica ='" & G & "' And Sub_Generica='" & SG & "' And Sub_Generica_Detalle='" & SGD & "' And Especifica='" & E & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Especifica = Ds.Tables(0).Rows(0).Item("Descripcion").ToString
        Else
            Variable_Especifica = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_Especificas_Detalle Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And  Tipo_Transaccion='" & TT & "' And Generica ='" & G & "' And Sub_Generica='" & SG & "' And Sub_Generica_Detalle='" & SGD & "' And Especifica='" & E & "' And Especifica_Detalle='" & ED & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Especifica_Detalle = Ds.Tables(0).Rows(0).Item("Descripcion").ToString
        Else
            Variable_Especifica_Detalle = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_FF Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And  Codigo_FF='" & FF & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_FF = Ds.Tables(0).Rows(0).Item("Fuente").ToString
        Else
            Variable_FF = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_Rubros Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And Codigo_FF='" & FF & "' And Codigo_Rubro='" & R & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Rubro = Ds.Tables(0).Rows(0).Item("Rubro").ToString
        Else
            Variable_Rubro = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Unidad_Organica Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And Codigo_Unidad_Organica='" & UO & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Unidad_Organica = Ds.Tables(0).Rows(0).Item("Nombre_Unidad_Organica").ToString
            Variable_Abreviatura_Unidad_Organica = Ds.Tables(0).Rows(0).Item("Abreviatura").ToString
        Else
            Variable_Unidad_Organica = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_Secuencias Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And Codigo_Unidad_Organica='" & UO & "' And Codigo_Secuencia_Funcional='" & Meta & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Secuencia_Funcional = Ds.Tables(0).Rows(0).Item("Codigo_Secuencia_Funcional").ToString
        Else
            Variable_Secuencia_Funcional = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_Actividades Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And Codigo_Unidad_Organica='" & UO & "' And Codigo_Secuencia_Funcional='" & Meta & "' And Codigo_Actividad='" & CA & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Actividad = Ds.Tables(0).Rows(0).Item("Codigo_Actividad").ToString
        Else
            Variable_Actividad = ""
        End If

        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Tipo_Recurso Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And Codigo_FF='" & FF & "' And Codigo_Rubro='" & R & "' And Codigo_Tipo_Recurso='" & Tipo_Recurso & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Tipo_Recursos = Ds.Tables(0).Rows(0).Item("Tipo_Recurso").ToString
        Else
            Variable_Tipo_Recursos = ""
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Tipo_Comprobantes Where Codigo_Comprobante='" & Comprobante & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Tipo_Comprobante = Ds.Tables(0).Rows(0).Item("Comprobante").ToString
        Else
            Variable_Tipo_Comprobante = ""
        End If
    End Sub
    Public Sub Nuevo_PIA(ByVal Año_Ejecucion As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Estado_PIA As String, ByVal FechaEmision As Date, Optional ByVal Usuario As String = Nothing)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_PIA"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Estado_PIA", Codigo_Estado_PIA)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", Usuario)
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Nuevo_Detalle_PIA(ByVal Año_Ejecucion As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto_Enero As Double, ByVal Monto_Febrero As Double, ByVal Monto_Marzo As Double, ByVal Monto_Abril As Double, ByVal Monto_Mayo As Double, ByVal Monto_Junio As Double, ByVal Monto_Julio As Double, ByVal Monto_Agosto As Double, ByVal Monto_Septiembre As Double, ByVal Monto_Octubre As Double, ByVal Monto_Noviembre As Double, ByVal Monto_Diciembre As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_PIA"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto_Enero", Monto_Enero)
        Cm.Parameters.AddWithValue("@Monto_Febrero", Monto_Febrero)
        Cm.Parameters.AddWithValue("@Monto_Marzo", Monto_Marzo)
        Cm.Parameters.AddWithValue("@Monto_Abril", Monto_Abril)
        Cm.Parameters.AddWithValue("@Monto_Mayo", Monto_Mayo)
        Cm.Parameters.AddWithValue("@Monto_Junio", Monto_Junio)
        Cm.Parameters.AddWithValue("@Monto_Julio", Monto_Julio)
        Cm.Parameters.AddWithValue("@Monto_Agosto", Monto_Agosto)
        Cm.Parameters.AddWithValue("@Monto_Septiembre", Monto_Septiembre)
        Cm.Parameters.AddWithValue("@Monto_Octubre", Monto_Octubre)
        Cm.Parameters.AddWithValue("@Monto_Noviembre", Monto_Noviembre)
        Cm.Parameters.AddWithValue("@Monto_Diciembre", Monto_Diciembre)
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Verificar_Existencia_PIA(ByVal Año_Ejecucion As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String) As Boolean
        Verificar_Existencia_PIA = True
        If Verificar_Existencia_PIA = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From PIA Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count = 0 Then
                Verificar_Existencia_PIA = True
            Else
                Verificar_Existencia_PIA = False
            End If
        End If
        Return Verificar_Existencia_PIA
    End Function
    Public Sub Nuevo_Cuadro_Necesidades(ByVal Año_Ejecucion As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Estado_CN As String, ByVal FechaEmision As Date, Optional ByVal Usuario As String = Nothing)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Cuadro_Necesidades"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Estado_CN", Codigo_Estado_CN)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", Usuario)
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Nuevo_Detalle_Cuadro_Necesidades(ByVal Año_Ejecucion As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String,ByVal Costo_Referencial as Double, ByVal Monto_Enero As Double, ByVal Monto_Febrero As Double, ByVal Monto_Marzo As Double, ByVal Monto_Abril As Double, ByVal Monto_Mayo As Double, ByVal Monto_Junio As Double, ByVal Monto_Julio As Double, ByVal Monto_Agosto As Double, ByVal Monto_Septiembre As Double, ByVal Monto_Octubre As Double, ByVal Monto_Noviembre As Double, ByVal Monto_Diciembre As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Cuadro_Necesidades"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Costo_Referencial", Costo_Referencial)
        Cm.Parameters.AddWithValue("@Cantidad_Enero", Monto_Enero)
        Cm.Parameters.AddWithValue("@Cantidad_Febrero", Monto_Febrero)
        Cm.Parameters.AddWithValue("@Cantidad_Marzo", Monto_Marzo)
        Cm.Parameters.AddWithValue("@Cantidad_Abril", Monto_Abril)
        Cm.Parameters.AddWithValue("@Cantidad_Mayo", Monto_Mayo)
        Cm.Parameters.AddWithValue("@Cantidad_Junio", Monto_Junio)
        Cm.Parameters.AddWithValue("@Cantidad_Julio", Monto_Julio)
        Cm.Parameters.AddWithValue("@Cantidad_Agosto", Monto_Agosto)
        Cm.Parameters.AddWithValue("@Cantidad_Septiembre", Monto_Septiembre)
        Cm.Parameters.AddWithValue("@Cantidad_Octubre", Monto_Octubre)
        Cm.Parameters.AddWithValue("@Cantidad_Noviembre", Monto_Noviembre)
        Cm.Parameters.AddWithValue("@Cantidad_Diciembre", Monto_Diciembre)
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Verificar_Existencia_Cuadro_Necesidades(ByVal Año_Ejecucion As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String) As Boolean
        Verificar_Existencia_Cuadro_Necesidades = True
        If Verificar_Existencia_Cuadro_Necesidades = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Cuadro_Necesidades Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count = 0 Then
                Verificar_Existencia_Cuadro_Necesidades = True
            Else
                Verificar_Existencia_Cuadro_Necesidades = False
            End If
        End If
        Return Verificar_Existencia_Cuadro_Necesidades
    End Function
    Public Sub Imprimir_Reporte(ByVal Tabla As String, ByVal Reporte As CrystalDecisions.CrystalReports.Engine.ReportDocument, ByVal Zoom As Integer, ByVal Titulo_Reporte As String, ByVal Imprimir As Boolean)
        Dim DT As New DataTable
        DT = LLenar_DT(Tabla)
        With frmVisor_Reportes
            .Reporte = Reporte
            .Reporte.SetDataSource(DT)
            .Visor_Reporte.ReportSource = .Reporte
            .Visor_Reporte.Zoom(Zoom)
            .Visor_Reporte.RefreshReport()
            .Text = Titulo_Reporte
            If Imprimir Then
                .Visor_Reporte.PrintReport()
            Else
                .ShowDialog()
            End If
        End With
    End Sub

    Public Sub Imprimir_Reporte_Contrato(ByVal Tabla As String,
                                         ByVal Reporte As CrystalDecisions.CrystalReports.Engine.ReportDocument,
                                         ByVal Zoom As Integer, ByVal Titulo_Reporte As String, ByVal Imprimir As Boolean,
                                         ByVal AbreviaturaGenero As String, ByVal NombreGerente As String, ByVal DocGerente As String,
                                         ByVal Mes As String)
        Dim DT As New DataTable
        DT = LLenar_DT(Tabla)

        Dim win As New frmReportes
        win.DT = DT
        win.NombreGerente = NombreGerente
        win.AbreviaturaGenero = AbreviaturaGenero
        win.DocGerente = DocGerente
        win.Text = Titulo_Reporte
        win.ShowDialog()
    End Sub

    Public Function Ejecutar_Select(ByVal Tabla As String) As DataTable
        Dim DT As New DataTable

        DT = LLenar_DT(Tabla)

        Return DT
    End Function

    Public Sub Imprimir_Reporte_Sub(ByVal Tabla As String, ByVal Tabla_Sub As String, ByVal Reporte As CrystalDecisions.CrystalReports.Engine.ReportDocument, ByVal Zoom As Integer, ByVal Titulo_Reporte As String, ByVal Imprimir As Boolean)
        Dim DT As New DataTable
        Dim DT_Sub As New DataTable
        DT = LLenar_DT(Tabla)
        DT_Sub = LLenar_DT(Tabla_Sub)
        With frmVisor_Reportes
            .Reporte = Reporte
            .Reporte.SetDataSource(DT)
            .Reporte.Subreports(0).SetDataSource(DT_Sub)
            .Visor_Reporte.ReportSource = .Reporte
            .Visor_Reporte.Zoom(Zoom)
            .Visor_Reporte.RefreshReport()
            .Text = Titulo_Reporte
            If Imprimir Then
                .Visor_Reporte.PrintReport()
            Else
                .ShowDialog()
            End If
        End With
    End Sub
    Public Sub Imprimir_Reporte_Sub_2(ByVal Tabla As String, ByVal Tabla_Sub1 As String, ByVal Tabla_Sub2 As String, ByVal Reporte As CrystalDecisions.CrystalReports.Engine.ReportDocument, ByVal Zoom As Integer, ByVal Titulo_Reporte As String, ByVal Imprimir As Boolean)
        Dim DT As New DataTable
        Dim DT_Sub1 As New DataTable
        Dim DT_Sub2 As New DataTable
        DT = LLenar_DT(Tabla)
        DT_Sub1 = LLenar_DT(Tabla_Sub1)
        DT_Sub2 = LLenar_DT(Tabla_Sub2)
        With frmVisor_Reportes
            .Reporte = Reporte
            .Reporte.SetDataSource(DT)
            .Reporte.Subreports(0).SetDataSource(DT_Sub1)
            .Reporte.Subreports(1).SetDataSource(DT_Sub2)
            .Visor_Reporte.ReportSource = .Reporte
            .Visor_Reporte.Zoom(Zoom)
            .Visor_Reporte.RefreshReport()
            .Text = Titulo_Reporte
            If Imprimir Then
                .Visor_Reporte.PrintReport()
            Else
                .ShowDialog()
            End If
        End With
    End Sub
    Public Sub Imprimir_Reporte_Sub_3(ByVal Tabla As String, ByVal Tabla_Sub1 As String, ByVal Tabla_Sub2 As String, ByVal Tabla_Sub3 As String, ByVal Reporte As CrystalDecisions.CrystalReports.Engine.ReportDocument, ByVal Zoom As Integer, ByVal Titulo_Reporte As String, ByVal Imprimir As Boolean)
        Dim DT As New DataTable
        Dim DT_Sub1 As New DataTable
        Dim DT_Sub2 As New DataTable
        Dim DT_Sub3 As New DataTable
        DT = LLenar_DT(Tabla)
        DT_Sub1 = LLenar_DT(Tabla_Sub1)
        DT_Sub2 = LLenar_DT(Tabla_Sub2)
        DT_Sub3 = LLenar_DT(Tabla_Sub3)
        With frmVisor_Reportes
            .Reporte = Reporte
            .Reporte.SetDataSource(DT)
            .Reporte.Subreports(1).SetDataSource(DT_Sub1)
            .Reporte.Subreports(2).SetDataSource(DT_Sub2)
            .Reporte.Subreports(0).SetDataSource(DT_Sub3)
            .Visor_Reporte.ReportSource = .Reporte
            .Visor_Reporte.Zoom(Zoom)
            .Visor_Reporte.RefreshReport()
            .Text = Titulo_Reporte
            If Imprimir Then
                .Visor_Reporte.PrintReport()
            Else
                .ShowDialog()
            End If
        End With
    End Sub
    Public Sub Imprimir_Reporte_Sub_4(ByVal Tabla As String, ByVal Tabla_Sub1 As String, ByVal Tabla_Sub2 As String, ByVal Tabla_Sub3 As String, ByVal Tabla_Sub4 As String, ByVal Reporte As CrystalDecisions.CrystalReports.Engine.ReportDocument, ByVal Zoom As Integer, ByVal Titulo_Reporte As String, ByVal Imprimir As Boolean)
        Dim DT As New DataTable
        Dim DT_Sub1 As New DataTable
        Dim DT_Sub2 As New DataTable
        Dim DT_Sub3 As New DataTable
        Dim DT_Sub4 As New DataTable
        DT = LLenar_DT(Tabla)
        DT_Sub1 = LLenar_DT(Tabla_Sub1)
        DT_Sub2 = LLenar_DT(Tabla_Sub2)
        DT_Sub3 = LLenar_DT(Tabla_Sub3)
        DT_Sub4 = LLenar_DT(Tabla_Sub4)
        With frmVisor_Reportes
            .Reporte = Reporte
            .Reporte.SetDataSource(DT)
            .Reporte.Subreports(0).SetDataSource(DT_Sub1)
            .Reporte.Subreports(3).SetDataSource(DT_Sub2)
            .Reporte.Subreports(1).SetDataSource(DT_Sub3)
            .Reporte.Subreports(2).SetDataSource(DT_Sub4)
            .Visor_Reporte.ReportSource = .Reporte
            .Visor_Reporte.Zoom(Zoom)
            .Visor_Reporte.RefreshReport()
            .Text = Titulo_Reporte
            If Imprimir Then
                .Visor_Reporte.PrintReport()
            Else
                .ShowDialog()
            End If
        End With
    End Sub
    Public Sub Imprimir_Reporte_Sub_4_2(ByVal Tabla As String, ByVal Tabla_Sub1 As String, ByVal Tabla_Sub2 As String, ByVal Tabla_Sub3 As String, ByVal Tabla_Sub4 As String, ByVal Reporte As CrystalDecisions.CrystalReports.Engine.ReportDocument, ByVal Zoom As Integer, ByVal Titulo_Reporte As String, ByVal Imprimir As Boolean)
        Dim DT As New DataTable
        Dim DT_Sub1 As New DataTable
        Dim DT_Sub2 As New DataTable
        Dim DT_Sub3 As New DataTable
        Dim DT_Sub4 As New DataTable
        DT = LLenar_DT(Tabla)
        DT_Sub1 = LLenar_DT(Tabla_Sub1)
        DT_Sub2 = LLenar_DT(Tabla_Sub2)
        DT_Sub3 = LLenar_DT(Tabla_Sub3)
        DT_Sub4 = LLenar_DT(Tabla_Sub4)
        With frmVisor_Reportes
            .Reporte = Reporte
            .Reporte.SetDataSource(DT)
            .Reporte.Subreports(0).SetDataSource(DT_Sub1)
            .Reporte.Subreports(3).SetDataSource(DT_Sub2)
            .Reporte.Subreports(2).SetDataSource(DT_Sub3)
            .Reporte.Subreports(1).SetDataSource(DT_Sub4)
            .Visor_Reporte.ReportSource = .Reporte
            .Visor_Reporte.Zoom(Zoom)
            .Visor_Reporte.RefreshReport()
            .Text = Titulo_Reporte
            If Imprimir Then
                .Visor_Reporte.PrintReport()
            Else
                .ShowDialog()
            End If
        End With
    End Sub
    Public Sub Cargar_PIA_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String, ByVal Combo_Unidad_Organica As System.Windows.Forms.ComboBox, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_PIA_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Combo_Unidad_Organica.Text = Ds.Tables(0).Rows(0).Item("Nombre_Unidad_Organica").ToString
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Enero").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Febrero").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Marzo").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Abril").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Mayo").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Junio").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Julio").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Agosto").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Septiembre").ToString
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Octubre").ToString
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Noviembre").ToString
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto_Diciembre").ToString
            Next
        End If
    End Sub
    Public Function Cargar_CN_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String, ByVal Combo_Unidad_Organica As System.Windows.Forms.ComboBox, ByVal DataGridView As System.Windows.Forms.DataGridView) As Integer
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_CN_Basica_edicion Where Año_Ejecucion='" & Año_Ejecución & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        if Ds.Tables(0).Rows.Count <= 0
            MessageBox.Show("Al parecer la U.O. no cuenta con items registrados, elimine y vuelva a crear el C.N.", "C.N.", MessageBoxButtons.OK, MessageBoxIcon.Asterisk, MessageBoxDefaultButton.Button1)
            Return 1
        End If
        Combo_Unidad_Organica.Text = Ds.Tables(0).Rows(0).Item("Nombre_Unidad_Organica").ToString
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString

                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Item").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Medida").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Unidad").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString

                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Enero").ToString
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Febrero").ToString
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Marzo").ToString
                DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Abril").ToString
                DataGridView.Item(27, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Mayo").ToString
                DataGridView.Item(28, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Junio").ToString
                DataGridView.Item(29, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Julio").ToString
                DataGridView.Item(30, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Agosto").ToString
                DataGridView.Item(31, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Septiembre").ToString
                DataGridView.Item(32, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Octubre").ToString
                DataGridView.Item(33, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Noviembre").ToString
                DataGridView.Item(34, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad_Diciembre").ToString

                DataGridView.Item(35, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cadena").ToString
                DataGridView.Item(36, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString
                DataGridView.Item(37, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                
                DataGridView.Item(38, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Total").ToString

                DataGridView.Item(41, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("db").ToString
            Next
        End If
        Return 0
    End Function
    Public Sub Cargar_Certificado_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Documento As System.Windows.Forms.TextBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox, ByVal Combo_Tipo_Operacion As System.Windows.Forms.ComboBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Certificados_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento").ToString
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            Combo_Tipo_Operacion.Text = Ds.Tables(0).Rows(0).Item("Tipo_Operacion").ToString
        End If
    End Sub
    Public Sub Cargar_Prevision_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Documento As System.Windows.Forms.TextBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Previsiones_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Periodo").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Previsiones_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento").ToString
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            If Ds.Tables(0).Rows(0).Item("Certificacion").ToString <> "[N/A]" Then
                Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificacion").ToString
            Else
                Caja_Certificacion.Text = ""
            End If


        End If
    End Sub
    Public Sub Cargar_Requerimiento_Bien_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Combo_Unidad As System.Windows.Forms.ComboBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Requerimientos_Bienes_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Medida").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Unidad_Medida").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Requerimientos_Bienes_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Combo_Unidad.Text = Ds.Tables(0).Rows(0).Item("Nombre_Unidad_Organica").ToString
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
        End If
    End Sub
    Public Sub Cargar_Requerimiento_Servicio_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Combo_Unidad As System.Windows.Forms.ComboBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Requerimientos_Servicios_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Medida").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Unidad_Medida").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Requerimientos_Servicios_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Combo_Unidad.Text = Ds.Tables(0).Rows(0).Item("Nombre_Unidad_Organica").ToString
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
        End If
    End Sub
    Public Sub Cargar_Rebaja_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Certificado As System.Windows.Forms.TextBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Rebajas_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Variable As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Dim Tope As Integer = 0
            Tope = Ds.Tables(0).Rows.Count - 1
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Ds = Nothing
            Da = Nothing
            Me.Cargar_Certificado_Rebajas(Año_Ejecución, Variable, DataGridView, Caja_Certificado)
        End If
    End Sub
    Public Sub Cargar_Rebaja_Para_Modificacion_Eliminacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Certificado As String, ByVal Caja_Justificacion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Rebajas_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Variable As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Dim Tope As Integer = 0
            Tope = Ds.Tables(0).Rows.Count - 1

            Me.Cargar_Certificado_Rebajas_eliminar(Año_Ejecución, Variable, DataGridView, Caja_Certificado)
        End If
    End Sub

    Public Sub Cargar_Ampliacion_Para_Modificacion_Eliminacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Certificado As String, ByVal Caja_Justificacion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Ampliaciones_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Variable As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Dim Tope As Integer = 0
            Tope = Ds.Tables(0).Rows.Count - 1

            Me.Cargar_Certificado_Ampliaciones_eliminar(Año_Ejecución, Variable, DataGridView, Caja_Certificado)
        End If
    End Sub
    Public Sub Cargar_Montos_Rebaja_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                With DataGridView.Rows(Recorrido).Cells
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Rebajas_Basica_Reportar Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "' And Codigo_FF=" & .Item(1).Value & " And Codigo_Rubro='" & .Item(2).Value & "' And Tipo_Transaccion='" & .Item(3).Value & "' And Generica='" & .Item(4).Value & "' And Sub_Generica='" & .Item(5).Value & "' And Sub_Generica_Detalle='" & .Item(6).Value & "' And Especifica='" & .Item(7).Value & "' And Especifica_Detalle='" & .Item(8).Value & "' And Codigo_Secuencia_Funcional='" & .Item(10).Value & "' And Codigo_Unidad_Organica='" & .Item(11).Value & "' And Codigo_Actividad='" & .Item(12).Value & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        .Item(16).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    End If
                End With
            Next
        End If
    End Sub
    Public Sub Cargar_Montos_Ampliaciones_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                With DataGridView.Rows(Recorrido).Cells
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ampliaciones_Basica_Reportar Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "' And Codigo_FF=" & .Item(1).Value & " And Codigo_Rubro='" & .Item(2).Value & "' And Tipo_Transaccion='" & .Item(3).Value & "' And Generica='" & .Item(4).Value & "' And Sub_Generica='" & .Item(5).Value & "' And Sub_Generica_Detalle='" & .Item(6).Value & "' And Especifica='" & .Item(7).Value & "' And Especifica_Detalle='" & .Item(8).Value & "' And Codigo_Secuencia_Funcional='" & .Item(10).Value & "' And Codigo_Unidad_Organica='" & .Item(11).Value & "' And Codigo_Actividad='" & .Item(12).Value & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        .Item(16).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    End If
                End With
            Next
        End If
    End Sub
    Public Sub Cargar_Ampliacion_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Certificado As System.Windows.Forms.TextBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Ampliaciones_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Variable As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Dim Tope As Integer = 0
            Tope = Ds.Tables(0).Rows.Count - 1
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Ds = Nothing
            Da = Nothing
            Me.Cargar_Certificado_Ampliaciones_Editar(Año_Ejecución, Variable, DataGridView, Caja_Certificado)
        End If
    End Sub
    Public Sub Cargar_Montos_Ampliacion_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                With DataGridView.Rows(Recorrido).Cells
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ampliaciones_Basica_Reportar Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "' And Codigo_FF=" & .Item(1).Value & " And Codigo_Rubro='" & .Item(2).Value & "' And Tipo_Transaccion='" & .Item(3).Value & "' And Generica='" & .Item(4).Value & "' And Sub_Generica='" & .Item(5).Value & "' And Sub_Generica_Detalle='" & .Item(6).Value & "' And Especifica='" & .Item(7).Value & "' And Especifica_Detalle='" & .Item(8).Value & "' And Codigo_Secuencia_Funcional='" & .Item(10).Value & "' And Codigo_Unidad_Organica='" & .Item(11).Value & "' And Codigo_Actividad='" & .Item(12).Value & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        .Item(16).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    End If
                End With
            Next
        End If
    End Sub
    Public Sub Cargar_Nota_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Combo_Motivo As System.Windows.Forms.ComboBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Nota_Modificatoria_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Notas_Modificatorias_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Combo_Motivo.Text = Ds.Tables(0).Rows(0).Item("Motivo").ToString
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
        End If
    End Sub
    Public Sub Eliminar_PIA(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_PIA Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From PIA Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Eliminar_CN(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Cuadro_Necesidades Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Cuadro_Necesidades Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Encriptar(ByVal clave As String) As String
        Dim sha1 As SHA1 = SHA1Managed.Create()
        Dim encoding As New ASCIIEncoding()
        Dim stream As Byte() = Nothing
        Dim sb As New StringBuilder()
        stream = sha1.ComputeHash(encoding.GetBytes(clave))
        For i As Integer = 0 To stream.Length - 1
            sb.AppendFormat("{0:x2}", stream(i))
        Next
        Return sb.ToString
    End Function
    Public Sub Autorizar_PIA(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String, Optional ByVal Usuario As String = Nothing)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update PIA Set Codigo_Estado_PIA='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario.Trim & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Autorizar_CN(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String, Optional ByVal Usuario As String = Nothing)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Cuadro_Necesidades Set Codigo_Estado_CN='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario.Trim & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_PIA(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String, Optional ByVal Usuario As String = Nothing)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update PIA Set Codigo_Estado_PIA='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario.Trim & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_CN(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String, Optional ByVal Usuario As String = Nothing)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Cuadro_Necesidades Set Codigo_Estado_CN='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario.Trim & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_PIA(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update PIA Set Codigo_Estado_PIA='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_CN(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Cuadro_Necesidades Set Codigo_Estado_CN='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Verificar_Clave(ByVal User As String, ByVal Clave As String) As Boolean
        Verificar_Clave = True
        If Verificar_Clave = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Usuario Where Usuario='" & User.Trim & "' And Clave='" & Clave.Trim & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds, "Usuario")
            If Not (Ds.Tables(0).Rows.Count > 0) Then
                Verificar_Clave = False
            End If
        End If
    End Function
    Public Function Verificar_Usuario_Activo(ByVal User As String, ByVal Clave As String) As Boolean
        Verificar_Usuario_Activo = True
        If Verificar_Usuario_Activo = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Usuario Where Usuario='" & User.Trim & "' And Clave='" & Clave.Trim & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds, "Usuario")
            If Not (Ds.Tables(0).Rows(0).Item("Activo") = True) Then
                Verificar_Usuario_Activo = False
            End If
        End If
    End Function
    Public Function Obtener_Nombre_Usuario(ByVal User As String) As String
        Obtener_Nombre_Usuario = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Usuario Where Usuario='" & User.Trim & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds, "Usuario")
        If Ds.Tables(0).Rows.Count > 0 Then
            Obtener_Nombre_Usuario = Ds.Tables(0).Rows(0).Item("Apellidos").ToString & ", " & Ds.Tables(0).Rows(0).Item("Nombres").ToString
            Return Obtener_Nombre_Usuario
        End If
    End Function
    Public Sub Evaluacion_Botones_Modulo_PIA(ByVal Año_Ejecucion As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_PIA_Generados Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_PIA").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
            End Select
        End If
    End Sub

    Public Sub Evaluacion_Botones_Modulo_CN(ByVal Año_Ejecucion As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_CN_Generados Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_CN").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
            End Select
        End If
    End Sub

    Public Sub Evaluacion_Botones_Modulo_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Detallar As DevComponents.DotNetBar.ButtonItem, ByVal Distribuir As DevComponents.DotNetBar.ButtonItem, ByVal Extornar_Distribucion As DevComponents.DotNetBar.ButtonItem, ByVal Ver_Distribucion As DevComponents.DotNetBar.ButtonItem, ByVal Reenumeracion As DevComponents.DotNetBar.ButtonItem, ByVal Edicion_Basica As DevComponents.DotNetBar.ButtonItem, ByVal Historial_Certificacion As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Certificado").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Detallar.Enabled = False
                    Distribuir.Enabled = False
                    Extornar_Distribucion.Enabled = False
                    Ver_Distribucion.Enabled = False
                    Reenumeracion.Enabled = True
                    Edicion_Basica.Enabled = False
                    Historial_Certificacion.Enabled = False
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Detallar.Enabled = False
                    Distribuir.Enabled = False
                    Extornar_Distribucion.Enabled = False
                    Ver_Distribucion.Enabled = False
                    Reenumeracion.Enabled = False
                    Edicion_Basica.Enabled = True
                    Historial_Certificacion.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Detallar.Enabled = True
                    Edicion_Basica.Enabled = True
                    If Ds.Tables(0).Rows(0).Item("Distribuido") = True Then
                        Distribuir.Enabled = False
                        Extornar_Distribucion.Enabled = True
                        Ver_Distribucion.Enabled = True
                    Else
                        Distribuir.Enabled = True
                        Extornar_Distribucion.Enabled = False
                        Ver_Distribucion.Enabled = False
                    End If
                    Historial_Certificacion.Enabled = True
                    Reenumeracion.Enabled = False
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Detallar.Enabled = False
                    Distribuir.Enabled = False
                    Extornar_Distribucion.Enabled = False
                    Ver_Distribucion.Enabled = False
                    Reenumeracion.Enabled = False
                    Edicion_Basica.Enabled = False
                    Historial_Certificacion.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Detallar.Enabled = False
                    Distribuir.Enabled = False
                    Extornar_Distribucion.Enabled = False
                    Ver_Distribucion.Enabled = False
                    Reenumeracion.Enabled = False
                    Edicion_Basica.Enabled = False
                    Historial_Certificacion.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Requerimiento_Bienes(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Requerimientos_Bienes_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Requerimiento").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "05" 'ATENDIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Aprobacion_Requerimiento_Bienes(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Rechazar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Requerimientos_Bienes_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Requerimiento").ToString
                Case "01" 'EMITIDO()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "02" 'AUTORIZADO()
                    Rechazar.Enabled = True
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "03" 'APROBADO()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "04" 'ANULADO()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "05" 'ATENDIDO()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "06" 'Rechazado()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case Else
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Aprobacion_Requerimiento_Servicios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Rechazar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Requerimientos_Servicios_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Requerimiento").ToString
                Case "01" 'EMITIDO()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "02" 'AUTORIZADO()
                    Rechazar.Enabled = True
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "03" 'APROBADO()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "04" 'ANULADO()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "05" 'ATENDIDO()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "06" 'Rechazado()
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case Else
                    Rechazar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Requerimiento_Servicios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Requerimientos_Servicios_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Requerimiento").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "05" 'ATENDIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
            End Select
        End If
    End Sub
    Public Function Generar_Numero_Certificado(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Certificado = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Certificado
    End Function
    Public Function Generar_Numero_Prevision(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Prevision Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Prevision = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Prevision
    End Function
    Public Function Generar_Numero_Correlativo_Certificado(ByVal Año_Ejecucion As String, ByVal Numero_Certificado As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Certificado & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Certificado = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Certificado
    End Function
    Public Function Generar_Numero_Correlativo_Devengado(ByVal Año_Ejecucion As String, ByVal Numero_Devengado As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Devengado & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Devengado = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Devengado
    End Function
    Public Function Generar_Numero_Correlativo_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero_Orden As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Orden & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Orden_Compra = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Orden_Compra
    End Function
    Public Function Generar_Numero_Correlativo_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero_Orden As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Orden & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Orden_Servicio = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Orden_Servicio
    End Function
    Public Function Generar_Numero_Nota(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Nota = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Nota
    End Function
    Public Function Generar_Numero_Requerimiento_Bienes(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Requerimiento_Bienes Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Requerimiento_Bienes = Right("00000" & Numero.ToString, 5)
        Return Generar_Numero_Requerimiento_Bienes
    End Function
    Public Function Generar_Numero_Requerimiento_Servicios(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Requerimiento_Servicios Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Requerimiento_Servicios = Right("00000" & Numero.ToString, 5)
        Return Generar_Numero_Requerimiento_Servicios
    End Function
    Public Sub Nuevo_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Documento As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Certificado As String, ByVal Monto As Double, ByVal Codigo_Tipo_Operacion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Certificado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Certificado", Codigo_Estado_Certificado)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nueva_Nota_Modificatoria(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Motivo_Nota As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Nota As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Nota"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Motivo_Nota", Codigo_Motivo_Nota)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Certificado", Codigo_Estado_Nota)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Nota_Modificatoria(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Motivo_Nota As String, ByVal Justificacion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Nota"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Motivo_Nota", Codigo_Motivo_Nota)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Documento As String, ByVal Justificacion As String, ByVal Monto As Double, ByVal Codigo_Tipo_Operacion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Certificado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Requerimiento_Bienes(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Justificacion As String, ByVal Monto_Referencial As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Requerimiento_Bienes"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Monto_Referencial", Monto_Referencial)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Requerimiento_Servicios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Justificacion As String, ByVal Monto_Referencial As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Requerimiento_Servicios"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Monto_Referencial", Monto_Referencial)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Rebaja(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Justificacion As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Rebaja"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Ampliacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Justificacion As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Ampliacion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Codigo_Tipo_Recurso As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Certificado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Certificado_2(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Codigo_Tipo_Recurso As String, ByVal Ampliacion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Certificado_2"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Ampliacion", Ampliacion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Certificado_Movimiento(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Numero_Documento As String, ByVal Monto As Double, ByVal Codigo_Estado_Certificado_Movimientos As String, ByVal Codigo_Tipo_Recurso As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Certificado_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Certificado_Movimientos", Codigo_Estado_Certificado_Movimientos)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Orden_Compra_Movimiento(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Requerimiento As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Numero_Documento As String, ByVal Codigo_Estado_Orden_Movimientos As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Compra_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Orden_Movimientos", Codigo_Estado_Orden_Movimientos)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Orden_Compra_Movimiento_2(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Requerimiento As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Numero_Documento As String, ByVal Codigo_Estado_Orden_Movimientos As String, ByVal IGV As Boolean)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Compra_Movimientos_2"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Orden_Movimientos", Codigo_Estado_Orden_Movimientos)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Orden_Servicio_Movimiento(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Requerimiento As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Numero_Documento As String, ByVal Codigo_Estado_Orden_Movimientos As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Servicio_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Orden_Movimientos", Codigo_Estado_Orden_Movimientos)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Generar_Detalle_Orden_Compra_Movimiento(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Correlativo As String = Me.Generar_Numero_Correlativo_Orden_Compra(Año_Ejecucion, Numero)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Centro_Costos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' ", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Movimiento(Correlativo, "05", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"), Ds.Tables(0).Rows(Recorrido).Item("Numero"), Ds.Tables(0).Rows(Recorrido).Item("Certificado"), Ds.Tables(0).Rows(Recorrido).Item("Requerimiento"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item"), Ds.Tables(0).Rows(Recorrido).Item("Cantidad"), Ds.Tables(0).Rows(Recorrido).Item("Costo"), Ds.Tables(0).Rows(Recorrido).Item("Numero"), "01")
            Next
        End If
    End Sub
    Public Sub Generar_Detalle_Orden_Compra_Movimiento_2(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Correlativo As String = Me.Generar_Numero_Correlativo_Orden_Compra(Año_Ejecucion, Numero)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Centro_Costos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' ", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Movimiento_2(Correlativo, "05", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"), Ds.Tables(0).Rows(Recorrido).Item("Numero"), Ds.Tables(0).Rows(Recorrido).Item("Certificado"), Ds.Tables(0).Rows(Recorrido).Item("Requerimiento"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item"), Ds.Tables(0).Rows(Recorrido).Item("Cantidad"), Ds.Tables(0).Rows(Recorrido).Item("Costo"), Ds.Tables(0).Rows(Recorrido).Item("Numero"), "01", Ds.Tables(0).Rows(Recorrido).Item("IGV"))
            Next
        End If
    End Sub
    Public Sub Generar_Detalle_Orden_Servicio_Movimiento(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Correlativo As String = Me.Generar_Numero_Correlativo_Orden_Servicio(Año_Ejecucion, Numero)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Servicio_Centro_Costos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' ", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Servicio_Movimiento(Correlativo, "06", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"), Ds.Tables(0).Rows(Recorrido).Item("Numero"), Ds.Tables(0).Rows(Recorrido).Item("Certificado"), Ds.Tables(0).Rows(Recorrido).Item("Requerimiento"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item"), Ds.Tables(0).Rows(Recorrido).Item("Cantidad"), Ds.Tables(0).Rows(Recorrido).Item("Costo"), Ds.Tables(0).Rows(Recorrido).Item("Numero"), "01")
            Next
        End If
    End Sub
    Public Sub Nuevo_Detalle_Nota(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Codigo_Tipo_Recurso As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Nota"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Eliminar_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Eliminar_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra_Documentos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra_Centro_Costos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='05'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Requerimiento_Bienes_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra_Documentos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra_Centro_Costos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='05'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Requerimiento_Bienes_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Eliminar_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Documentos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Centro_Costos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='06'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Requerimiento_Servicios_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Distribucion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Documentos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Centro_Costos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='06'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Requerimiento_Servicios_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Distribucion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Eliminar_Requerimiento_Bien(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Requerimiento_Bienes Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Requerimiento_Bienes Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Requerimiento_Bienes Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Eliminar_Requerimiento_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Requerimiento_Servicios Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Requerimiento_Servicios Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Requerimiento_Servicios Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Eliminar_Rebaja(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='02'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' ANd Codigo_Tipo_Operacion='02'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Eliminar_Ampliacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='03'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='03'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Artificio_Eliminar_Ampliacion(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Certificado_Movimientos where Codigo_Tipo_Operacion ='03' And Numero_Documento ='" & Numero & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Certificado As String = ""
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Certificado = Ds.Tables(0).Rows(0).Item("Numero").ToString
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Detalle_Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Dim Cadena As String = ""

                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    With Ds.Tables(0).Rows(Recorrido)
                        Cadena = Cadena & "'" & .Item("Codigo_FF") & "-" & .Item("Codigo_Rubro") & "-" & .Item("Tipo_Transaccion") & "-" & .Item("Generica") & "-" & .Item("Sub_Generica") & "-" & .Item("Sub_Generica_Detalle") & "-" & .Item("Especifica") & "-" & .Item("Especifica_Detalle") & "-" & .Item("Codigo_Secuencia_Funcional") & "-" & .Item("Codigo_Unidad_Organica") & "-" & .Item("Codigo_Actividad") & "',"
                    End With
                Next
                Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "' And Convert(VarChar(1),Codigo_FF)+'-' + Codigo_Rubro +'-'+ Tipo_Transaccion +'-'+ Generica +'-' + Sub_Generica +'-'+ Sub_Generica_Detalle +'-'+ Especifica +'-'+ Especifica_Detalle +'-'+ Codigo_Secuencia_Funcional +'-'+ Codigo_Unidad_Organica +'-'+ Codigo_Actividad In(" & Cadena & ") And Monto=0 And Ampliacion='" & Numero & "'"
                Cm.ExecuteNonQuery()
            End If
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Eliminar_Nota(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Autorizar_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Certificado Set Codigo_Estado_Certificado='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Autorizar_Prevision(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Prevision Set Codigo_Estado_Prevision='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Autorizar_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Orden_Compra Set Codigo_Estado_Orden='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='05'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Requerimiento_Bienes_Movimientos Set Codigo_Estado_Orden='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update detalle_orden_compra_movimientos Set Codigo_Estado_Orden_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Autorizar_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Orden_Servicio Set Codigo_Estado_Orden='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='06'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Requerimiento_Bienes_Movimientos Set Codigo_Estado_Orden='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update detalle_orden_Servicio_movimientos Set Codigo_Estado_Orden_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Orden_Compra Set Codigo_Estado_Orden='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='05'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Requerimiento_Bienes_Movimientos Set Codigo_Estado_Orden='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update detalle_orden_compra_movimientos Set Codigo_Estado_Orden_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Orden_Servicio Set Codigo_Estado_Orden='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='06'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Requerimiento_Servicios_Movimientos Set Codigo_Estado_Orden='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update detalle_orden_Servicio_movimientos Set Codigo_Estado_Orden_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Autorizar_Requerimiento_Bien(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Bienes Set Codigo_Estado_Requerimiento='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Autorizar_Requerimiento_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Servicios Set Codigo_Estado_Requerimiento='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Certificado Set Codigo_Estado_Certificado='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Prevision(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Prevision Set Codigo_Estado_Prevision='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Requerimiento_Bien(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Bienes Set Codigo_Estado_Requerimiento='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Rechazar_Requerimiento_Bien(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Bienes Set Codigo_Estado_Requerimiento='06' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Rechazar_Requerimiento_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Servicios Set Codigo_Estado_Requerimiento='06' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Requerimiento_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Servicios Set Codigo_Estado_Requerimiento='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Rebaja(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rebaja Set Codigo_Estado_Rebaja='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='02'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Ampliacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Ampliacion Set Codigo_Estado_Ampliacion='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='03'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Autorizar_Rebaja(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rebaja Set Codigo_Estado_Rebaja='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='02'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Autorizar_Ampliacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Ampliacion Set Codigo_Estado_Ampliacion='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='03'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Certificado Set Codigo_Estado_Certificado='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From  Detalle_Certificado_Distribucion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Correlativo As String = Me.Generar_Numero_Correlativo_Certificado(Año_Ejecucion, Numero)
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Certificado_Movimiento(Correlativo, "04", Año_Ejecucion, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString)
            Next
        End If
    End Sub
    Public Sub Anular_Prevision(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Prevision Set Codigo_Estado_Prevision='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Orden_Compra Set Codigo_Estado_Orden='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update detalle_requerimiento_bienes_Movimientos Set Codigo_Estado_Orden='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='05'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Correlativo As String = Me.Generar_Numero_Correlativo_Orden_Compra(Año_Ejecucion, Numero)
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Movimiento(Correlativo, "13", Año_Ejecucion, Numero, Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString, Ds.Tables(0).Rows(Recorrido).Item("Requerimiento").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString) * -1, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * -1, Numero, "01")
            Next
        End If
    End Sub
    Public Sub Anular_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Orden_Servicio Set Codigo_Estado_Orden='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update detalle_requerimiento_servicios_Movimientos Set Codigo_Estado_Orden='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='06'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Orden_Servicio_Distribucion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Servicio_movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Correlativo As String = Me.Generar_Numero_Correlativo_Orden_Servicio(Año_Ejecucion, Numero)
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Servicio_Movimiento(Correlativo, "14", Año_Ejecucion, Numero, Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString, Ds.Tables(0).Rows(Recorrido).Item("Requerimiento").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString) * -1, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * -1, Numero, "01")
            Next
        End If
    End Sub
    Public Sub Anular_Requerimiento_Bien(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Bienes Set Codigo_Estado_Requerimiento='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Requerimiento_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Servicios Set Codigo_Estado_Requerimiento='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Rebaja(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rebaja Set Codigo_Estado_Rebaja='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='02'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Ampliacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Ampliacion Set Codigo_Estado_Ampliacion='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='03'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Verificar_Extornabilidad_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String) As String
        Verificar_Extornabilidad_Certificado = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' And Certificado='" & Numero & "' And Codigo_Estado_Rebaja='03'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Extornabilidad_Certificado = "- Existe(n) " & Ds.Tables(0).Rows.Count & " Rebaja(s) Activa(s) Anexa(s) al Certificado Nro. " & Numero
        Else
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & ""
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Certificado='" & Numero & "' And Codigo_Estado_Ampliacion='03'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & vbNewLine & "- Existe(n) " & Ds.Tables(0).Rows.Count & " Ampliación(es) Activa(s) Anexa(s) al Certificado Nro. " & Numero
        Else
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & ""
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Certificado='" & Numero & "' And Codigo_Estado_Orden In('01','02','03')", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & vbNewLine & "- Existe(n) " & Ds.Tables(0).Rows.Count & " O/C Activa(s) Anexa(s) al Certificado Nro. " & Numero
        Else
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & ""
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Certificado='" & Numero & "' And Codigo_Estado_Orden In('01','02','03')", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & vbNewLine & "- Existe(n) " & Ds.Tables(0).Rows.Count & " O/S Activa(s) Anexa(s) al Certificado Nro. " & Numero
        Else
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & ""
        End If

        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Certificado='" & Numero & "' And Codigo_Estado_Caja In('01','02')", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & vbNewLine & "- Existe(n) " & Ds.Tables(0).Rows.Count & " Caja(s) Activa(s) Anexa(s) al Certificado Nro. " & Numero
        Else
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & ""
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Pagos_Varios Where Año_Ejecucion='" & Año_Ejecucion & "' And Certificado='" & Numero & "'And Codigo_Estado_Pago In('01','02','03')", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & vbNewLine & "- Existe(n) " & Ds.Tables(0).Rows.Count & " Pago(s) Activo(s) Anexo(s) al Certificado Nro. " & Numero
        Else
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & ""
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Encargo_Interno Where Año_Ejecucion='" & Año_Ejecucion & "' And Certificado='" & Numero & "'And Codigo_Estado_Encargo In('01','02','03')", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & vbNewLine & "- Existe(n) " & Ds.Tables(0).Rows.Count & " Encargos(s) Interno(s) Activo(s) Anexo(s) al Certificado Nro. " & Numero
        Else
            Verificar_Extornabilidad_Certificado = Verificar_Extornabilidad_Certificado & ""
        End If
        Return Verificar_Extornabilidad_Certificado
    End Function
    Public Function Verificar_Extornabilidad_Certificado_2(ByVal Año_Ejecucion As String, ByVal Numero As String) As String
        Verificar_Extornabilidad_Certificado_2 = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' And Certificado='" & Numero & "' And Codigo_Estado_Rebaja In('01','02','03')", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Extornabilidad_Certificado_2 = "- Existe(n) " & Ds.Tables(0).Rows.Count & " Rebaja(s) Activa(s) Anexa(s) al Certificado Nro. " & Numero
        Else
            Verificar_Extornabilidad_Certificado_2 = Verificar_Extornabilidad_Certificado_2 & ""
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Certificado='" & Numero & "' And Codigo_Estado_Ampliacion In('01','02','03')", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Extornabilidad_Certificado_2 = Verificar_Extornabilidad_Certificado_2 & vbNewLine & "- Existe(n) " & Ds.Tables(0).Rows.Count & " Ampliación(es) Activa(s) Anexa(s) al Certificado Nro. " & Numero
        Else
            Verificar_Extornabilidad_Certificado_2 = Verificar_Extornabilidad_Certificado_2 & ""
        End If
        Da = Nothing
        Ds = Nothing
        Return Verificar_Extornabilidad_Certificado_2
    End Function
    Public Sub Extornar_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Certificado Set Codigo_Estado_Certificado='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAutorizacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From  Detalle_Certificado_Distribucion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Prevision(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Prevision Set Codigo_Estado_Prevision='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAutorizacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub

    Public Sub Extornar_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Orden_Compra Set Codigo_Estado_Orden='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAutorizacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='05'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Requerimiento_Bienes_Movimientos Set Codigo_Estado_Orden='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Orden_Compra_Movimientos Set Codigo_Estado_Orden_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Orden_Servicio Set Codigo_Estado_Orden='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAutorizacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='06'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Requerimiento_Servicios_Movimientos Set Codigo_Estado_Orden='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Orden_Servicio_Movimientos Set Codigo_Estado_Orden_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Requerimiento_Bien(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Bienes Set Codigo_Estado_Requerimiento='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAutorizacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Requerimiento_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Requerimiento_Servicios Set Codigo_Estado_Requerimiento='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAutorizacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Rebaja(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rebaja Set Codigo_Estado_Rebaja='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAutorizacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='02'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Ampliacion(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Ampliacion Set Codigo_Estado_Ampliacion='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAutorizacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='03'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub

    Public Function Saldo(ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Año_Ejecucion As String) As Double
        Saldo = 0
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Movimientos_PIA_PIM_Certificados_Saldos Where Codigo_FF=" & Codigo_FF & " And Codigo_Rubro='" & Codigo_Rubro & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Saldo = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Saldo").ToString)
        Else
            Saldo = 0
        End If
        Return Saldo
    End Function

    Public Function Saldo_CN(ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Año_Ejecucion As String) As Double
        Saldo_CN = 0
        'Dim Da As New OleDb.OleDbDataAdapter("Select Importe_Asignado as Saldo_CN from Lista_Movimientos_PIA_CN Where Codigo_FF=" & Codigo_FF & " And Codigo_Rubro='" & Codigo_Rubro & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        'Dim Da As New OleDb.OleDbDataAdapter("Select Importe_Asignado as Saldo_CN from Lista_PIA_para_CN Where Codigo_FF=" & Codigo_FF & " And Codigo_Rubro='" & Codigo_Rubro & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        'Dim Da As New OleDb.OleDbDataAdapter("Select Saldo as Saldo_CN from Lista_Movimientos_PIA_PIM_Certificados_Saldos Where Codigo_FF=" & Codigo_FF & " And Codigo_Rubro='" & Codigo_Rubro & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Tabla_Consulta as String = ""
        Dim Consulta_general as String = ""

        If Tipo_Transaccion & "." & Generica & "." & Sub_Generica = "2.3.1"
            Dim Da_limpieza As New OleDb.OleDbDataAdapter("select * from PIA_prevision_detalle where Año_Ejecucion='"& My.Settings.Año_Ejecucion &"' and Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'and ltrim(rtrim(Tipo_Transaccion))+'.'+Generica+'.'+Sub_Generica+'.'+Sub_Generica_Detalle+'.'+Especifica+'.'+Especifica_Detalle='2.3.1.5.3.1' ", Cn)
            Dim Ds_limpieza As New Data.DataSet
            Da_limpieza.Fill(Ds_limpieza)

            if Ds_limpieza.Tables(0).Rows.Count>0
                If Tipo_Transaccion & "." & Generica & "." & Sub_Generica & "." & Sub_Generica_Detalle & "." & Especifica & "." & Especifica_Detalle = "2.3.1.5.3.1"
                    Tabla_Consulta = "Lista_Movimiento_CN_material_limpieza_saldo"
                else
                    Tabla_Consulta = "Lista_Movimiento_CN_bienes_saldo"
                End If
            Else
                Tabla_Consulta = "Lista_Movimiento_CN_bienes_alone_saldo"
            End If     
        else if Tipo_Transaccion & "." & Generica & "." & Sub_Generica = "2.3.2"
            If Tipo_Transaccion & "." & Generica & "." & Sub_Generica & "." & Sub_Generica_Detalle & "." & Especifica & "." & Especifica_Detalle = "2.3.2.7.2.99"
                Tabla_Consulta = "Lista_Movimiento_CN_locadores_saldo"
            else
                Tabla_Consulta = "Lista_Movimiento_CN_servicios_saldo"
            End If
        else if Tipo_Transaccion & "." & Generica = "2.6"
            Tabla_Consulta = "Lista_Movimiento_CN_activos_no_financieros_saldo"
        End If
        
        Consulta_general = "select Saldo From "& Tabla_Consulta &" where Codigo_FF=" & Codigo_FF & " And Codigo_Rubro='" & Codigo_Rubro  & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Año_Ejecucion='" & Año_Ejecucion & "'"
        Dim Da As New OleDb.OleDbDataAdapter(Consulta_general,Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)

        If Ds.Tables(0).Rows.Count > 0 Then
            Saldo_CN = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Saldo").ToString)
        Else
            Saldo_CN = 0
        End If
        Return Saldo_CN
    End Function

    Public Function Precio_ref_CN(ByVal Codigo_Grupo As Integer, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Año_Ejecucion As String) As Double
        Precio_ref_CN = 0
        'Dim Da As New OleDb.OleDbDataAdapter("Select Importe_Asignado as Saldo_CN from Lista_Movimientos_PIA_CN Where Codigo_FF=" & Codigo_FF & " And Codigo_Rubro='" & Codigo_Rubro & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        'Dim Da As New OleDb.OleDbDataAdapter("Select Importe_Asignado as Saldo_CN from Lista_PIA_para_CN Where Codigo_FF=" & Codigo_FF & " And Codigo_Rubro='" & Codigo_Rubro & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Da As New OleDb.OleDbDataAdapter("select precio_unitario from Catalogo_CN where codigo='" & Codigo_Grupo.ToString("00") & "." & Codigo_Clase & "." & Codigo_Familia & "." & Codigo_Item & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)

        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Precio_ref_CN = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("precio_unitario").ToString)
        Else
            Precio_ref_CN = 0
        End If
        Return Precio_ref_CN
    End Function

    Public Sub Autorizar_Nota_Modificatoria(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Nota_Modificatoria Set Codigo_Estado_Nota='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Aprobar_Nota_Modificatoria(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Nota_Modificatoria Set Codigo_Estado_Nota='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Nota_Modificatoria(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Nota_Modificatoria Set Codigo_Estado_Nota='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Nota_Modificatoria(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Nota_Modificatoria Set Codigo_Estado_Nota='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAutorizacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Nota_Modificatoria(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Notas_Modificatorias_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Nota").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Reenumerar.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Accion_Modificatoria(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Acciones_Modificatorias_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Accion").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
            End Select
        End If
    End Sub
    Public Function Acceso_Boton(ByVal Usuario As String, ByVal Boton As String) As Boolean
        Acceso_Boton = True
        If Acceso_Boton = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Acceso_Botones Where Usuario='" & Usuario & "' And Nombre_Boton='" & Boton & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Acceso_Boton = True
            Else
                Acceso_Boton = False
            End If
        End If
        Return Acceso_Boton
    End Function
    Public Function Acceso_Sub_Boton(ByVal Usuario As String, ByVal Boton As String, ByVal Sub_Boton As String) As Boolean
        Acceso_Sub_Boton = True
        If Acceso_Sub_Boton = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Acceso_Sub_Botones Where Usuario='" & Usuario & "' And Nombre_Boton='" & Boton & "' And Nombre_Sub_Boton='" & Sub_Boton & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Acceso_Sub_Boton = True
            Else
                Acceso_Sub_Boton = False
            End If
        End If
        Return Acceso_Sub_Boton
    End Function
    Public Sub Nuevo_Usuario(ByVal Codigo_Usuario As String, ByVal Codigo_Tipo_Usuario As String, ByVal Apellidos As String, ByVal Nombres As String, ByVal Usuario As String, ByVal Clave As String, ByVal Activo As Boolean)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Usuario"
        Cm.Parameters.AddWithValue("@Codigo_Usuario", Codigo_Usuario)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Usuario", Codigo_Tipo_Usuario)
        Cm.Parameters.AddWithValue("@Apellidos", Apellidos)
        Cm.Parameters.AddWithValue("@Nombres", Nombres)
        Cm.Parameters.AddWithValue("@Usuario", Usuario)
        Cm.Parameters.AddWithValue("@Clave", Clave)
        Cm.Parameters.AddWithValue("@Activo", Activo)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Usuario(ByVal Codigo_Usuario As String, ByVal Codigo_Tipo_Usuario As String, ByVal Apellidos As String, ByVal Nombres As String, ByVal Usuario As String, ByVal Clave As String, ByVal Activo As Boolean)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Usuario"
        Cm.Parameters.AddWithValue("@Codigo_Usuario", Codigo_Usuario)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Usuario", Codigo_Tipo_Usuario)
        Cm.Parameters.AddWithValue("@Apellidos", Apellidos)
        Cm.Parameters.AddWithValue("@Nombres", Nombres)
        Cm.Parameters.AddWithValue("@Usuario", Usuario)
        Cm.Parameters.AddWithValue("@Clave", Clave)
        Cm.Parameters.AddWithValue("@Activo", Activo)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Usuario() As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Codigo_Usuario)+1),1) As Numero From Usuario ", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Usuario = Right("000" & Numero.ToString, 3)
        Return Generar_Numero_Usuario
    End Function
    Public Sub Cargar_Datos_Usuarios(ByVal Codigo As String, Optional ByVal Caja_Codigo As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Tipo As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Apellidos As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Nombres As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Usuario As System.Windows.Forms.TextBox = Nothing, Optional ByVal Check_Activo As System.Windows.Forms.CheckBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Usuarios Where Codigo_Usuario='" & Codigo & "' ", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If Not (Caja_Codigo Is Nothing) Then Caja_Codigo.Text = Ds.Tables(0).Rows(0).Item("Codigo_Usuario").ToString
            If Not (Combo_Tipo Is Nothing) Then Combo_Tipo.Text = Ds.Tables(0).Rows(0).Item("Descripcion").ToString
            If Not (Caja_Apellidos Is Nothing) Then Caja_Apellidos.Text = Ds.Tables(0).Rows(0).Item("Apellidos").ToString
            If Not (Caja_Nombres Is Nothing) Then Caja_Nombres.Text = Ds.Tables(0).Rows(0).Item("Nombres").ToString
            If Not (Caja_Usuario Is Nothing) Then Caja_Usuario.Text = Ds.Tables(0).Rows(0).Item("Usuario").ToString
            If Not (Check_Activo Is Nothing) Then Check_Activo.Checked = Ds.Tables(0).Rows(0).Item("Activo")
        End If
    End Sub
    Public Sub Cargar_Botones_Activos(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton) as Codigo,Codigo_Usuario From Acceso_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='01'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub

    'Crear Llenado
    Public Sub Cargar_Botones_Sub_Botones_Modulo_01(ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo,Modulo,Primario As [Boton Primario],Secundario As [Boton Secundario] From Lista_Botones_SubBotones Where Left(Codigo,2)='01' Order By Codigo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Recorrdo As Integer = 0
            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Modulo").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Primario").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Secundario").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Sub_Botones_Modulo_02(ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo,Modulo,Primario As [Boton Primario],Secundario As [Boton Secundario] From Lista_Botones_SubBotones Where Left(Codigo,2)='02' Order By Codigo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Recorrdo As Integer = 0
            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Modulo").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Primario").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Secundario").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Sub_Botones_Modulo_03(ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo,Modulo,Primario As [Boton Primario],Secundario As [Boton Secundario] From Lista_Botones_SubBotones Where Left(Codigo,2)='03' Order By Codigo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Recorrdo As Integer = 0
            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Modulo").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Primario").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Secundario").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Sub_Botones_Modulo_04(ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo,Modulo,Primario As [Boton Primario],Secundario As [Boton Secundario] From Lista_Botones_SubBotones Where Left(Codigo,2)='04' Order By Codigo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Recorrdo As Integer = 0
            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Modulo").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Primario").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Secundario").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Sub_Botones_Modulo_05(ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo,Modulo,Primario As [Boton Primario],Secundario As [Boton Secundario] From Lista_Botones_SubBotones Where Left(Codigo,2)='05' Order By Codigo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Recorrdo As Integer = 0
            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Modulo").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Primario").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Secundario").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Sub_Botones_Modulo_06(ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo,Modulo,Primario As [Boton Primario],Secundario As [Boton Secundario] From Lista_Botones_SubBotones Where Left(Codigo,2)='06' Order By Codigo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Recorrdo As Integer = 0
            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Modulo").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Primario").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Secundario").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Sub_Botones_Modulo_07(ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo,Modulo,Primario As [Boton Primario],Secundario As [Boton Secundario] From Lista_Botones_SubBotones Where Left(Codigo,2)='07' Order By Codigo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Recorrdo As Integer = 0
            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Modulo").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Primario").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Secundario").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Sub_Botones_Modulo_08(ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo,Modulo,Primario As [Boton Primario],Secundario As [Boton Secundario] From Lista_Botones_SubBotones Where Left(Codigo,2)='08' Order By Codigo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Recorrdo As Integer = 0
            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Modulo").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Primario").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Boton Secundario").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Activos2(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton) as Codigo,Codigo_Usuario From Acceso_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='02'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Activos3(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton) as Codigo,Codigo_Usuario From Acceso_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='03'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Activos4(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton) as Codigo,Codigo_Usuario From Acceso_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='04'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Activos5(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton) as Codigo,Codigo_Usuario From Acceso_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='05'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Activos6(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton) as Codigo,Codigo_Usuario From Acceso_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='06'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Activos7(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton) as Codigo,Codigo_Usuario From Acceso_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='07'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_Botones_Activos8(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton) as Codigo,Codigo_Usuario From Acceso_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='08'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_Unidades_Activos(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Año_Ejecucion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Usuario_Unidad_Organica Where Codigo_Usuario='" & Codigo & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_SubBotones_Activos(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton + Codigo_Sub_Boton) as Codigo,Codigo_Usuario From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='01'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_SubBotones_Activos2(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton + Codigo_Sub_Boton) as Codigo,Codigo_Usuario From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='02'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_SubBotones_Activos3(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton + Codigo_Sub_Boton) as Codigo,Codigo_Usuario From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='03'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_SubBotones_Activos4(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton + Codigo_Sub_Boton) as Codigo,Codigo_Usuario From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='04'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_SubBotones_Activos5(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton + Codigo_Sub_Boton) as Codigo,Codigo_Usuario From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='05'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_SubBotones_Activos6(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton + Codigo_Sub_Boton) as Codigo,Codigo_Usuario From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='06'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_SubBotones_Activos7(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton + Codigo_Sub_Boton) as Codigo,Codigo_Usuario From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='07'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Cargar_SubBotones_Activos8(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select (Codigo_Modulo + Codigo_Boton + Codigo_Sub_Boton) as Codigo,Codigo_Usuario From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "' And Codigo_Modulo='08'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Klaus As Integer = 0
                For Klaus = 0 To DataGridView.Rows.Count - 1
                    If DataGridView.Rows(Klaus).Cells(0).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString Then
                        DataGridView.Rows(Klaus).Cells(4).Value = True
                    End If
                Next
            Next
        End If
    End Sub
    Public Sub Guardar_Accesos_Botones_Sub_Botones(ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridView2 As System.Windows.Forms.DataGridView, ByVal DataGridView3 As System.Windows.Forms.DataGridView, ByVal DataGridView4 As System.Windows.Forms.DataGridView, ByVal DataGridView5 As System.Windows.Forms.DataGridView, ByVal DataGridView6 As System.Windows.Forms.DataGridView, ByVal DataGridView7 As System.Windows.Forms.DataGridView, ByVal DataGridView8 As System.Windows.Forms.DataGridView)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Acceso_Botones Where Codigo_Usuario='" & Codigo & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing

        For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
            Select Case DataGridView.Rows(Recorrido).Cells(0).Value.ToString.Length
                Case 4
                    If DataGridView.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Usuario) Values ('" & Left(DataGridView.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Right(DataGridView.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
                Case 6
                    If DataGridView.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Sub_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Sub_Boton,Codigo_Usuario) Values ('" & Left(DataGridView.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Mid(DataGridView.Rows(Recorrido).Cells(0).Value.ToString, 3, 2) & "','" & Right(DataGridView.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
            End Select
        Next
        For Recorrido As Integer = 0 To DataGridView2.Rows.Count - 1
            Select Case DataGridView2.Rows(Recorrido).Cells(0).Value.ToString.Length
                Case 4
                    If DataGridView2.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Usuario) Values ('" & Left(DataGridView2.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Right(DataGridView2.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
                Case 6
                    If DataGridView2.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Sub_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Sub_Boton,Codigo_Usuario) Values ('" & Left(DataGridView2.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Mid(DataGridView2.Rows(Recorrido).Cells(0).Value.ToString, 3, 2) & "','" & Right(DataGridView2.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
            End Select
        Next
        For Recorrido As Integer = 0 To DataGridView3.Rows.Count - 1
            Select Case DataGridView3.Rows(Recorrido).Cells(0).Value.ToString.Length
                Case 4
                    If DataGridView3.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Usuario) Values ('" & Left(DataGridView3.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Right(DataGridView3.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
                Case 6
                    If DataGridView3.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Sub_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Sub_Boton,Codigo_Usuario) Values ('" & Left(DataGridView3.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Mid(DataGridView3.Rows(Recorrido).Cells(0).Value.ToString, 3, 2) & "','" & Right(DataGridView3.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
            End Select
        Next
        For Recorrido As Integer = 0 To DataGridView4.Rows.Count - 1
            Select Case DataGridView4.Rows(Recorrido).Cells(0).Value.ToString.Length
                Case 4
                    If DataGridView4.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Usuario) Values ('" & Left(DataGridView4.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Right(DataGridView4.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
                Case 6
                    If DataGridView4.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Sub_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Sub_Boton,Codigo_Usuario) Values ('" & Left(DataGridView4.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Mid(DataGridView4.Rows(Recorrido).Cells(0).Value.ToString, 3, 2) & "','" & Right(DataGridView4.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
            End Select
        Next
        For Recorrido As Integer = 0 To DataGridView5.Rows.Count - 1
            Select Case DataGridView5.Rows(Recorrido).Cells(0).Value.ToString.Length
                Case 4
                    If DataGridView5.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Usuario) Values ('" & Left(DataGridView5.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Right(DataGridView5.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
                Case 6
                    If DataGridView5.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Sub_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Sub_Boton,Codigo_Usuario) Values ('" & Left(DataGridView5.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Mid(DataGridView5.Rows(Recorrido).Cells(0).Value.ToString, 3, 2) & "','" & Right(DataGridView5.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
            End Select
        Next
        For Recorrido As Integer = 0 To DataGridView6.Rows.Count - 1
            Select Case DataGridView6.Rows(Recorrido).Cells(0).Value.ToString.Length
                Case 4
                    If DataGridView6.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Usuario) Values ('" & Left(DataGridView6.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Right(DataGridView6.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
                Case 6
                    If DataGridView6.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Sub_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Sub_Boton,Codigo_Usuario) Values ('" & Left(DataGridView6.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Mid(DataGridView6.Rows(Recorrido).Cells(0).Value.ToString, 3, 2) & "','" & Right(DataGridView6.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
            End Select
        Next
        For Recorrido As Integer = 0 To DataGridView7.Rows.Count - 1
            Select Case DataGridView7.Rows(Recorrido).Cells(0).Value.ToString.Length
                Case 4
                    If DataGridView7.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Usuario) Values ('" & Left(DataGridView7.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Right(DataGridView7.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
                Case 6
                    If DataGridView7.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Sub_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Sub_Boton,Codigo_Usuario) Values ('" & Left(DataGridView7.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Mid(DataGridView7.Rows(Recorrido).Cells(0).Value.ToString, 3, 2) & "','" & Right(DataGridView7.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
            End Select
        Next
        For Recorrido As Integer = 0 To DataGridView8.Rows.Count - 1
            Select Case DataGridView8.Rows(Recorrido).Cells(0).Value.ToString.Length
                Case 4
                    If DataGridView8.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Usuario) Values ('" & Left(DataGridView8.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Right(DataGridView8.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
                Case 6
                    If DataGridView8.Rows(Recorrido).Cells(4).Value = True Then
                        Cm = New OleDb.OleDbCommand
                        Cm.Connection = Cn
                        Cm.CommandTimeout = 0
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Insert Into Acceso_Sub_Botones(Codigo_Modulo,Codigo_Boton,Codigo_Sub_Boton,Codigo_Usuario) Values ('" & Left(DataGridView8.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Mid(DataGridView8.Rows(Recorrido).Cells(0).Value.ToString, 3, 2) & "','" & Right(DataGridView8.Rows(Recorrido).Cells(0).Value.ToString, 2) & "','" & Codigo & "')"
                        Cm.ExecuteNonQuery()
                        Cm = Nothing
                    End If
            End Select
        Next
    End Sub
    Public Sub Guardar_Accesos_Unidades_Organicas(ByVal Año_Ejecucion As String, ByVal Codigo As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Usuario_Unidad_Organica Where Codigo_Usuario='" & Codigo & "' And Año_Ejecucion='" & Año_Ejecucion & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing

        For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
            If DataGridView.Rows(Recorrido).Cells(4).Value = True Then
                Cm = New OleDb.OleDbCommand
                Cm.Connection = Cn
                Cm.CommandTimeout = 0
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Usuario_Unidad_Organica(Codigo_Usuario,Año_Ejecucion,Codigo_Unidad_Organica) Values ('" & Codigo & "','" & Año_Ejecucion & "','" & DataGridView.Rows(Recorrido).Cells(1).Value.ToString & "')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            End If
        Next
    End Sub
    Public Sub Eliminar_Usuario(ByVal Codigo As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Acceso_Sub_Botones Where Codigo_Usuario='" & Codigo & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Acceso_Botones Where Codigo_Usuario='" & Codigo & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Usuario Where Codigo_Usuario='" & Codigo & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Usuario(ByVal Codigo As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Usuario Set Activo=0 Where Codigo_Usuario='" & Codigo & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Usuarios(ByVal Codigo As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Asignar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Usuario Where Codigo_Usuario='" & Codigo & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Activo")
                Case True
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = False
                    Asignar.Enabled = True
                Case False
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Asignar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Asignar.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Generar_Reporte_Saldos_Ejecucion(ByVal Año_Ejecucion As String)
        Dim Da As New OleDb.OleDbDataAdapter("SELECT * FROM Vista_PIA Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Cm As New OleDb.OleDbCommand
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Tabla_Temporal_Ejecucion"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nueva_Ejecucion_PIA"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                Cm.Parameters.AddWithValue("@PIA", Ds.Tables(0).Rows(Recorrido).Item("PIA"))
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("SELECT * FROM Vista_PIM Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Cm = Nothing
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nueva_Ejecucion_PIM"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                Cm.Parameters.AddWithValue("@PIM", Ds.Tables(0).Rows(Recorrido).Item("PIM"))
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("SELECT * FROM Vista_Certificado Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Cm = Nothing
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nueva_Ejecucion_Certificado"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                Cm.Parameters.AddWithValue("@Certificado", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString))
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("SELECT * FROM Vista_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Cm = Nothing
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nueva_Ejecucion_Compromiso"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                Cm.Parameters.AddWithValue("@Comprometido", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Compromiso").ToString))
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("SELECT * FROM Vista_Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Cm = Nothing
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nueva_Ejecucion_Compromiso"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                Cm.Parameters.AddWithValue("@Comprometido", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Compromiso").ToString))
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Next
        End If
        Da = Nothing
        Ds = Nothing
        'Da = New OleDb.OleDbDataAdapter("SELECT * FROM Vista_Caja_Chica Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        'Ds = New Data.DataSet
        'Da.Fill(Ds)
        'If Ds.Tables(0).Rows.Count > 0 Then
        '    
        '    Cm = Nothing
        '    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
        '        Cm = New OleDb.OleDbCommand
        '        Cm.CommandTimeout = 0
        '        Cm.Connection = Cn
        '        Cm.CommandType = CommandType.StoredProcedure
        '        Cm.CommandText = "Nueva_Ejecucion_Compromiso"
        '        Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
        '        Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
        '        Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
        '        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
        '        Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
        '        Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
        '        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
        '        Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
        '        Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
        '        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
        '        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
        '        Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
        '        Cm.Parameters.AddWithValue("@Comprometido", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Compromiso").ToString))
        '        Cm.ExecuteNonQuery()
        '        Cm = Nothing
        '    Next
        'End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("SELECT * FROM Vista_Devengado_Compras Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Cm = Nothing
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nueva_Ejecucion_Devengado"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                Cm.Parameters.AddWithValue("@Devengado", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Devengado").ToString))
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("SELECT * FROM Vista_Devengado_Servicios Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Cm = Nothing
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nueva_Ejecucion_Devengado"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                Cm.Parameters.AddWithValue("@Devengado", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Devengado").ToString))
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Next
        End If
    End Sub
    Public Sub Cargar_Certificado_Rebajas(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Numero As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Numero.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Certificado_Rebajas_eliminar(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Numero As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
            Next
        End If
    End Sub

    Public Sub Cargar_Certificado_Ampliaciones_eliminar(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Numero As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Certificado_Ampliaciones(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Numero As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Contador As Integer = 0
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Numero.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Certificado_Ampliaciones_Editar(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Numero As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Cadena As String = ""
        Dim Contador As Integer = 0
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Numero.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                With Ds.Tables(0).Rows(Recorrido)
                    Cadena = Cadena & "'" & .Item("Codigo_FF") & "-" & .Item("Codigo_Rubro") & "-" & .Item("Clasificador") & "-" & .Item("Codigo_Secuencia_Funcional") & "-" & .Item("Codigo_Unidad_Organica") & "-" & .Item("Codigo_Actividad") & "-" & .Item("Codigo_Tipo_Recurso") & "',"
                End With
            Next
        End If
        Dim Klaus As Integer = 0
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Dim DaAdicional As New OleDb.OleDbDataAdapter("Select Distinct * From Lista_Detalle_Certificados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Convert(VarChar(1),Codigo_FF)+'-' + Codigo_Rubro +'-'+ Clasificador +'-'+ Codigo_Secuencia_Funcional +'-'+ Codigo_Unidad_Organica +'-'+ Codigo_Actividad +'-'+ Codigo_Tipo_Recurso Not In(" & Cadena & ") And Monto <=0", Cn)
        Dim DsAdicional As New Data.DataSet
        DaAdicional.Fill(DsAdicional)
        If DsAdicional.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To DsAdicional.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = DsAdicional.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
            Next
        End If
    End Sub
    Public Sub Nueva_Rebaja(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Rebaja As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Rebaja"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Rebaja", Codigo_Estado_Rebaja)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nueva_Ampliacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Rebaja As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Ampliacion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Ampliacion", Codigo_Estado_Rebaja)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Rebaja(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Rebaja"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Restaura_rebaja_distribucion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Restaura_rebaja_distribucion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Ampliacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Ampliacion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Restaura_Ampliacion_distribucion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Restaura_Ampliacion_distribucion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Rebaja(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Rebaja = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Rebaja
    End Function
    Public Function Generar_Numero_Ampliacion(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Ampliacion = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Ampliacion
    End Function
    Public Function Obtiene_numero_certificado_Rebaja(ByVal Año_Ejecucion As String, ByVal Variable_Numero_Rebaja_ As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("select Certificado from Rebaja where Año_Ejecucion='" & Año_Ejecucion & "' and numero ='" + Variable_Numero_Rebaja_ + "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Certificado").ToString)

        Return Right("0000" & Numero.ToString, 4)
    End Function

    Public Function Obtiene_numero_certificado_Ampliacion(ByVal Año_Ejecucion As String, ByVal Variable_Numero_Rebaja_ As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("select Certificado from Ampliacion where Año_Ejecucion='" & Año_Ejecucion & "' and numero ='" + Variable_Numero_Rebaja_ + "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Certificado").ToString)

        Return Right("0000" & Numero.ToString, 4)
    End Function
    Public Sub Evaluacion_Botones_Modulo_Rebajas(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Rebajas_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Rebaja").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Reenumerar.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Ampliaciones(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Ampliaciones_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Ampliacion").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Visualizar.Enabled = True
                    Reenumerar.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Visualizar.Enabled = True
                    Reenumerar.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Visualizar.Enabled = True
                    Reenumerar.Enabled = False
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Visualizar.Enabled = True
                    Reenumerar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Visualizar.Enabled = False
                    Reenumerar.Enabled = False
            End Select
        End If
    End Sub
    Public Function Cadena_Unidades_Organicas_Por_Usuario(ByVal Año_Ejecucion As String, ByVal Usuario As String) As String
        Cadena_Unidades_Organicas_Por_Usuario = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Usuarios_Unidades_Organicas Where Año_Ejecucion='" & Año_Ejecucion & "' And Usuario='" & Usuario & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Variable As String = ""

            Variable = "'"
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Variable = Variable & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString & "','"
            Next
            Cadena_Unidades_Organicas_Por_Usuario = Left(Variable, Variable.Trim.Length - 2)
        Else
            Cadena_Unidades_Organicas_Por_Usuario = "00"
        End If
        Return Cadena_Unidades_Organicas_Por_Usuario
    End Function
    Public Sub Mostrar_Data_Item_Catalogo(ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Tipo As Integer, ByVal Caja_Codigo_Grupo As System.Windows.Forms.TextBox, ByVal Caja_Grupo As System.Windows.Forms.TextBox, ByVal Caja_Codigo_Clase As System.Windows.Forms.TextBox, ByVal Caja_Clase As System.Windows.Forms.TextBox, ByVal Caja_Codigo_Familia As System.Windows.Forms.TextBox, ByVal Caja_Familia As System.Windows.Forms.TextBox, ByVal Caja_Codigo_Item As System.Windows.Forms.TextBox, ByVal Caja_Item As System.Windows.Forms.TextBox, ByVal Caja_Codigo_Unidad_Medida As System.Windows.Forms.TextBox, ByVal Caja_Unidad_Medida As System.Windows.Forms.TextBox, ByVal Caja_Tipo_Transaccion As System.Windows.Forms.TextBox, ByVal Caja_Generica As System.Windows.Forms.TextBox, ByVal Caja_Sub_Generica As System.Windows.Forms.TextBox, ByVal Caja_Sub_Generica_Detalle As System.Windows.Forms.TextBox, ByVal Caja_Especifica As System.Windows.Forms.TextBox, ByVal Caja_Especifica_Detalle As System.Windows.Forms.TextBox)
        Select Case Tipo
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Bienes Where Codigo_Grupo='" & Codigo_Grupo & "' And Codigo_Clase='" & Codigo_Clase & "' And Codigo_Familia='" & Codigo_Familia & "' And Codigo_Item='" & Codigo_Item & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Codigo_Grupo.Text = Ds.Tables(0).Rows(0).Item("Codigo_Grupo").ToString
                    Caja_Grupo.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Grupo").ToString
                    Caja_Codigo_Clase.Text = Ds.Tables(0).Rows(0).Item("Codigo_Clase").ToString
                    Caja_Clase.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Clase").ToString
                    Caja_Codigo_Familia.Text = Ds.Tables(0).Rows(0).Item("Codigo_Familia").ToString
                    Caja_Familia.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Familia").ToString
                    Caja_Codigo_Item.Text = Ds.Tables(0).Rows(0).Item("Codigo_Item").ToString
                    Caja_Item.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Item").ToString
                    Caja_Codigo_Unidad_Medida.Text = Ds.Tables(0).Rows(0).Item("Codigo_Unidad_Medida").ToString
                    Caja_Unidad_Medida.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Unidad_Medida").ToString
                    Caja_Tipo_Transaccion.Text = Ds.Tables(0).Rows(0).Item("Tipo_Transaccion").ToString
                    Caja_Generica.Text = Ds.Tables(0).Rows(0).Item("Generica").ToString
                    Caja_Sub_Generica.Text = Ds.Tables(0).Rows(0).Item("Sub_Generica").ToString
                    Caja_Sub_Generica_Detalle.Text = Ds.Tables(0).Rows(0).Item("Sub_Generica_Detalle").ToString
                    Caja_Especifica.Text = Ds.Tables(0).Rows(0).Item("Especifica").ToString
                    Caja_Especifica_Detalle.Text = Ds.Tables(0).Rows(0).Item("Especifica_Detalle").ToString

                Else
                    Caja_Codigo_Grupo.Text = String.Empty
                    Caja_Grupo.Text = String.Empty
                    Caja_Codigo_Clase.Text = String.Empty
                    Caja_Clase.Text = String.Empty
                    Caja_Codigo_Familia.Text = String.Empty
                    Caja_Familia.Text = String.Empty
                    Caja_Codigo_Item.Text = String.Empty
                    Caja_Item.Text = String.Empty
                    Caja_Codigo_Unidad_Medida.Text = String.Empty
                    Caja_Unidad_Medida.Text = String.Empty
                    Caja_Tipo_Transaccion.Text = String.Empty
                    Caja_Generica.Text = String.Empty
                    Caja_Sub_Generica.Text = String.Empty
                    Caja_Sub_Generica_Detalle.Text = String.Empty
                    Caja_Especifica.Text = String.Empty
                    Caja_Especifica_Detalle.Text = String.Empty
                    Return
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Servicios Where Codigo_Grupo='" & Codigo_Grupo & "' And Codigo_Clase='" & Codigo_Clase & "' And Codigo_Familia='" & Codigo_Familia & "' And Codigo_Item='" & Codigo_Item & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Codigo_Grupo.Text = Ds.Tables(0).Rows(0).Item("Codigo_Grupo").ToString
                    Caja_Grupo.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Grupo").ToString
                    Caja_Codigo_Clase.Text = Ds.Tables(0).Rows(0).Item("Codigo_Clase").ToString
                    Caja_Clase.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Clase").ToString
                    Caja_Codigo_Familia.Text = Ds.Tables(0).Rows(0).Item("Codigo_Familia").ToString
                    Caja_Familia.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Familia").ToString
                    Caja_Codigo_Item.Text = Ds.Tables(0).Rows(0).Item("Codigo_Item").ToString
                    Caja_Item.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Item").ToString
                    Caja_Codigo_Unidad_Medida.Text = Ds.Tables(0).Rows(0).Item("Codigo_Unidad_Medida").ToString
                    Caja_Unidad_Medida.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Unidad_Medida").ToString
                    Caja_Tipo_Transaccion.Text = Ds.Tables(0).Rows(0).Item("Tipo_Transaccion").ToString
                    Caja_Generica.Text = Ds.Tables(0).Rows(0).Item("Generica").ToString
                    Caja_Sub_Generica.Text = Ds.Tables(0).Rows(0).Item("Sub_Generica").ToString
                    Caja_Sub_Generica_Detalle.Text = Ds.Tables(0).Rows(0).Item("Sub_Generica_Detalle").ToString
                    Caja_Especifica.Text = Ds.Tables(0).Rows(0).Item("Especifica").ToString
                    Caja_Especifica_Detalle.Text = Ds.Tables(0).Rows(0).Item("Especifica_Detalle").ToString
                Else
                    Caja_Codigo_Grupo.Text = String.Empty
                    Caja_Grupo.Text = String.Empty
                    Caja_Codigo_Clase.Text = String.Empty
                    Caja_Clase.Text = String.Empty
                    Caja_Codigo_Familia.Text = String.Empty
                    Caja_Familia.Text = String.Empty
                    Caja_Codigo_Item.Text = String.Empty
                    Caja_Item.Text = String.Empty
                    Caja_Codigo_Unidad_Medida.Text = String.Empty
                    Caja_Unidad_Medida.Text = String.Empty
                    Caja_Tipo_Transaccion.Text = String.Empty
                    Caja_Generica.Text = String.Empty
                    Caja_Sub_Generica.Text = String.Empty
                    Caja_Sub_Generica_Detalle.Text = String.Empty
                    Caja_Especifica.Text = String.Empty
                    Caja_Especifica_Detalle.Text = String.Empty
                    Return
                End If
        End Select
    End Sub
    Public Sub Nuevo_Requerimiento_Bienes(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Requerimiento As String, ByVal Monto_Referencial As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Requerimiento_Bienes"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Requerimiento", Codigo_Estado_Requerimiento)
        Cm.Parameters.AddWithValue("@Monto_Referencial", Monto_Referencial)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Requerimiento_Servicios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Requerimiento As String, ByVal Monto_Referencial As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Requerimiento_Servicios"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Requerimiento", Codigo_Estado_Requerimiento)
        Cm.Parameters.AddWithValue("@Monto_Referencial", Monto_Referencial)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Requerimiento_Bienes(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Double, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Requerimiento_Bienes"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Requerimiento_Servicios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Double, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Requerimiento_Servicios"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Consulta_Saldo_por_Unidad_Organica(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String) as DataSet
        Dim ds As New DataSet
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "usp_verifica_saldo_disponible"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)

        Cm.ExecuteNonQuery()

        Dim adapter As New OleDbDataAdapter(Cm)
        adapter.Fill(ds)
        return ds
    End Function
    Public Function Consulta_Saldo_Unidades_Organicas(ByVal Año_Ejecucion As String) as DataSet
        Dim ds As New DataSet
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "usp_lista_saldos_generales"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)

        Cm.ExecuteNonQuery()

        Dim adapter As New OleDbDataAdapter(Cm)
        adapter.Fill(ds)
        return ds
    End Function
    Public Sub Cargar_Data_Modificacion_Clave(ByVal Usuario As String, ByVal Caja_Apellidos As System.Windows.Forms.TextBox, ByVal Caja_Nombes As System.Windows.Forms.TextBox, ByVal Caja_Usuario As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Usuarios Where Usuario ='" & Usuario & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Apellidos.Text = Ds.Tables(0).Rows(0).Item("Apellidos").ToString
            Caja_Nombes.Text = Ds.Tables(0).Rows(0).Item("Nombres").ToString
            Caja_Usuario.Text = Ds.Tables(0).Rows(0).Item("Usuario").ToString
        End If
    End Sub
    Public Sub Cambiar_Clave(ByVal Usuaro As String, ByVal Clave As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Usuario Set Clave='" & Clave & "' Where Usuario = '" & Usuaro & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Cargar_Data_Reporte_Modificaciones(ByVal Año_Ejecucion As String)
        'Dim Da As New OleDb.OleDbDataAdapter("Select * From Vista_Reporte_Modificaciones_Simple Where Monto > 0", Cn)
        'Dim Ds As New Data.DataSet
        Dim CmEx As New OleDb.OleDbCommand
        CmEx.CommandTimeout = 0
        CmEx.Connection = Cn
        CmEx.CommandType = CommandType.StoredProcedure
        CmEx.CommandText = "Recopilar_Notas"
        CmEx.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        CmEx.ExecuteNonQuery()
        CmEx = Nothing
        'Da.Fill(Ds)
        'If Ds.Tables(0).Rows.Count > 0 Then
        '    
        '    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
        '        Dim Cm As New OleDb.OleDbCommand
        '        Cm.CommandTimeout = 0
        '        Cm.Connection = Cn
        '        Cm.CommandType = CommandType.StoredProcedure
        '        Cm.CommandText = "Nuevo_Registro_Tabla_Temporal_Modificaciones_Creditos"
        '        Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString)
        '        Cm.Parameters.AddWithValue("@Numero", Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString)
        '        Cm.Parameters.AddWithValue("@FechaEmision", Ds.Tables(0).Rows(Recorrido).Item("FechaEmision"))
        '        Cm.Parameters.AddWithValue("@Codigo_Estado_Nota", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Estado_Nota").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_FF", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString))
        '        Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString)
        '        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString)
        '        Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString)
        '        Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString)
        '        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString)
        '        Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString)
        '        Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString)
        '        Cm.Parameters.AddWithValue("@Credito", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString))
        '        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_Motivo_Nota", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Motivo_Nota").ToString)
        '        Cm.ExecuteNonQuery()
        '    Next
        'End If
        'Ds = Nothing
        'Da = Nothing
        'Da = New OleDb.OleDbDataAdapter("Select * From Vista_Reporte_Modificaciones_Simple Where Monto < 0", Cn)
        'Ds = New Data.DataSet
        'Da.Fill(Ds)
        'If Ds.Tables(0).Rows.Count > 0 Then
        '    
        '    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
        '        Dim Cm As New OleDb.OleDbCommand
        '        Cm.CommandTimeout = 0
        '        Cm.Connection = Cn
        '        Cm.CommandType = CommandType.StoredProcedure
        '        Cm.CommandText = "Nuevo_Registro_Tabla_Temporal_Modificaciones_Anulaciones"
        '        Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString)
        '        Cm.Parameters.AddWithValue("@Numero", Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString)
        '        Cm.Parameters.AddWithValue("@FechaEmision", Ds.Tables(0).Rows(Recorrido).Item("FechaEmision"))
        '        Cm.Parameters.AddWithValue("@Codigo_Estado_Nota", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Estado_Nota").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_FF", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString))
        '        Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString)
        '        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString)
        '        Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString)
        '        Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString)
        '        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString)
        '        Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString)
        '        Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString)
        '        Cm.Parameters.AddWithValue("@Anulacion", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString))
        '        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString)
        '        Cm.Parameters.AddWithValue("@Codigo_Motivo_Nota", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Motivo_Nota").ToString)
        '        Cm.ExecuteNonQuery()
        '    Next
        'End If
    End Sub
    Public Sub Cargar_Certificado_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Saldo As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("select Año_Ejecucion,Numero,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Descripcion_Tipo_Recurso as TR,Meta,Codigo_Secuencia_Funcional As [Sec.Fun.],Clasificador,Monto,Saldo,Total,Codigo_Tipo_Recurso From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Total").ToString), "###,###,#.00")

            DataGridView.Rows.Clear()
            Dim Saldo As Double = 0
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sec.Fun.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Saldo = Saldo + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString)
            Next
            Caja_Saldo.Text = Format(Saldo, "###,###,#.00")
        End If
    End Sub
    Public Sub Cargar_Certificado_Registro_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Saldo As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("select Año_Ejecucion,Numero,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Descripcion_Tipo_Recurso as TR,Meta,Codigo_Secuencia_Funcional As [Sec.Fun.],Clasificador,Monto,Saldo,Total,Codigo_Tipo_Recurso From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Total").ToString), "###,###,#.00")

            DataGridView.Rows.Clear()
            Dim Saldo As Double = 0
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sec.Fun.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Saldo = Saldo + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString)
            Next
            Caja_Saldo.Text = Format(Saldo, "###,###,#.00")
        End If
    End Sub
    Public Function Numero_Certificado_Caja_General(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, Optional ByVal Numero_Rendicion As Integer = Nothing) As String
        Numero_Certificado_Caja_General = ""
        Select Case Codigo_Tipo_Caja
            Case "01"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Numero_Certificado_Caja_General = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                End If
            Case "02"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion=" & Numero_Rendicion & "", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Numero_Certificado_Caja_General = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                End If
        End Select
        Return Numero_Certificado_Caja_General
    End Function
    Public Sub Cargar_Certificado_Apertura_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Saldo As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Descripcion_Tipo_Recurso as TR,Meta,Codigo_Secuencia_Funcional As [Sec.Fun.],Clasificador,Monto,Saldo,Total,Codigo_Tipo_Recurso From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Total").ToString), "###,###,#.00")

            DataGridView.Rows.Clear()
            Dim Saldo As Double = 0
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sec.Fun.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Saldo = Saldo + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString)
            Next
            Caja_Saldo.Text = Format(Saldo, "###,###,#.00")
        End If
    End Sub
    Public Function Validar_Meta_Certificado_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Caja As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String) As Boolean
        Validar_Meta_Certificado_Caja_Chica = True
        If Validar_Meta_Certificado_Caja_Chica = True Then
            Select Case Codigo_Tipo_Caja
                Case "01"
                    Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Sum(Saldo) As Saldo From Lista_Detalle_Certificados_Basica_Reportar_Saldos where Año_Ejecucion ='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_SIAF ='C' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' Group By Codigo_Secuencia_Funcional,Codigo_Unidad_Organica", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Validar_Meta_Certificado_Caja_Chica = True
                    Else
                        Validar_Meta_Certificado_Caja_Chica = False
                    End If
                Case "02"
                    Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Sum(Saldo) As Saldo From Lista_Detalle_Certificados_Basica_Reportar_Saldos where Año_Ejecucion ='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_SIAF ='RC' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' Group By Codigo_Secuencia_Funcional,Codigo_Unidad_Organica", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Validar_Meta_Certificado_Caja_Chica = True
                    Else
                        Validar_Meta_Certificado_Caja_Chica = False
                    End If
            End Select
        End If
        Return Validar_Meta_Certificado_Caja_Chica
    End Function
    Public Sub Cargar_Certificado_Planilla_Detalles(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("select Año_Ejecucion,Numero,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Descripcion_Tipo_Recurso as TR,Meta,Codigo_Secuencia_Funcional As [Sec.Fun.],Clasificador,Monto,Saldo,Total,Codigo_Tipo_Recurso From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            Dim Saldo As Double = 0
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sec.Fun.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Saldo = Saldo + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString)
            Next
        End If
    End Sub
    Public Sub Cargar_Certificados_Detalles_Planilla_Compromisos(ByVal Año_Ejecucion As String, ByVal Cadena_Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Codigo_FF,Codigo_Rubro,Descripcion_Tipo_Recurso as TR,Meta,Clasificador,Monto,Saldo,Total,Codigo_Tipo_Recurso,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Descripcion_Especifica_Detalle,Codigo_Unidad_Organica,Codigo_Actividad From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero In(" & Cadena_Numero & ") Order By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Clasificador", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            Dim Saldo As Double = 0
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
            Next
        End If
    End Sub
    Public Sub Cargar_Certificado_Detalle_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Saldo As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("select Año_Ejecucion,Numero,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Descripcion_Tipo_Recurso as TR,Meta,Codigo_Secuencia_Funcional As [Sec.Fun.],Clasificador,Monto,Saldo,Total,Codigo_Tipo_Recurso From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Total").ToString), "###,###,#.00")

            DataGridView.Rows.Clear()
            Dim Saldo As Double = 0
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sec.Fun.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Saldo = Saldo + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString)
            Next
            Caja_Saldo.Text = Format(Saldo, "###,###,#.00")
        End If
    End Sub
    Public Sub Cargar_Certificado_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Saldo As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("select Año_Ejecucion,Numero,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Descripcion_Tipo_Recurso as TR,Meta,Codigo_Secuencia_Funcional As [Sec.Fun.],Clasificador,Monto,Saldo,Total,Codigo_Tipo_Recurso From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Total").ToString), "###,###,#.00")

            DataGridView.Rows.Clear()
            Dim Saldo As Double = 0
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sec.Fun.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Saldo = Saldo + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString)
            Next
            Caja_Saldo.Text = Format(Saldo, "###,###,#.00")
        End If
    End Sub
    Public Sub Cargar_Requerimiento_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Unidad_Organica +' - '+ Abreviatura As Unidad,Convert(VarChar(10),FechaEmision,103) As Emision,Convert(VarChar(10),FechaAutorizacion,103) As Autorizacion,Convert(VarChar(10),FechaAprobacion,103) As Aprobacion,Descripcion_Estado_Requerimiento As Estado  from [dbo].[lista_requerimientos_bienes_basica] Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Unidad").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Autorizacion").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Aprobacion").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Estado").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Requerimiento_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Unidad_Organica +' - '+ Abreviatura As Unidad,Convert(VarChar(10),FechaEmision,103) As Emision,Convert(VarChar(10),FechaAutorizacion,103) As Autorizacion,Convert(VarChar(10),FechaAprobacion,103) As Aprobacion,Descripcion_Estado_Requerimiento As Estado  from [dbo].[lista_requerimientos_servicios_basica] Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Unidad").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Autorizacion").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Aprobacion").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Estado").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Requerimiento_Orden_Compra_2(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Documentos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Documento ='01'", Cn)
        Dim Ds As New Data.DataSet
        Dim Cadena As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cadena = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero_Documento").ToString & "',"
            Next
        End If
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Unidad_Organica +' - '+ Abreviatura As Unidad,Convert(VarChar(10),FechaEmision,103) As Emision,Convert(VarChar(10),FechaAutorizacion,103) As Autorizacion,Convert(VarChar(10),FechaAprobacion,103) As Aprobacion,Descripcion_Estado_Requerimiento As Estado  from [dbo].[lista_requerimientos_bienes_basica] Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero In(" & Cadena & ")", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Unidad").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Autorizacion").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Aprobacion").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Estado").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Requerimiento_Orden_Servicios_2(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Servicio_Documentos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Documento ='02'", Cn)
        Dim Ds As New Data.DataSet
        Dim Cadena As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cadena = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero_Documento").ToString & "',"
            Next
        End If
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Unidad_Organica +' - '+ Abreviatura As Unidad,Convert(VarChar(10),FechaEmision,103) As Emision,Convert(VarChar(10),FechaAutorizacion,103) As Autorizacion,Convert(VarChar(10),FechaAprobacion,103) As Aprobacion,Descripcion_Estado_Requerimiento As Estado  from [dbo].[lista_requerimientos_servicios_basica] Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero In(" & Cadena & ")", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Unidad").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Autorizacion").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Aprobacion").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Estado").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Items_Asistente(ByVal Año_Ejecucion As String, ByVal Cadena As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Codigo,Descripcion_Item,Descripcion_Unidad_Medida From Lista_Detalle_Requerimientos_Bienes_Basica_Orden_Preliminar_Saldos_Totales_Reportar Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero In(" & Cadena & ") And Cantidad > 0", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Unidad_Medida").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Items_Asistente_2(ByVal Año_Ejecucion As String, ByVal Cadena As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Codigo,Descripcion_Item,Descripcion_Unidad_Medida From Lista_Detalle_Requerimientos_Servicios_Basica_Orden_Preliminar_Saldos_Totales_Reportar Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero In(" & Cadena & ") And Cantidad > 0", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Unidad_Medida").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Items_Asistente_Distribucion(ByVal Año_Ejecucion As String, ByVal Cadena As String, ByVal Cadena_2 As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Requerimientos_Bienes_Basica_Orden_Preliminar_Saldos_Totales_Reportar Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero In(" & Cadena & ") And Codigo In(" & Cadena_2 & ") And Cantidad > 0 Order By Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), "###,###,#.00000")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = "0.00000"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = "0.00000"
                DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = "0.00000"
            Next
        End If
    End Sub
    Public Sub Cargar_Items_Asistente_Distribucion_2(ByVal Año_Ejecucion As String, ByVal Cadena As String, ByVal Cadena_2 As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Requerimientos_Servicios_Basica_Orden_Preliminar_Saldos_Totales_Reportar Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero In(" & Cadena & ") And Codigo In(" & Cadena_2 & ") And Cantidad > 0 Order By Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = "0.00"
                DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = "0.00"
            Next
        End If
    End Sub
    Public Function Numeros_Requerimientos_Filtrar_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Cadena_Clasificadores As String, Optional ByVal Cadena_Secuencia_Funcional As String = Nothing) As String
        Numeros_Requerimientos_Filtrar_Orden_Compra = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Requerimientos_Bienes_Basica_Orden_Preliminar_Saldos_Totales_Reportar Where Clasificador In(" & Cadena_Clasificadores & ") And Codigo_Secuencia_Funcional In(" & Cadena_Secuencia_Funcional & ") And Cantidad>0", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Numeros_Requerimientos_Filtrar_Orden_Compra = Numeros_Requerimientos_Filtrar_Orden_Compra & "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString & "',"
            Next
            Numeros_Requerimientos_Filtrar_Orden_Compra = Microsoft.VisualBasic.Left(Numeros_Requerimientos_Filtrar_Orden_Compra, Numeros_Requerimientos_Filtrar_Orden_Compra.Trim.Length - 1)
        Else
            Numeros_Requerimientos_Filtrar_Orden_Compra = "00000"
        End If
        Return Numeros_Requerimientos_Filtrar_Orden_Compra
    End Function
    Public Function Numeros_Requerimientos_Filtrar_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Cadena_Clasificadores As String, Optional ByVal Cadena_Secuencia_Funcional As String = Nothing) As String
        Numeros_Requerimientos_Filtrar_Orden_Servicio = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Requerimientos_Servicios_Basica_Orden_Preliminar_Saldos_Totales_Reportar Where Clasificador In(" & Cadena_Clasificadores & ") And Codigo_Secuencia_Funcional In(" & Cadena_Secuencia_Funcional & ") And Cantidad>0", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Numeros_Requerimientos_Filtrar_Orden_Servicio = Numeros_Requerimientos_Filtrar_Orden_Servicio & "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString & "',"
            Next
            Numeros_Requerimientos_Filtrar_Orden_Servicio = Microsoft.VisualBasic.Left(Numeros_Requerimientos_Filtrar_Orden_Servicio, Numeros_Requerimientos_Filtrar_Orden_Servicio.Trim.Length - 1)
        Else
            Numeros_Requerimientos_Filtrar_Orden_Servicio = "00000"
        End If
        Return Numeros_Requerimientos_Filtrar_Orden_Servicio
    End Function
    Public Sub Cargar_Clasificador_Detalle_Para_Reportes_Personalizados(ByVal Año_Ejecucion As String, ByVal TT As String, ByVal G As String, ByVal SG As String, ByVal SGD As String, ByVal E As String, ByVal ED As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Clasificadores_2 Where TT='" & TT & "' And G='" & G & "' And SG='" & SG & "' And SGD='" & SGD & "' And E='" & E & "' And ED='" & ED & "' And Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
            Next
        End If
    End Sub
    Public Sub Eliminar_Contenido_Tabla_Temporal(ByVal Tabla As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From " & Tabla
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Eliminar_Contenido_Tabla_Temporal_Parametro(ByVal Consulta As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = Consulta
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub LLenar_Detalle_Orden_Compra(ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Operacion As String)

        If DataGridView.Rows.Count > 0 Then
            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Compra Where Año_Ejecucion = '" & DataGridView.Rows(Recorrido).Cells(0).Value & "'  And  Numero = '" & DataGridView.Rows(Recorrido).Cells(1).Value & "'  And  	Codigo_FF = '" & DataGridView.Rows(Recorrido).Cells(2).Value & "'  And  	Codigo_Rubro = '" & DataGridView.Rows(Recorrido).Cells(3).Value & "'  And  	Tipo_Transaccion = '" & DataGridView.Rows(Recorrido).Cells(5).Value & "'  And  	Generica = '" & DataGridView.Rows(Recorrido).Cells(6).Value & "'  And  	Sub_Generica = '" & DataGridView.Rows(Recorrido).Cells(7).Value & "'  And  	Sub_Generica_Detalle = '" & DataGridView.Rows(Recorrido).Cells(8).Value & "'  And  	Especifica = '" & DataGridView.Rows(Recorrido).Cells(9).Value & "'  And Especifica_Detalle = '" & DataGridView.Rows(Recorrido).Cells(10).Value & "'  And  	Codigo_Secuencia_Funcional = '" & DataGridView.Rows(Recorrido).Cells(12).Value & "'  And  	Codigo_Unidad_Organica = '" & DataGridView.Rows(Recorrido).Cells(13).Value & "'  And  	Codigo_Actividad = '" & DataGridView.Rows(Recorrido).Cells(15).Value & "'  And  	Codigo_Catalogo = '" & DataGridView.Rows(Recorrido).Cells(16).Value & "'  And  	Codigo_Grupo = '" & DataGridView.Rows(Recorrido).Cells(17).Value & "'  And Codigo_Clase = '" & DataGridView.Rows(Recorrido).Cells(18).Value & "'  And  	Codigo_Familia = '" & DataGridView.Rows(Recorrido).Cells(19).Value & "'  And  	Codigo_Item = '" & DataGridView.Rows(Recorrido).Cells(20).Value & "'  And  	Cantidad = '" & Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(24).Value) & "'  And Costo = '" & Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(25).Value) & "' And Operacion='" & Operacion & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Mensaje As String = ""
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.StoredProcedure
                    Cm.CommandText = "Nuevo_Detalle_Temporal_Detalle_Ejecucion_Orden_Compra"
                    Cm.Parameters.AddWithValue("@Año_Ejecucion", DataGridView.Rows(Recorrido).Cells(0).Value)
                    Cm.Parameters.AddWithValue("@Numero", DataGridView.Rows(Recorrido).Cells(1).Value)
                    Cm.Parameters.AddWithValue("@Codigo_FF", DataGridView.Rows(Recorrido).Cells(2).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Rubro", DataGridView.Rows(Recorrido).Cells(3).Value)
                    Cm.Parameters.AddWithValue("@Tipo_Transaccion", DataGridView.Rows(Recorrido).Cells(5).Value)
                    Cm.Parameters.AddWithValue("@Generica", DataGridView.Rows(Recorrido).Cells(6).Value)
                    Cm.Parameters.AddWithValue("@Sub_Generica", DataGridView.Rows(Recorrido).Cells(7).Value)
                    Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", DataGridView.Rows(Recorrido).Cells(8).Value)
                    Cm.Parameters.AddWithValue("@Especifica", DataGridView.Rows(Recorrido).Cells(9).Value)
                    Cm.Parameters.AddWithValue("@Especifica_Detalle", DataGridView.Rows(Recorrido).Cells(10).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", DataGridView.Rows(Recorrido).Cells(12).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", DataGridView.Rows(Recorrido).Cells(13).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Actividad", DataGridView.Rows(Recorrido).Cells(15).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Catalogo", DataGridView.Rows(Recorrido).Cells(16).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Grupo", DataGridView.Rows(Recorrido).Cells(17).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Clase", DataGridView.Rows(Recorrido).Cells(18).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Familia", DataGridView.Rows(Recorrido).Cells(19).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Item", DataGridView.Rows(Recorrido).Cells(20).Value)
                    Cm.Parameters.AddWithValue("@Cantidad", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(24).Value))
                    Cm.Parameters.AddWithValue("@Costo", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(25).Value))
                    Cm.Parameters.AddWithValue("@Operacion", Operacion)
                    Cm.ExecuteNonQuery()
                End If
            Next
        End If
    End Sub
    Public Sub LLenar_Detalle_Orden_Compra_2(ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Operacion As String)

        If DataGridView.Rows.Count > 0 Then
            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Compra Where Año_Ejecucion = '" & DataGridView.Rows(Recorrido).Cells(0).Value & "'  And  Numero = '" & DataGridView.Rows(Recorrido).Cells(1).Value & "'  And  	Codigo_FF = '" & DataGridView.Rows(Recorrido).Cells(2).Value & "'  And  	Codigo_Rubro = '" & DataGridView.Rows(Recorrido).Cells(3).Value & "'  And  	Tipo_Transaccion = '" & DataGridView.Rows(Recorrido).Cells(5).Value & "'  And  	Generica = '" & DataGridView.Rows(Recorrido).Cells(6).Value & "'  And  	Sub_Generica = '" & DataGridView.Rows(Recorrido).Cells(7).Value & "'  And  	Sub_Generica_Detalle = '" & DataGridView.Rows(Recorrido).Cells(8).Value & "'  And  	Especifica = '" & DataGridView.Rows(Recorrido).Cells(9).Value & "'  And Especifica_Detalle = '" & DataGridView.Rows(Recorrido).Cells(10).Value & "'  And  	Codigo_Secuencia_Funcional = '" & DataGridView.Rows(Recorrido).Cells(12).Value & "'  And  	Codigo_Unidad_Organica = '" & DataGridView.Rows(Recorrido).Cells(13).Value & "'  And  	Codigo_Actividad = '" & DataGridView.Rows(Recorrido).Cells(15).Value & "'  And  	Codigo_Catalogo = '" & DataGridView.Rows(Recorrido).Cells(16).Value & "'  And  	Codigo_Grupo = '" & DataGridView.Rows(Recorrido).Cells(17).Value & "'  And Codigo_Clase = '" & DataGridView.Rows(Recorrido).Cells(18).Value & "'  And  	Codigo_Familia = '" & DataGridView.Rows(Recorrido).Cells(19).Value & "'  And  	Codigo_Item = '" & DataGridView.Rows(Recorrido).Cells(20).Value & "'  And  	Cantidad = '" & Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(24).Value) & "'  And Costo = '" & Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(25).Value) & "' And Operacion='" & Operacion & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Mensaje As String = ""
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.StoredProcedure
                    Cm.CommandText = "Nuevo_Detalle_Temporal_Detalle_Ejecucion_Orden_Compra_2"
                    Cm.Parameters.AddWithValue("@Año_Ejecucion", DataGridView.Rows(Recorrido).Cells(0).Value)
                    Cm.Parameters.AddWithValue("@Numero", DataGridView.Rows(Recorrido).Cells(1).Value)
                    Cm.Parameters.AddWithValue("@Codigo_FF", DataGridView.Rows(Recorrido).Cells(2).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Rubro", DataGridView.Rows(Recorrido).Cells(3).Value)
                    Cm.Parameters.AddWithValue("@Tipo_Transaccion", DataGridView.Rows(Recorrido).Cells(5).Value)
                    Cm.Parameters.AddWithValue("@Generica", DataGridView.Rows(Recorrido).Cells(6).Value)
                    Cm.Parameters.AddWithValue("@Sub_Generica", DataGridView.Rows(Recorrido).Cells(7).Value)
                    Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", DataGridView.Rows(Recorrido).Cells(8).Value)
                    Cm.Parameters.AddWithValue("@Especifica", DataGridView.Rows(Recorrido).Cells(9).Value)
                    Cm.Parameters.AddWithValue("@Especifica_Detalle", DataGridView.Rows(Recorrido).Cells(10).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", DataGridView.Rows(Recorrido).Cells(12).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", DataGridView.Rows(Recorrido).Cells(13).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Actividad", DataGridView.Rows(Recorrido).Cells(15).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Catalogo", DataGridView.Rows(Recorrido).Cells(16).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Grupo", DataGridView.Rows(Recorrido).Cells(17).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Clase", DataGridView.Rows(Recorrido).Cells(18).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Familia", DataGridView.Rows(Recorrido).Cells(19).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Item", DataGridView.Rows(Recorrido).Cells(20).Value)
                    Cm.Parameters.AddWithValue("@Cantidad", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(24).Value))
                    Cm.Parameters.AddWithValue("@Costo", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(25).Value))
                    Cm.Parameters.AddWithValue("@Operacion", Operacion)
                    Cm.Parameters.AddWithValue("@IGV", True)
                    Cm.ExecuteNonQuery()
                End If
            Next
        End If
    End Sub
    Public Sub LLenar_Detalle_Orden_Servicio(ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Operacion As String)

        If DataGridView.Rows.Count > 0 Then
            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Servicio Where Año_Ejecucion = '" & DataGridView.Rows(Recorrido).Cells(0).Value & "'  And  Numero = '" & DataGridView.Rows(Recorrido).Cells(1).Value & "'  And  	Codigo_FF = '" & DataGridView.Rows(Recorrido).Cells(2).Value & "'  And  	Codigo_Rubro = '" & DataGridView.Rows(Recorrido).Cells(3).Value & "'  And  	Tipo_Transaccion = '" & DataGridView.Rows(Recorrido).Cells(5).Value & "'  And  	Generica = '" & DataGridView.Rows(Recorrido).Cells(6).Value & "'  And  	Sub_Generica = '" & DataGridView.Rows(Recorrido).Cells(7).Value & "'  And  	Sub_Generica_Detalle = '" & DataGridView.Rows(Recorrido).Cells(8).Value & "'  And  	Especifica = '" & DataGridView.Rows(Recorrido).Cells(9).Value & "'  And Especifica_Detalle = '" & DataGridView.Rows(Recorrido).Cells(10).Value & "'  And  	Codigo_Secuencia_Funcional = '" & DataGridView.Rows(Recorrido).Cells(12).Value & "'  And  	Codigo_Unidad_Organica = '" & DataGridView.Rows(Recorrido).Cells(13).Value & "'  And  	Codigo_Actividad = '" & DataGridView.Rows(Recorrido).Cells(15).Value & "'  And  	Codigo_Catalogo = '" & DataGridView.Rows(Recorrido).Cells(16).Value & "'  And  	Codigo_Grupo = '" & DataGridView.Rows(Recorrido).Cells(17).Value & "'  And Codigo_Clase = '" & DataGridView.Rows(Recorrido).Cells(18).Value & "'  And  	Codigo_Familia = '" & DataGridView.Rows(Recorrido).Cells(19).Value & "'  And  	Codigo_Item = '" & DataGridView.Rows(Recorrido).Cells(20).Value & "'  And  	Cantidad = '" & Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(24).Value) & "'  And Costo = '" & Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(25).Value) & "' And Operacion='" & Operacion & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Mensaje As String = ""
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.StoredProcedure
                    Cm.CommandText = "Nuevo_Detalle_Temporal_Detalle_Ejecucion_Orden_Servicio"
                    Cm.Parameters.AddWithValue("@Año_Ejecucion", DataGridView.Rows(Recorrido).Cells(0).Value)
                    Cm.Parameters.AddWithValue("@Numero", DataGridView.Rows(Recorrido).Cells(1).Value)
                    Cm.Parameters.AddWithValue("@Codigo_FF", DataGridView.Rows(Recorrido).Cells(2).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Rubro", DataGridView.Rows(Recorrido).Cells(3).Value)
                    Cm.Parameters.AddWithValue("@Tipo_Transaccion", DataGridView.Rows(Recorrido).Cells(5).Value)
                    Cm.Parameters.AddWithValue("@Generica", DataGridView.Rows(Recorrido).Cells(6).Value)
                    Cm.Parameters.AddWithValue("@Sub_Generica", DataGridView.Rows(Recorrido).Cells(7).Value)
                    Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", DataGridView.Rows(Recorrido).Cells(8).Value)
                    Cm.Parameters.AddWithValue("@Especifica", DataGridView.Rows(Recorrido).Cells(9).Value)
                    Cm.Parameters.AddWithValue("@Especifica_Detalle", DataGridView.Rows(Recorrido).Cells(10).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", DataGridView.Rows(Recorrido).Cells(12).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", DataGridView.Rows(Recorrido).Cells(13).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Actividad", DataGridView.Rows(Recorrido).Cells(15).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Catalogo", DataGridView.Rows(Recorrido).Cells(16).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Grupo", DataGridView.Rows(Recorrido).Cells(17).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Clase", DataGridView.Rows(Recorrido).Cells(18).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Familia", DataGridView.Rows(Recorrido).Cells(19).Value)
                    Cm.Parameters.AddWithValue("@Codigo_Item", DataGridView.Rows(Recorrido).Cells(20).Value)
                    Cm.Parameters.AddWithValue("@Cantidad", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(24).Value))
                    Cm.Parameters.AddWithValue("@Costo", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(25).Value))
                    Cm.Parameters.AddWithValue("@Operacion", Operacion)
                    Cm.ExecuteNonQuery()
                End If
            Next
        End If
    End Sub
    Public Sub LLenar_Detalle_Orden_Compra_Para_Edicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Centro_Costos Where Año_Ejecucion = '" & Año_Ejecucion & "' And  Numero = '" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nuevo_Detalle_Temporal_Detalle_Ejecucion_Orden_Compra"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString)
                Cm.Parameters.AddWithValue("@Numero", Ds.Tables(0).Rows(Recorrido).Item("Requerimiento").ToString)
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString)
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString)
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString)
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString)
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString)
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString)
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Catalogo", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Grupo", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Clase", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Familia", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Item", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString)
                Cm.Parameters.AddWithValue("@Cantidad", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString))
                Cm.Parameters.AddWithValue("@Costo", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString))
                Cm.Parameters.AddWithValue("@Operacion", Operacion)
                Cm.ExecuteNonQuery()
            Next
        End If
    End Sub
    Public Sub LLenar_Detalle_Orden_Compra_Para_Edicion_2(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Centro_Costos Where Año_Ejecucion = '" & Año_Ejecucion & "' And  Numero = '" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nuevo_Detalle_Temporal_Detalle_Ejecucion_Orden_Compra_2"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString)
                Cm.Parameters.AddWithValue("@Numero", Ds.Tables(0).Rows(Recorrido).Item("Requerimiento").ToString)
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString)
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString)
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString)
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString)
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString)
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString)
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Catalogo", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Grupo", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Clase", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Familia", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Item", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString)
                Cm.Parameters.AddWithValue("@Cantidad", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString))
                Cm.Parameters.AddWithValue("@Costo", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString))
                Cm.Parameters.AddWithValue("@Operacion", Operacion)
                Cm.Parameters.AddWithValue("@IGV", Ds.Tables(0).Rows(Recorrido).Item("IGV"))
                Cm.ExecuteNonQuery()
            Next
        End If
    End Sub
    Public Sub LLenar_Detalle_Orden_Servicio_Distribucion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ordenes_Servicio_Distribucion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Mes").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Nombre_Mes").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
            Next
        End If
    End Sub
    Public Sub Orden_Servicio_Renta_IGV(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Sub_Total As System.Windows.Forms.TextBox, ByVal Caja_IGV As System.Windows.Forms.TextBox, ByVal Caja_Renta As System.Windows.Forms.TextBox, ByVal Radio_IGV As System.Windows.Forms.RadioButton, ByVal Radio_Renta As System.Windows.Forms.RadioButton)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim IGV As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("IGV").ToString)
            Dim Renta As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Renta").ToString)
            Dim Total As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString)
            Dim Sub_Total As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Sub_Total").ToString)
            If IGV > 0 Then Radio_IGV.Checked = True Else Radio_IGV.Checked = False
            If Renta > 0 Then Radio_Renta.Checked = True Else Radio_Renta.Checked = False
            Caja_IGV.Text = Format(IGV, "###,###,###,#.00")
            Caja_Renta.Text = Format(Renta, "###,###,###,#.00")
            Caja_Sub_Total.Text = Format(Sub_Total, "###,###,###,#.00")
            Caja_Total.Text = Format(Total, "###,###,###,#.00")
            Radio_IGV.Checked = Ds.Tables(0).Rows(0).Item("Check_IGV")
            Radio_Renta.Checked = Ds.Tables(0).Rows(0).Item("Check_Renta")
        End If
    End Sub
    Public Sub Orden_Compra_IGV(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Sub_Total As System.Windows.Forms.TextBox, ByVal Caja_IGV As System.Windows.Forms.TextBox, ByVal Check_IGV As System.Windows.Forms.CheckBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim IGV As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("IGV").ToString)
            Dim Total As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString)
            Dim Sub_Total As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Sub_Total").ToString)
            If IGV > 0 Then Check_IGV.Checked = True Else Check_IGV.Checked = False
            Caja_IGV.Text = Format(IGV, "###,###,###,#.00")
            Caja_Sub_Total.Text = Format(Sub_Total, "###,###,###,#.00")
            Caja_Total.Text = Format(Total, "###,###,###,#.00")
            Check_IGV.Checked = Ds.Tables(0).Rows(0).Item("Check_IGV")
        End If
    End Sub
    Public Sub LLenar_Detalle_Orden_Servicio_Para_Edicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Servicio_Centro_Costos Where Año_Ejecucion = '" & Año_Ejecucion & "' And  Numero = '" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nuevo_Detalle_Temporal_Detalle_Ejecucion_Orden_Servicio"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString)
                Cm.Parameters.AddWithValue("@Numero", Ds.Tables(0).Rows(Recorrido).Item("Requerimiento").ToString)
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString)
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString)
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString)
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString)
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString)
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString)
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Catalogo", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Grupo", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Clase", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Familia", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString)
                Cm.Parameters.AddWithValue("@Codigo_Item", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString)
                Cm.Parameters.AddWithValue("@Cantidad", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString))
                Cm.Parameters.AddWithValue("@Costo", Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString))
                Cm.Parameters.AddWithValue("@Operacion", Operacion)
                Cm.ExecuteNonQuery()
            Next
        End If
    End Sub
    Public Sub Llenar_Notas_Detalle_Orden_Compra_Edicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then

            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ordenes_Compra_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo='" & DataGridView.Rows(Recorrido).Cells(4).Value & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    DataGridView.Rows(Recorrido).Cells(10).Value = Ds.Tables(0).Rows(0).Item("Notas").ToString
                End If
            Next
        End If
    End Sub
    Public Sub Llenar_Notas_Detalle_Orden_Servicio_Edicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then

            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ordenes_Servicio_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo='" & DataGridView.Rows(Recorrido).Cells(4).Value & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    DataGridView.Rows(Recorrido).Cells(10).Value = Ds.Tables(0).Rows(0).Item("Notas").ToString
                End If
            Next
        End If
    End Sub
    Public Function Evaluar_Existencia_Item_Detalle_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Grupo As String, ByVal Clase As String, ByVal Familia As String, ByVal Item As String, ByVal Requerimiento As String, ByVal Operacion As String) As Boolean
        Evaluar_Existencia_Item_Detalle_Orden_Compra = True
        If Evaluar_Existencia_Item_Detalle_Orden_Compra = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Compra Where Codigo_Grupo='" & Grupo & "' And Codigo_Clase='" & Clase & "' And Codigo_Familia='" & Familia & "' And Codigo_Item='" & Item & "' And Numero='" & Requerimiento & "' And Operacion='" & Operacion & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Evaluar_Existencia_Item_Detalle_Orden_Compra = True
            Else
                Evaluar_Existencia_Item_Detalle_Orden_Compra = False
            End If
        End If
        Return Evaluar_Existencia_Item_Detalle_Orden_Compra
    End Function
    Public Function Evaluar_Existencia_Item_Detalle_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Grupo As String, ByVal Clase As String, ByVal Familia As String, ByVal Item As String, ByVal Requerimiento As String, ByVal Operacion As String) As Boolean
        Evaluar_Existencia_Item_Detalle_Orden_Servicio = True
        If Evaluar_Existencia_Item_Detalle_Orden_Servicio = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Servicio Where Codigo_Grupo='" & Grupo & "' And Codigo_Clase='" & Clase & "' And Codigo_Familia='" & Familia & "' And Codigo_Item='" & Item & "' And Numero='" & Requerimiento & "' And Operacion='" & Operacion & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Evaluar_Existencia_Item_Detalle_Orden_Servicio = True
            Else
                Evaluar_Existencia_Item_Detalle_Orden_Servicio = False
            End If
        End If
        Return Evaluar_Existencia_Item_Detalle_Orden_Servicio
    End Function
    Public Sub Cargar_Items_Detalle_Orden_Compra(ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Operacion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select  Año_Ejecucion,Codigo_Grupo, Codigo_Clase, Codigo_Familia, Codigo_Item,  Codigo_Grupo+'.'+ Codigo_Clase +'.'+ Codigo_Familia+'.'+ Codigo_Item As Codigo,Abreviatura_Unidad_Medida,Descripcion_Item,Sum(Cantidad) As Cantidad,Costo From Vista_Temporal_Detalle_Ejecucion_Orden_Compra Where Operacion='" & Operacion & "' Group By Año_Ejecucion,Codigo_Grupo, Codigo_Clase, Codigo_Familia, Codigo_Item, Abreviatura_Unidad_Medida,Descripcion_Item,Costo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura_Unidad_Medida").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), "###,###,###,#.00000")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "###,###,###,#.00000")
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString) * Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "###,###,#.00000")
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = ""
            Next
        End If
    End Sub
    Public Sub Cargar_Items_Detalle_Orden_Compra_2(ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Operacion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select  Año_Ejecucion,Codigo_Grupo, Codigo_Clase, Codigo_Familia, Codigo_Item,  Codigo_Grupo+'.'+ Codigo_Clase +'.'+ Codigo_Familia+'.'+ Codigo_Item As Codigo,Abreviatura_Unidad_Medida,Descripcion_Item,Sum(Cantidad) As Cantidad,Costo,IGV From Vista_Temporal_Detalle_Ejecucion_Orden_Compra Where Operacion='" & Operacion & "' Group By Año_Ejecucion,Codigo_Grupo, Codigo_Clase, Codigo_Familia, Codigo_Item, Abreviatura_Unidad_Medida,Descripcion_Item,Costo,IGV", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura_Unidad_Medida").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), "###,###,###,#.00000")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "###,###,###,#.00000")
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString) * Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "###,###,#.00000")
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = ""
                If Ds.Tables(0).Rows(Recorrido).Item("IGV") Is DBNull.Value Then
                    DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = True
                Else
                    If Ds.Tables(0).Rows(Recorrido).Item("IGV") = 1 Then
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = True
                    Else
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = False
                    End If
                End If
                'DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("IGV")
            Next
        End If
    End Sub
    Public Sub Cargar_Items_Detalle_Orden_Compra_Afectacion_IGV(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Bienes Where Codigo='" & DataGridView.Rows(Recorrido).Cells(4).Value & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    DataGridView.Rows(Recorrido).Cells(11).Value = Ds.Tables(0).Rows(0).Item("IGV")
                End If
            Next
        End If
    End Sub
    Public Sub Cargar_Items_Detalle_Orden_Servicio_Afectacion_IGV(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Servicios Where Codigo='" & DataGridView.Rows(Recorrido).Cells(4).Value & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    DataGridView.Rows(Recorrido).Cells(11).Value = Ds.Tables(0).Rows(0).Item("IGV")
                End If
            Next
        End If
    End Sub
    Public Sub Cargar_Items_Detalle_Orden_Compra_Servicio_Afectacion_IGV_Global_Devengado(ByVal Operacion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Select Case Operacion
            Case 1
                If DataGridView.Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                        Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Bienes Where Codigo='" & DataGridView.Rows(Recorrido).Cells(22).Value & "'", Cn)
                        Dim Ds As New Data.DataSet
                        Da.Fill(Ds)
                        If Ds.Tables(0).Rows.Count > 0 Then
                            DataGridView.Rows(Recorrido).Cells(29).Value = Ds.Tables(0).Rows(0).Item("IGV")
                        End If
                    Next
                End If
            Case 2
                If DataGridView.Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                        Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Servicios Where Codigo='" & DataGridView.Rows(Recorrido).Cells(22).Value & "'", Cn)
                        Dim Ds As New Data.DataSet
                        Da.Fill(Ds)
                        If Ds.Tables(0).Rows.Count > 0 Then
                            DataGridView.Rows(Recorrido).Cells(29).Value = Ds.Tables(0).Rows(0).Item("IGV")
                        End If
                    Next
                End If
        End Select
    End Sub
    Public Sub Cargar_Items_Detalle_Orden_Compra_Servicio_Afectacion_IGV_Global_Devengado_2(ByVal Año_Ejecucion As String, ByVal Orden_Compra As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Left(Orden_Compra, 4).ToString & "' And Codigo_Catalogo='01' And Codigo_Grupo='" & DataGridView.Rows(Recorrido).Cells(17).Value & "' And Codigo_Clase='" & DataGridView.Rows(Recorrido).Cells(18).Value & "' And Codigo_Familia='" & DataGridView.Rows(Recorrido).Cells(19).Value & "' And Codigo_Item='" & DataGridView.Rows(Recorrido).Cells(20).Value & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    DataGridView.Rows(Recorrido).Cells(29).Value = Ds.Tables(0).Rows(0).Item("IGV")
                End If
            Next
        End If
    End Sub
    Public Sub Cargar_Items_Detalle_Orden_Servicio(ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Operacion As String, Optional ByVal CheckTercero As System.Windows.Forms.CheckBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select  Año_Ejecucion,Codigo_Grupo, Codigo_Clase, Codigo_Familia, Codigo_Item,  Codigo_Grupo+'.'+ Codigo_Clase +'.'+ Codigo_Familia+'.'+ Codigo_Item As Codigo,Abreviatura_Unidad_Medida,Descripcion_Item,Sum(Cantidad) As Cantidad,Costo From Vista_Temporal_Detalle_Ejecucion_Orden_Servicio Where Operacion='" & Operacion & "' Group By Año_Ejecucion,Codigo_Grupo, Codigo_Clase, Codigo_Familia, Codigo_Item, Abreviatura_Unidad_Medida,Descripcion_Item,Costo", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura_Unidad_Medida").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), "###,###,###,#.00")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "###,###,###,#.00")
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString) * Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "###,###,#.00")
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = ""
                If Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString = "07.11.0043.0001" Then
                    If TypeOf CheckTercero Is System.Windows.Forms.CheckBox Then CheckTercero.Checked = True
                End If
            Next
        End If
    End Sub
    Public Function Numero2Letra(ByVal StrNumero As String) As String
        Dim Centena() As String = {"", "ciento", "doscientos", "trescientos", "cuatrocientos", "quinientos", "seiscientos", "setecientos", "ochocientos", "novecientos", "cien"}
        Dim Decena_1() As String = {"", "diez", "veinte", "treinta", "cuarenta", "cincuenta", "sesenta", "setenta", "ochenta", "noventa"}
        Dim Decena_2() As String = {"", "dieci", "veinti", "treinta y ", "cuarenta y ", "cincuenta y ", "sesenta y ", "setenta y ", "ochenta y ", "noventa y "}
        Dim Unidad() As String = {"", "uno", "dos", "tres", "cuatro", "cinco", "seis", "siete", "ocho", "nueve"}
        Dim Otros() As String = {"", "once", "doce", "trece", "catorce", "quince"}
        Dim Miles() = {" millones ", " mil ", " "}
        Dim Numero As Double = Math.Round(CDbl(StrNumero), 2)
        Dim Decimales As Double = Math.Round(Math.Round((Numero - Math.Truncate(Numero)), 2) * 100, 0)

        Dim C As Integer = 0, D As Integer = 0, U As Integer = 0, I As Integer
        Dim Letras As String = "", L_1 As String = ""
        For I = 0 To 2
            Unidad(1) = IIf(I = 2, "uno", "un")
            L_1 = ""
            C = Math.Truncate(Numero / (10 ^ (8 - 3 * I)))
            D = Math.Truncate((Numero - C * (10 ^ (8 - 3 * I))) / (10 ^ (7 - 3 * I)))
            U = Math.Truncate((Numero - C * (10 ^ (8 - 3 * I)) - D * (10 ^ (7 - 3 * I))) / (10 ^ (6 - 3 * I)))
            If C = 1 And D = 0 And U = 0 Then
                L_1 = Centena(C + 9)
            Else
                L_1 = Centena(C)
            End If
            If U = 0 Then
                L_1 = L_1 & " " & Decena_1(D)
            Else
                If D = 1 And U <= 5 Then
                    L_1 = L_1 & " " & Otros(U)
                Else
                    L_1 = L_1 & " " & Decena_2(D)
                    L_1 = L_1 & Unidad(U)
                End If
            End If
            Miles(0) = IIf(I = 0 And L_1.Trim = "un", " millon ", " millones ")
            If L_1.Trim.Length > 0 Then Letras = Letras & L_1.Trim & Miles(I)
            Numero = Numero - (C * (10 ^ (8 - 3 * I)) + D * (10 ^ (7 - 3 * I)) + U * (10 ^ (6 - 3 * I)))
        Next
        If Letras.Trim.Length = 0 Then Letras = "Cero "
        Letras = Letras & "con " & IIf(Decimales = 0, "00", Format(Decimales, "00")) & "/100"
        Return Letras
    End Function
    Public Function Numero1Letra(ByVal StrNumero As String) As String
        Dim Centena() As String = {"", "Ciento", "Doscientos", "Trescientos", "Cuatrocientos", "Quinientos", "Seiscientos", "Setecientos", "Ochocientos", "Novecientos", "Cien"}
        Dim Decena_1() As String = {"", "Diez", "Veinte", "Treinta", "Cuarenta", "Cincuenta", "Sesenta", "Setenta", "Ochenta", "Noventa"}
        Dim Decena_2() As String = {"", "Dieci", "Veinti", "Treinta y ", "Cuarenta y ", "Cincuenta y ", "Sesenta y ", "Setenta y ", "Ochenta y ", "noventa y "}
        Dim Unidad() As String = {"", "uno", "dos", "tres", "cuatro", "cinco", "seis", "siete", "ocho", "nueve"}
        Dim Otros() As String = {"", "Once", "Doce", "Trece", "Catorce", "Quince"}
        Dim Miles() = {" Millones ", " Mil ", " "}
        Dim Numero As Double = Math.Round(CDbl(StrNumero), 2)
        Dim Decimales As Double = Math.Round(Math.Round((Numero - Math.Truncate(Numero)), 2) * 100, 0)

        Dim C As Integer = 0, D As Integer = 0, U As Integer = 0, I As Integer
        Dim Letras As String = "", L_1 As String = ""
        For I = 0 To 2
            Unidad(1) = IIf(I = 2, "un", "un")
            L_1 = ""
            C = Math.Truncate(Numero / (10 ^ (8 - 3 * I)))
            D = Math.Truncate((Numero - C * (10 ^ (8 - 3 * I))) / (10 ^ (7 - 3 * I)))
            U = Math.Truncate((Numero - C * (10 ^ (8 - 3 * I)) - D * (10 ^ (7 - 3 * I))) / (10 ^ (6 - 3 * I)))
            If C = 1 And D = 0 And U = 0 Then
                L_1 = Centena(C + 9)
            Else
                L_1 = Centena(C)
            End If
            If U = 0 Then
                L_1 = L_1 & " " & Decena_1(D)
            Else
                If D = 1 And U <= 5 Then
                    L_1 = L_1 & " " & Otros(U)
                Else
                    L_1 = L_1 & " " & Decena_2(D)
                    L_1 = L_1 & Unidad(U)
                End If
            End If
            Miles(0) = IIf(I = 0 And L_1.Trim = "un", " millon ", " millones ")
            If L_1.Trim.Length > 0 Then Letras = Letras & L_1.Trim & Miles(I)
            Numero = Numero - (C * (10 ^ (8 - 3 * I)) + D * (10 ^ (7 - 3 * I)) + U * (10 ^ (6 - 3 * I)))
        Next
        If Letras.Trim.Length = 0 Then Letras = "Cero "
        Letras = Letras
        Return Letras
    End Function
    Public Sub Crear_Procedimiento_Rapido(ByVal Codigo_Tipo_Proceso As String, ByVal Año_Ejecucion As String, Optional ByVal Combo As System.Windows.Forms.ComboBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Procesos Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Proceso='" & Codigo_Tipo_Proceso & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Numero As String = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Insert Into Procesos (Año_Ejecucion, Codigo_Tipo_Proceso, Numero, Nombre, Siglas, Monto, Contrato, Observaciones)Values ('" & Año_Ejecucion & "','" & Codigo_Tipo_Proceso & "','" & Right("0000" & Numero.ToString, 4) & "','[N/A]','SBLM','0.00','[N/A]','[N/A]')"
            Cm.ExecuteNonQuery()
            Variable_Numero_Proceso = Right("0000" & Numero.ToString, 4)
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Insert Into Procesos_Contratos (Año_Ejecucion, Codigo_Tipo_Proceso, Numero,Numero_Contrato, Año_Contrato, Siglas, Monto)Values ('" & Año_Ejecucion & "','" & Codigo_Tipo_Proceso & "','" & Right("0000" & Numero.ToString, 4) & "','0000','" & Año_Ejecucion & "','SBLM','0.00')"
            Cm.ExecuteNonQuery()
        End If
    End Sub
    Public Function Generar_Numero_Orden_Compra(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Orden_Compra = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Orden_Compra
    End Function
    Public Function Generar_Numero_Orden_Servicio(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Orden_Servicio = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Orden_Servicio
    End Function
    Public Function Generar_Numero_Devengado(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Devengado = Right("00000" & Numero.ToString, 5)
        Return Generar_Numero_Devengado
    End Function
    Public Sub Nueva_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Orden As String, ByVal Sub_Total As Double, ByVal Monto_Total As Double, ByVal IGV As Double, ByVal Porcentaje As Double, ByVal Letras As String, ByVal Codigo_Proveedor As String, ByVal Año_Ejecucion_Proceso As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero_Proceso As String, ByVal Certificado As String, ByVal Codigo_Almacen As String, ByVal Codigo_Moneda As String, ByVal Tipo_Cambio As Double, ByVal Requerimiento As String, ByVal Check_IGV As Boolean, ByVal Check_Renta As Boolean, ByVal Numero_Contrato As String, ByVal Justificacion2 As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Orden_Compra"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Orden", Codigo_Estado_Orden)
        Cm.Parameters.AddWithValue("@Sub_Total", Sub_Total)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Porcentaje", Porcentaje)
        Cm.Parameters.AddWithValue("@Letras", Letras)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Año_Ejecucion_Proceso", Año_Ejecucion_Proceso)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Proceso", Codigo_Tipo_Proceso)
        Cm.Parameters.AddWithValue("@Numero_Proceso", Numero_Proceso)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Almacen", Codigo_Almacen)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@Check_Renta", Check_Renta)
        Cm.Parameters.AddWithValue("@Numero_Contrato", Numero_Contrato)
        Cm.Parameters.AddWithValue("@Justificacion2", Justificacion2)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nueva_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Orden As String, ByVal Sub_Total As Double, ByVal Monto_Total As Double, ByVal IGV As Double, ByVal Porcentaje As Double, ByVal Letras As String, ByVal Codigo_Proveedor As String, ByVal Año_Ejecucion_Proceso As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero_Proceso As String, ByVal Certificado As String, ByVal Codigo_Moneda As String, ByVal Tipo_Cambio As Double, ByVal Requerimiento As String, ByVal Porcentaje_Renta As Double, ByVal Renta As Double, ByVal Tercero As Boolean, ByVal Otros As Double, ByVal Check_IGV As Boolean, ByVal Check_Renta As Boolean, ByVal Numero_Contrato As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Orden_Servicio"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Orden", Codigo_Estado_Orden)
        Cm.Parameters.AddWithValue("@Sub_Total", Sub_Total)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Porcentaje", Porcentaje)
        Cm.Parameters.AddWithValue("@Letras", Letras)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Año_Ejecucion_Proceso", Año_Ejecucion_Proceso)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Proceso", Codigo_Tipo_Proceso)
        Cm.Parameters.AddWithValue("@Numero_Proceso", Numero_Proceso)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Porcentaje_Renta", Porcentaje_Renta)
        Cm.Parameters.AddWithValue("@Renta", Renta)
        Cm.Parameters.AddWithValue("@Tercero", Tercero)
        Cm.Parameters.AddWithValue("@Otros", Otros)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@Check_Renta", Check_Renta)
        Cm.Parameters.AddWithValue("@Numero_Contrato", Numero_Contrato)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Orden As String, ByVal Sub_Total As Double, ByVal Monto_Total As Double, ByVal IGV As Double, ByVal Porcentaje As Double, ByVal Letras As String, ByVal Codigo_Proveedor As String, ByVal Año_Ejecucion_Proceso As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero_Proceso As String, ByVal Certificado As String, ByVal Codigo_Almacen As String, ByVal Codigo_Moneda As String, ByVal Tipo_Cambio As Double, ByVal Requerimiento As String, ByVal Check_IGV As Boolean, ByVal Check_Renta As Boolean, ByVal Numero_Contrato As String, ByVal Justificacion2 As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Orden_Compra"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Orden", Codigo_Estado_Orden)
        Cm.Parameters.AddWithValue("@Sub_Total", Sub_Total)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Porcentaje", Porcentaje)
        Cm.Parameters.AddWithValue("@Letras", Letras)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Año_Ejecucion_Proceso", Año_Ejecucion_Proceso)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Proceso", Codigo_Tipo_Proceso)
        Cm.Parameters.AddWithValue("@Numero_Proceso", Numero_Proceso)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Almacen", Codigo_Almacen)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@Check_Renta", Check_Renta)
        Cm.Parameters.AddWithValue("@Numero_Contrato", Numero_Contrato)
        Cm.Parameters.AddWithValue("@Justificacion2", Justificacion2)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Orden As String, ByVal Sub_Total As Double, ByVal Monto_Total As Double, ByVal IGV As Double, ByVal Porcentaje As Double, ByVal Letras As String, ByVal Codigo_Proveedor As String, ByVal Año_Ejecucion_Proceso As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero_Proceso As String, ByVal Certificado As String, ByVal Codigo_Moneda As String, ByVal Tipo_Cambio As Double, ByVal Requerimiento As String, ByVal Porcentaje_Renta As Double, ByVal Renta As Double, ByVal Tercero As Boolean, ByVal Otros As Double, ByVal Check_IGV As Boolean, ByVal Check_Renta As Boolean, ByVal Numero_Contrato As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Orden_Servicio"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Orden", Codigo_Estado_Orden)
        Cm.Parameters.AddWithValue("@Sub_Total", Sub_Total)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Porcentaje", Porcentaje)
        Cm.Parameters.AddWithValue("@Letras", Letras)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Año_Ejecucion_Proceso", Año_Ejecucion_Proceso)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Proceso", Codigo_Tipo_Proceso)
        Cm.Parameters.AddWithValue("@Numero_Proceso", Numero_Proceso)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Porcentaje_Renta", Porcentaje_Renta)
        Cm.Parameters.AddWithValue("@Renta", Renta)
        Cm.Parameters.AddWithValue("@Tercero", Tercero)
        Cm.Parameters.AddWithValue("@Otros", Otros)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@Check_Renta", Check_Renta)
        Cm.Parameters.AddWithValue("@Numero_Contrato", Numero_Contrato)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Numero_Procedimiento(ByVal Operacion As Integer, ByVal Codigo_Tipo_Proceso As String, ByVal Año_Ejecucion As String, ByVal Numero As String) As String
        Numero_Procedimiento = ""
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("select * from [dbo].[Vista_Procesos_Bienes] Where Codigo_Tipo_Proceso='" & Codigo_Tipo_Proceso & "' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Numero_Procedimiento = Ds.Tables(0).Rows(0).Item("Proceso").ToString
                Else
                    Numero_Procedimiento = ""
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("select * from [dbo].[Vista_Procesos_Servicios] Where Codigo_Tipo_Proceso='" & Codigo_Tipo_Proceso & "' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Numero_Procedimiento = Ds.Tables(0).Rows(0).Item("Proceso").ToString
                Else
                    Numero_Procedimiento = ""
                End If
        End Select
        Return Numero_Procedimiento
    End Function
    Public Sub Nuevo_Detalle_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Notas As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Compra"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Orden_Compra_2(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Notas As String, ByVal IGV As Boolean)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Compra_2"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Notas As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Servicio"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Orden_Servicio_Distribucion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Mes As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Servicio_Distribucion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Mes", Codigo_Mes)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Requerimiento_Bienes_Movimientos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Orden As String, ByVal Codigo_FF As Double, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Codigo_Estado_Orden As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Requerimiento_Bienes_Movimientos"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Orden", Orden)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Orden", Codigo_Estado_Orden)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Requerimiento_Servicios_Movimientos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Orden As String, ByVal Codigo_FF As Double, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Codigo_Estado_Orden As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Requerimiento_Servicios_Movimientos"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Orden", Orden)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Orden", Codigo_Estado_Orden)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Ejecutar_Detalle_Requerimiento_Bienes_Movimientos(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Requerimiento_Bienes_Movimientos(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "01")
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Detalle_Requerimiento_Servicios_Movimientos(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Requerimiento_Servicios_Movimientos(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "01")
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Nuevo_Detalle_Orden_Compra_Centro_Costos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Requerimiento As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Compra_Centro_Costos"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Orden_Compra_Centro_Costos_2(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Requerimiento As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal IGV As Boolean)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Compra_Centro_Costos_2"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Orden_Servicio_Centro_Costos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Requerimiento As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Servicio_Centro_Costos"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Requerimiento", Requerimiento)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Ejecutar_Detalle_Orden_Compra_Centro_Costos(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio)
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Detalle_Orden_Compra_Centro_Costos_2(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_2(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, Ds.Tables(0).Rows(Recorrido).Item("IGV"))
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Detalle_Orden_Servicio_Centro_Costos(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Servicio_Centro_Costos(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio)
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Function Generar_Numero_Requerimientos_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String)
        Generar_Numero_Requerimientos_Orden_Compra = ""
        Dim Da As New OleDb.OleDbDataAdapter("select Distinct Numero from Temporal_Detalle_Ejecucion_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Generar_Numero_Requerimientos_Orden_Compra = Generar_Numero_Requerimientos_Orden_Compra & Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString & "-"
            Next
        End If
        Return Microsoft.VisualBasic.Left(Generar_Numero_Requerimientos_Orden_Compra, Generar_Numero_Requerimientos_Orden_Compra.ToString.Trim.Length - 1)
    End Function
    Public Function Generar_Numero_Requerimientos_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String)
        Generar_Numero_Requerimientos_Orden_Servicio = ""
        Dim Da As New OleDb.OleDbDataAdapter("select Distinct Numero from Temporal_Detalle_Ejecucion_Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Generar_Numero_Requerimientos_Orden_Servicio = Generar_Numero_Requerimientos_Orden_Servicio & Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString & "-"
            Next
        End If
        Return Microsoft.VisualBasic.Left(Generar_Numero_Requerimientos_Orden_Servicio, Generar_Numero_Requerimientos_Orden_Servicio.ToString.Trim.Length - 1)
    End Function
    Public Sub Ejecutar_Movimiento_Certificado_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad, Sum(Cantidad * Costo) As Monto From Temporal_Detalle_Ejecucion_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Correlativo As String = Me.Generar_Numero_Correlativo_Certificado(My.Settings.Año_Ejecucion, Certificado)
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Certificado_Movimiento(Correlativo, "05", Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Orden, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto") * -1) * Tipo_Cambio, "01", Me.Determinar_Tipo_Recurso_Generando_Orden_Compra(Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")))
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Movimiento_Certificado_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad, Sum(Cantidad * Costo) As Monto From Temporal_Detalle_Ejecucion_Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Correlativo As String = Me.Generar_Numero_Correlativo_Certificado(My.Settings.Año_Ejecucion, Certificado)
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Certificado_Movimiento(Correlativo, "06", Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Orden, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto") * -1) * Tipo_Cambio, "01", Me.Determinar_Tipo_Recurso_Generando_Orden_Servicio(Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")))
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Function Determinar_Tipo_Recurso_Generando_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String)
        Determinar_Tipo_Recurso_Generando_Orden_Compra = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_FF='" & Codigo_FF & "' And Codigo_Rubro='" & Codigo_Rubro & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Determinar_Tipo_Recurso_Generando_Orden_Compra = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Recurso").ToString
        Else
            Determinar_Tipo_Recurso_Generando_Orden_Compra = ""
        End If
        Return Determinar_Tipo_Recurso_Generando_Orden_Compra
    End Function
    Public Function Determinar_Tipo_Recurso_Generando_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String)
        Determinar_Tipo_Recurso_Generando_Orden_Servicio = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_FF='" & Codigo_FF & "' And Codigo_Rubro='" & Codigo_Rubro & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Determinar_Tipo_Recurso_Generando_Orden_Servicio = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Recurso").ToString
        Else
            Determinar_Tipo_Recurso_Generando_Orden_Servicio = ""
        End If
        Return Determinar_Tipo_Recurso_Generando_Orden_Servicio
    End Function
    Public Sub Eliminar_Detalle_Documentos_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Orden_Compra_Documentos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Generar_Requerimientos_Orden_Compra_Enlace(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Numero From Temporal_Detalle_Ejecucion_Orden_Compra Where Operacion ='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Documentos_Orden_Compra(Año_Ejecucion, Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString)
            Next
        End If
    End Sub
    Public Sub Generar_Requerimientos_Orden_Servicio_Enlace(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Numero From Temporal_Detalle_Ejecucion_Orden_Servicio Where Operacion ='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Documentos_Orden_Servicio(Año_Ejecucion, Numero, "02", Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString)
            Next
        End If
    End Sub
    Public Sub Nuevo_Detalle_Documentos_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Insert Into Detalle_Orden_Compra_Documentos(Año_Ejecucion, Numero, Codigo_Tipo_Documento, Numero_Documento) Values("
        Cm.CommandText = Cm.CommandText & "'" & Año_Ejecucion & "','" & Numero & "','" & Codigo_Tipo_Documento & "','" & Numero_Documento & "')"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Nuevo_Detalle_Documentos_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Insert Into Detalle_Orden_Servicio_Documentos(Año_Ejecucion, Numero, Codigo_Tipo_Documento, Numero_Documento) Values("
        Cm.CommandText = Cm.CommandText & "'" & Año_Ejecucion & "','" & Numero & "','" & Codigo_Tipo_Documento & "','" & Numero_Documento & "')"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Generar_Notas_MEF(ByVal Consulta As String)
        Dim Da As New OleDb.OleDbDataAdapter(Consulta, Cn)
        Dim Ds As New Data.DataSet
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Temporal_Notas_MEF"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Temporal_Notas_MEF(Descripcion_Actividad,	Tipo_Transaccion,	Generica,	Sub_Generica,	Sub_Generica_Detalle,	Especifica,	Especifica_Detalle,	Descripcion_Especifica_Detalle,Credito,Anulacion,Rubro)"
                Cm.CommandText = Cm.CommandText & " Values ('" & Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Actividad").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString & "','" & Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Credito").ToString) & "','" & Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Anulacion").ToString) & "','" & Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString & "')"
                Cm.ExecuteNonQuery()
            Next
        End If
    End Sub
    Public Sub Generar_Notas_SBLM(ByVal Consulta As String)
        Dim Da As New OleDb.OleDbDataAdapter(Consulta, Cn)
        Dim Ds As New Data.DataSet
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Temporal_Notas_SBLM"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Temporal_Notas_SBLM(Codigo_Programa,Codigo_Funcion,Codigo_Division_Funcional,Codigo_Grupo_Funcional,Codigo_Actividad_Obra,Codigo_Finalidad,Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Credito,Anulacion)"
                Cm.CommandText = Cm.CommandText & " Values ('" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Programa").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Funcion").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Division_Funcional").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo_Funcional").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad_Obra").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Finalidad_2").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString & "','" & Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString & "','" & Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Credito").ToString) & "','" & Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Anulacion").ToString) & "')"
                Cm.ExecuteNonQuery()
            Next
        End If
    End Sub
    Public Function Mensaje_Evaluacion_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double) As String
        Mensaje_Evaluacion_Orden_Compra = ""
        Dim DaTemporal As New OleDb.OleDbDataAdapter("Select Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,  Sum(Costo*Cantidad) As Monto from Temporal_Detalle_Ejecucion_Orden_Compra Where Operacion ='" & Operacion & "' Group By Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad", Cn)
        Dim DsTemporal As New Data.DataSet
        DaTemporal.Fill(DsTemporal)
        If DsTemporal.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DsTemporal.Tables(0).Rows.Count - 1
                Dim DaCertificado As New OleDb.OleDbDataAdapter("Select Saldo from Lista_Detalle_Certificados_Basica_Reportar_Saldos_Validacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "' And Codigo_FF='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF") & "' And Codigo_Rubro='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") & "' And Tipo_Transaccion='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion") & "' And Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Generica") & "' And Sub_Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica") & "' And Sub_Generica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") & "' And Especifica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica") & "' And Especifica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") & "' And Codigo_Secuencia_Funcional='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional") & "' And Codigo_Unidad_Organica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") & "' And Codigo_Actividad='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad") & "'", Cn)
                Dim DsCertificado As New Data.DataSet
                DaCertificado.Fill(DsCertificado)
                If DsCertificado.Tables(0).Rows.Count > 0 Then
                    Dim Saldo As Double = Convert.ToDouble(DsCertificado.Tables(0).Rows(0).Item("Saldo").ToString)
                    Dim Monto As Double = Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Monto").ToString) * Tipo_Cambio
                    If Monto <= Saldo Then
                        Mensaje_Evaluacion_Orden_Compra = Mensaje_Evaluacion_Orden_Compra & ""
                    Else
                        Mensaje_Evaluacion_Orden_Compra = Mensaje_Evaluacion_Orden_Compra & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Compra(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                    End If
                Else
                    Mensaje_Evaluacion_Orden_Compra = Mensaje_Evaluacion_Orden_Compra & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Compra(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                End If
            Next
        End If
        Return Mensaje_Evaluacion_Orden_Compra
    End Function
    Public Function Mensaje_Evaluacion_Orden_Compra_2(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double) As String
        Mensaje_Evaluacion_Orden_Compra_2 = ""
        Dim DaTemporal As New OleDb.OleDbDataAdapter("Select Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,  Sum(Costo*Cantidad) As Monto from Temporal_Detalle_Ejecucion_Orden_Compra Where Operacion ='" & Operacion & "' Group By Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad", Cn)
        Dim DsTemporal As New Data.DataSet
        DaTemporal.Fill(DsTemporal)
        If DsTemporal.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DsTemporal.Tables(0).Rows.Count - 1
                Dim DaCertificado As New OleDb.OleDbDataAdapter("Select Saldo from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "' And Codigo_FF='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF") & "' And Codigo_Rubro='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") & "' And Tipo_Transaccion='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion") & "' And Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Generica") & "' And Sub_Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica") & "' And Sub_Generica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") & "' And Especifica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica") & "' And Especifica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") & "' And Codigo_Secuencia_Funcional='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional") & "' And Codigo_Unidad_Organica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") & "' And Codigo_Actividad='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad") & "'", Cn)
                Dim DsCertificado As New Data.DataSet
                DaCertificado.Fill(DsCertificado)
                If DsCertificado.Tables(0).Rows.Count > 0 Then
                    Dim Saldo As Double = Convert.ToDouble(DsCertificado.Tables(0).Rows(0).Item("Saldo").ToString)
                    Dim Monto As Double = Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Monto").ToString) * Tipo_Cambio
                    If Monto <= Saldo Then
                        Mensaje_Evaluacion_Orden_Compra_2 = Mensaje_Evaluacion_Orden_Compra_2 & ""
                    Else
                        Mensaje_Evaluacion_Orden_Compra_2 = Mensaje_Evaluacion_Orden_Compra_2 & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Compra(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                    End If
                Else
                    Mensaje_Evaluacion_Orden_Compra_2 = Mensaje_Evaluacion_Orden_Compra_2 & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Compra(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                End If
            Next
        End If
        Return Mensaje_Evaluacion_Orden_Compra_2
    End Function
    Public Function Mensaje_Evaluacion_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double) As String
        Mensaje_Evaluacion_Orden_Servicio = ""
        Dim DaTemporal As New OleDb.OleDbDataAdapter("Select Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,  Sum(Costo*Cantidad) As Monto from Temporal_Detalle_Ejecucion_Orden_Servicio Where Operacion ='" & Operacion & "' Group By Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad", Cn)
        Dim DsTemporal As New Data.DataSet
        DaTemporal.Fill(DsTemporal)
        If DsTemporal.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DsTemporal.Tables(0).Rows.Count - 1
                Dim DaCertificado As New OleDb.OleDbDataAdapter("Select Saldo from Lista_Detalle_Certificados_Basica_Reportar_Saldos_Validacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "' And Codigo_FF='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF") & "' And Codigo_Rubro='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") & "' And Tipo_Transaccion='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion") & "' And Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Generica") & "' And Sub_Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica") & "' And Sub_Generica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") & "' And Especifica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica") & "' And Especifica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") & "' And Codigo_Secuencia_Funcional='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional") & "' And Codigo_Unidad_Organica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") & "' And Codigo_Actividad='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad") & "'", Cn)
                Dim DsCertificado As New Data.DataSet
                DaCertificado.Fill(DsCertificado)
                If DsCertificado.Tables(0).Rows.Count > 0 Then
                    Dim Saldo As Double = Convert.ToDouble(DsCertificado.Tables(0).Rows(0).Item("Saldo").ToString)
                    Dim Monto As Double = Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Monto").ToString) * Tipo_Cambio
                    If Monto <= Saldo Then
                        Mensaje_Evaluacion_Orden_Servicio = Mensaje_Evaluacion_Orden_Servicio & ""
                    Else
                        Mensaje_Evaluacion_Orden_Servicio = Mensaje_Evaluacion_Orden_Servicio & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Servicio(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                    End If
                Else
                    Mensaje_Evaluacion_Orden_Servicio = Mensaje_Evaluacion_Orden_Servicio & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Servicio(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                End If
            Next
        End If
        Return Mensaje_Evaluacion_Orden_Servicio
    End Function
    Public Function Mensaje_Evaluacion_Orden_Servicio_2(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double) As String
        Mensaje_Evaluacion_Orden_Servicio_2 = ""
        Dim DaTemporal As New OleDb.OleDbDataAdapter("Select Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,  Sum(Costo*Cantidad) As Monto from Temporal_Detalle_Ejecucion_Orden_Servicio Where Operacion ='" & Operacion & "' Group By Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad", Cn)
        Dim DsTemporal As New Data.DataSet
        DaTemporal.Fill(DsTemporal)
        If DsTemporal.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DsTemporal.Tables(0).Rows.Count - 1
                Dim DaCertificado As New OleDb.OleDbDataAdapter("Select Saldo from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "' And Codigo_FF='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF") & "' And Codigo_Rubro='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") & "' And Tipo_Transaccion='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion") & "' And Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Generica") & "' And Sub_Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica") & "' And Sub_Generica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") & "' And Especifica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica") & "' And Especifica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") & "' And Codigo_Secuencia_Funcional='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional") & "' And Codigo_Unidad_Organica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") & "' And Codigo_Actividad='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad") & "'", Cn)
                Dim DsCertificado As New Data.DataSet
                DaCertificado.Fill(DsCertificado)
                If DsCertificado.Tables(0).Rows.Count > 0 Then
                    Dim Saldo As Double = Convert.ToDouble(DsCertificado.Tables(0).Rows(0).Item("Saldo").ToString)
                    Dim Monto As Double = Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Monto").ToString) * Tipo_Cambio
                    If Monto <= Saldo Then
                        Mensaje_Evaluacion_Orden_Servicio_2 = Mensaje_Evaluacion_Orden_Servicio_2 & ""
                    Else
                        Mensaje_Evaluacion_Orden_Servicio_2 = Mensaje_Evaluacion_Orden_Servicio_2 & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Servicio(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                    End If
                Else
                    Mensaje_Evaluacion_Orden_Servicio_2 = Mensaje_Evaluacion_Orden_Servicio_2 & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Servicio(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                End If
            Next
        End If
        Return Mensaje_Evaluacion_Orden_Servicio_2
    End Function
    Public Function Concatenar_Mensaje_Saldos_Detalle_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String) As String
        Concatenar_Mensaje_Saldos_Detalle_Orden_Compra = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select Rubro,Clasificador,Codigo_Secuencia_Funcional + ' - ' + Meta As Meta,Saldo from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_FF='" & Codigo_FF & "' And Codigo_Rubro='" & Codigo_Rubro & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Concatenar_Mensaje_Saldos_Detalle_Orden_Compra = "Saldo Insuficiente en el Rubro: " & Left(Ds.Tables(0).Rows(0).Item("Rubro").ToString, 3) & ", Clasificador: " & Ds.Tables(0).Rows(0).Item("Clasificador") & ", Meta: " & Ds.Tables(0).Rows(0).Item("Meta")
        Else
            Concatenar_Mensaje_Saldos_Detalle_Orden_Compra = "No se ha certificado Monto en el Rubro: " & Codigo_FF & "-" & Codigo_Rubro & ", Clasificador: " & Tipo_Transaccion & "." & Generica & "." & Sub_Generica & "." & Sub_Generica_Detalle & "." & Especifica & "." & Especifica_Detalle & ", Meta: " & Codigo_Secuencia_Funcional
        End If
        Return Concatenar_Mensaje_Saldos_Detalle_Orden_Compra
    End Function
    Public Function Concatenar_Mensaje_Saldos_Detalle_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String) As String
        Concatenar_Mensaje_Saldos_Detalle_Orden_Servicio = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select Rubro,Clasificador,Codigo_Secuencia_Funcional + ' - ' + Meta As Meta,Saldo from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_FF='" & Codigo_FF & "' And Codigo_Rubro='" & Codigo_Rubro & "' And Tipo_Transaccion='" & Tipo_Transaccion & "' And Generica='" & Generica & "' And Sub_Generica='" & Sub_Generica & "' And Sub_Generica_Detalle='" & Sub_Generica_Detalle & "' And Especifica='" & Especifica & "' And Especifica_Detalle='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Concatenar_Mensaje_Saldos_Detalle_Orden_Servicio = "Saldo Insuficiente en el Rubro: " & Left(Ds.Tables(0).Rows(0).Item("Rubro").ToString, 3) & ", Clasificador: " & Ds.Tables(0).Rows(0).Item("Clasificador") & ", Meta: " & Ds.Tables(0).Rows(0).Item("Meta")
        Else
            Concatenar_Mensaje_Saldos_Detalle_Orden_Servicio = "No se ha certificado Monto en el Rubro: " & Codigo_FF & "-" & Codigo_Rubro & ", Clasificador: " & Tipo_Transaccion & "." & Generica & "." & Sub_Generica & "." & Sub_Generica_Detalle & "." & Especifica & "." & Especifica_Detalle & ", Meta: " & Codigo_Secuencia_Funcional
        End If
        Return Concatenar_Mensaje_Saldos_Detalle_Orden_Servicio
    End Function
    Public Sub Generar_Numero_Operacion()
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Operacion)+1),1) As Numero From Operacion", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Dim Cadena_Interna As String = Right("00000000" & Numero.ToString, 8)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Insert Into Operacion(Operacion) Values ('" & Cadena_Interna & "')"
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Obtener_Numero_Operacion() As String
        Obtener_Numero_Operacion = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select Max(Abs(Operacion)) As Numero From Operacion", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Obtener_Numero_Operacion = Right("00000000" & Ds.Tables(0).Rows(0).Item("Numero").ToString, 8)
        Else
            Obtener_Numero_Operacion = "00000000"
        End If
        Return Obtener_Numero_Operacion
    End Function
    Public Sub Cargar_Proveedor(ByVal Codigo As String, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_RUC_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Razon_Social As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Domicilio As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Ubigeo As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Ubigeo As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Telefono As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Celular As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Fax As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Correo As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Observaciones As System.Windows.Forms.TextBox = Nothing, Optional ByVal Check_Activo As System.Windows.Forms.CheckBox = Nothing, Optional ByVal Caja_CCI As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Detracciones As System.Windows.Forms.TextBox = Nothing, Optional ByVal DataGridVIewBasico As System.Windows.Forms.DataGridView = Nothing, Optional ByVal Combo_Tipo_Documento As System.Windows.Forms.ComboBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Proveedores Where Codigo_Proveedor='" & Codigo & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
            If TypeOf Caja_RUC_Proveedor Is System.Windows.Forms.TextBox Then Caja_RUC_Proveedor.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
            If TypeOf Caja_Razon_Social Is System.Windows.Forms.TextBox Then Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
            If TypeOf Caja_Domicilio Is System.Windows.Forms.TextBox Then Caja_Domicilio.Text = Ds.Tables(0).Rows(0).Item("Domicilio").ToString
            If TypeOf Caja_Codigo_Ubigeo Is System.Windows.Forms.TextBox Then Caja_Codigo_Ubigeo.Text = Ds.Tables(0).Rows(0).Item("Codigo_Ubigeo").ToString
            If TypeOf Caja_Ubigeo Is System.Windows.Forms.TextBox Then Caja_Ubigeo.Text = Ds.Tables(0).Rows(0).Item("Ubigeo").ToString
            If TypeOf Caja_Telefono Is System.Windows.Forms.TextBox Then Caja_Telefono.Text = Ds.Tables(0).Rows(0).Item("Telefono").ToString
            If TypeOf Caja_Celular Is System.Windows.Forms.TextBox Then Caja_Celular.Text = Ds.Tables(0).Rows(0).Item("Celular").ToString
            If TypeOf Caja_Fax Is System.Windows.Forms.TextBox Then Caja_Fax.Text = Ds.Tables(0).Rows(0).Item("Fax").ToString
            If TypeOf Caja_Correo Is System.Windows.Forms.TextBox Then Caja_Correo.Text = Ds.Tables(0).Rows(0).Item("Correo").ToString
            If TypeOf Caja_Observaciones Is System.Windows.Forms.TextBox Then Caja_Observaciones.Text = Ds.Tables(0).Rows(0).Item("Observaciones").ToString
            If TypeOf Check_Activo Is System.Windows.Forms.CheckBox Then Check_Activo.Checked = Ds.Tables(0).Rows(0).Item("Activo")
            If TypeOf Caja_CCI Is System.Windows.Forms.TextBox Then Caja_CCI.Text = Ds.Tables(0).Rows(0).Item("CCI").ToString
            If TypeOf Caja_Detracciones Is System.Windows.Forms.TextBox Then Caja_Detracciones.Text = Ds.Tables(0).Rows(0).Item("Cuenta_Detracciones").ToString
            If TypeOf Combo_Tipo_Documento Is System.Windows.Forms.ComboBox Then Combo_Tipo_Documento.Text = Ds.Tables(0).Rows(0).Item("Tipo Documento").ToString
            If TypeOf DataGridVIewBasico Is System.Windows.Forms.DataGridView Then
                DataGridVIewBasico.Rows.Add()
                DataGridVIewBasico.Item(0, DataGridVIewBasico.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                DataGridVIewBasico.Item(1, DataGridVIewBasico.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                DataGridVIewBasico.Item(2, DataGridVIewBasico.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
            End If
        End If
    End Sub
    Public Sub Cargar_Ubigeo(ByVal Codigo As String, Optional ByVal Caja_Codigo_Ubigeo As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Ubigeo As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Ubigeo Where Ubigeo='" & Codigo & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Caja_Codigo_Ubigeo Is System.Windows.Forms.TextBox Then Caja_Codigo_Ubigeo.Text = Ds.Tables(0).Rows(0).Item("Ubigeo").ToString
            If TypeOf Caja_Ubigeo Is System.Windows.Forms.TextBox Then Caja_Ubigeo.Text = Ds.Tables(0).Rows(0).Item("Nombre").ToString
        End If
    End Sub
    Public Sub Cargar_Datos_Almacen(ByVal Codigo_Almacen As String, Optional ByVal Caja_Codigo_Almacen As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Nombre_Almacen As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Direccion_Almacen As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Ubigeo_Almacen As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Nombre_Contacto As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Telefono_Contacto As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Nombre_Ubigeo_Almacen As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Almacenes Where Codigo_Almacen='" & Codigo_Almacen & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Caja_Codigo_Almacen Is System.Windows.Forms.TextBox Then Caja_Codigo_Almacen.Text = Ds.Tables(0).Rows(0).Item("Codigo_Almacen").ToString
            If TypeOf Caja_Nombre_Almacen Is System.Windows.Forms.TextBox Then Caja_Nombre_Almacen.Text = Ds.Tables(0).Rows(0).Item("Nombre_Almacen").ToString
            If TypeOf Caja_Direccion_Almacen Is System.Windows.Forms.TextBox Then Caja_Direccion_Almacen.Text = Ds.Tables(0).Rows(0).Item("Direccion_Almacen").ToString
            If TypeOf Caja_Ubigeo_Almacen Is System.Windows.Forms.TextBox Then Caja_Ubigeo_Almacen.Text = Ds.Tables(0).Rows(0).Item("Ubigeo_Almacen").ToString
            If TypeOf Caja_Nombre_Ubigeo_Almacen Is System.Windows.Forms.TextBox Then Caja_Nombre_Ubigeo_Almacen.Text = Ds.Tables(0).Rows(0).Item("Nombre_Ubigeo").ToString
            If TypeOf Caja_Nombre_Contacto Is System.Windows.Forms.TextBox Then Caja_Nombre_Contacto.Text = Ds.Tables(0).Rows(0).Item("Nombre_Contacto").ToString
            If TypeOf Caja_Telefono_Contacto Is System.Windows.Forms.TextBox Then Caja_Telefono_Contacto.Text = Ds.Tables(0).Rows(0).Item("Telefono_Contacto").ToString
        End If
    End Sub
    Public Sub Editar_Orden_Compra_Cargar_Variables(ByVal Año_Ejecucion As String, ByVal Numero As String, Optional ByVal Combo_Almacen As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Check_IGV As System.Windows.Forms.CheckBox = Nothing, Optional ByVal Caja_Letras As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Proceso As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Año_Proceso As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Numero_Proceso As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Porcentaje As System.Windows.Forms.NumericUpDown = Nothing, Optional ByVal Combo_Tipo_Moneda As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Tipo_Cambio As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion2 As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Ordenes_Compra_Basica  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Numero_Certificacion = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Variable_Codigo_Proveedor = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
            If TypeOf Combo_Almacen Is System.Windows.Forms.ComboBox Then Combo_Almacen.SelectedItem = Ds.Tables(0).Rows(0).Item("Nombre_Almacen").ToString
            If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            If TypeOf Caja_Justificacion2 Is System.Windows.Forms.TextBox Then Caja_Justificacion2.Text = Ds.Tables(0).Rows(0).Item("Justificacion2").ToString
            If TypeOf Check_IGV Is System.Windows.Forms.CheckBox Then
                If Convert.ToDouble(Ds.Tables(0).Rows(0).Item("IGV").ToString) > 0 Then
                    Check_IGV.Checked = True
                Else
                    Check_IGV.Checked = False
                End If
            End If
            If TypeOf Caja_Letras Is System.Windows.Forms.TextBox Then Caja_Letras.Text = Ds.Tables(0).Rows(0).Item("Letras").ToString
            If TypeOf Combo_Proceso Is System.Windows.Forms.ComboBox Then Combo_Proceso.SelectedItem = Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Proceso").ToString
            If TypeOf Combo_Año_Proceso Is System.Windows.Forms.ComboBox Then Combo_Año_Proceso.SelectedItem = Ds.Tables(0).Rows(0).Item("Año_Ejecucion_Proceso").ToString
            If TypeOf Combo_Numero_Proceso Is System.Windows.Forms.ComboBox Then Combo_Numero_Proceso.SelectedItem = Ds.Tables(0).Rows(0).Item("Numero_Proceso").ToString
            If TypeOf Caja_Porcentaje Is System.Windows.Forms.NumericUpDown Then Caja_Porcentaje.Value = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Porcentaje").ToString)
            If TypeOf Combo_Tipo_Moneda Is System.Windows.Forms.ComboBox Then Combo_Tipo_Moneda.SelectedItem = Ds.Tables(0).Rows(0).Item("Moneda").ToString
            If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Ds.Tables(0).Rows(0).Item("Tipo_Cambio").ToString
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Editar_Orden_Servicio_Cargar_Variables(ByVal Año_Ejecucion As String, ByVal Numero As String, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Radio_IGV As System.Windows.Forms.RadioButton = Nothing, Optional ByVal Caja_Letras As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Proceso As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Año_Proceso As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Numero_Proceso As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Porcentaje As System.Windows.Forms.NumericUpDown = Nothing, Optional ByVal Combo_Tipo_Moneda As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Tipo_Cambio As System.Windows.Forms.TextBox = Nothing, Optional ByVal Radio_Renta As System.Windows.Forms.RadioButton = Nothing, Optional ByVal Check_Tercero As System.Windows.Forms.CheckBox = Nothing, Optional ByVal Caja_Otros As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Ordenes_Servicio_Basica  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Variable_Numero_Certificacion = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Variable_Codigo_Proveedor = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
            If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            If TypeOf Radio_IGV Is System.Windows.Forms.RadioButton Then
                If Convert.ToDouble(Ds.Tables(0).Rows(0).Item("IGV").ToString) > 0 Then
                    Radio_IGV.Checked = True
                Else
                    Radio_IGV.Checked = False
                End If
            End If
            If TypeOf Radio_Renta Is System.Windows.Forms.RadioButton Then
                If Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Renta").ToString) > 0 Then
                    Radio_Renta.Checked = True
                Else
                    Radio_Renta.Checked = False
                End If
            End If
            If TypeOf Check_Tercero Is System.Windows.Forms.CheckBox Then Check_Tercero.Checked = Ds.Tables(0).Rows(0).Item("Tercero")
            If TypeOf Caja_Letras Is System.Windows.Forms.TextBox Then Caja_Letras.Text = Ds.Tables(0).Rows(0).Item("Letras").ToString
            If TypeOf Combo_Proceso Is System.Windows.Forms.ComboBox Then Combo_Proceso.SelectedItem = Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Proceso").ToString
            If TypeOf Combo_Año_Proceso Is System.Windows.Forms.ComboBox Then Combo_Año_Proceso.SelectedItem = Ds.Tables(0).Rows(0).Item("Año_Ejecucion_Proceso").ToString
            If TypeOf Combo_Numero_Proceso Is System.Windows.Forms.ComboBox Then Combo_Numero_Proceso.SelectedItem = Ds.Tables(0).Rows(0).Item("Numero_Proceso").ToString
            If TypeOf Caja_Porcentaje Is System.Windows.Forms.NumericUpDown Then Caja_Porcentaje.Value = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Porcentaje").ToString)
            If TypeOf Combo_Tipo_Moneda Is System.Windows.Forms.ComboBox Then Combo_Tipo_Moneda.SelectedItem = Ds.Tables(0).Rows(0).Item("Moneda").ToString
            If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Ds.Tables(0).Rows(0).Item("Tipo_Cambio").ToString
            If TypeOf Caja_Otros Is System.Windows.Forms.TextBox Then Caja_Otros.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Otros").ToString), "#,###,##0.00")
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Rebajar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Cuenta As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Compra_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Orden").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Rebajar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Cuenta.Enabled = True
                    Reenumerar.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Rebajar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Cuenta.Enabled = True
                    Reenumerar.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Cuenta.Enabled = True
                    Reenumerar.Enabled = False
                    If Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Saldo").ToString) > 0 Then Rebajar.Enabled = True Else Rebajar.Enabled = False
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Rebajar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Cuenta.Enabled = True
                    Reenumerar.Enabled = False
                Case "05" 'DEVENGADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Cuenta.Enabled = True
                    Reenumerar.Enabled = False
                    If Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Saldo").ToString) > 0 Then Rebajar.Enabled = True Else Rebajar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Rebajar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Cuenta.Enabled = False
                    Reenumerar.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Orden_Servicio(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Rebajar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Servicio_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Orden").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Rebajar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Rebajar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                    If Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Saldo").ToString) > 0 Then Rebajar.Enabled = True Else Rebajar.Enabled = False
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Rebajar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "05" 'DEVENGADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                    If Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Saldo").ToString) > 0 Then Rebajar.Enabled = True Else Rebajar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Rebajar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
            End Select
        End If
    End Sub
    Public Function Generar_Codigo_Proveedor() As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Codigo_Proveedor)+1),1) As Numero From Proveedor", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Codigo_Proveedor = Right("00000" & Numero.ToString, 5)
        Return Generar_Codigo_Proveedor
    End Function
    Public Sub Nuevo_Proveedor(ByVal Codigo_Proveedor As String, ByVal RUC_Proveedor As String, ByVal Razon_Social As String, ByVal Domicilio As String, ByVal Ubigeo As String, ByVal Telefono As String, ByVal Celular As String, ByVal Fax As String, ByVal Correo As String, ByVal Observaciones As String, ByVal Activo As Boolean, ByVal CCI As String, ByVal Cuenta_Detracciones As String, ByVal Codigo_Tipo_Documento As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Proveedor"
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@RUC_Proveedor ", RUC_Proveedor)
        Cm.Parameters.AddWithValue("@Razon_Social ", Razon_Social)
        Cm.Parameters.AddWithValue("@Domicilio ", Domicilio)
        Cm.Parameters.AddWithValue("@Ubigeo", Ubigeo)
        Cm.Parameters.AddWithValue("@Telefono ", Telefono)
        Cm.Parameters.AddWithValue("@Celular ", Celular)
        Cm.Parameters.AddWithValue("@Fax", Fax)
        Cm.Parameters.AddWithValue("@Correo", Correo)
        Cm.Parameters.AddWithValue("@Observaciones", Observaciones)
        Cm.Parameters.AddWithValue("@Activo", Activo)
        Cm.Parameters.AddWithValue("@CCI", CCI)
        Cm.Parameters.AddWithValue("@Cuenta_Detracciones", Cuenta_Detracciones)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Proveedor(ByVal Codigo_Proveedor As String, ByVal RUC_Proveedor As String, ByVal Razon_Social As String, ByVal Domicilio As String, ByVal Ubigeo As String, ByVal Telefono As String, ByVal Celular As String, ByVal Fax As String, ByVal Correo As String, ByVal Observaciones As String, ByVal Activo As Boolean, ByVal CCI As String, ByVal Cuenta_Detracciones As String, ByVal Codigo_Tipo_Documento As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Proveedor"
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@RUC_Proveedor ", RUC_Proveedor)
        Cm.Parameters.AddWithValue("@Razon_Social ", Razon_Social)
        Cm.Parameters.AddWithValue("@Domicilio ", Domicilio)
        Cm.Parameters.AddWithValue("@Ubigeo", Ubigeo)
        Cm.Parameters.AddWithValue("@Telefono ", Telefono)
        Cm.Parameters.AddWithValue("@Celular ", Celular)
        Cm.Parameters.AddWithValue("@Fax", Fax)
        Cm.Parameters.AddWithValue("@Correo", Correo)
        Cm.Parameters.AddWithValue("@Observaciones", Observaciones)
        Cm.Parameters.AddWithValue("@Activo", Activo)
        Cm.Parameters.AddWithValue("@CCI", CCI)
        Cm.Parameters.AddWithValue("@Cuenta_Detracciones", Cuenta_Detracciones)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Actualizar_Estado_Requerimiento(ByVal Año_Ejecucion As String, ByVal Numero_Orden As String, ByVal Operacion As String, ByVal Codigo_Estado As String)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Orden From Detalle_Requerimiento_Bienes_Movimientos Where Codigo_Estado_Orden In('03','05','06') And Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero_Orden & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Recorrdido As Integer = 0
                    For Recorrdido = 0 To Ds.Tables(0).Rows.Count - 1
                        Dim Cm As New OleDb.OleDbCommand
                        Cm.CommandTimeout = 0
                        Cm.Connection = Cn
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Update Requerimiento_Bienes Set Codigo_Estado_Requerimiento='" & Codigo_Estado & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero ='" & Ds.Tables(0).Rows(Recorrdido).Item("Numero").ToString & "'"
                        Cm.ExecuteNonQuery()
                    Next
                Else
                    Exit Select
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Orden From Detalle_Requerimiento_Servicios_Movimientos Where Codigo_Estado_Orden In('03','05','06') And Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero_Orden & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Recorrdido As Integer = 0
                    For Recorrdido = 0 To Ds.Tables(0).Rows.Count - 1
                        Dim Cm As New OleDb.OleDbCommand
                        Cm.CommandTimeout = 0
                        Cm.Connection = Cn
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Update Requerimiento_Servicios Set Codigo_Estado_Requerimiento='" & Codigo_Estado & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero ='" & Ds.Tables(0).Rows(Recorrdido).Item("Numero").ToString & "'"
                        Cm.ExecuteNonQuery()
                    Next
                Else
                    Exit Select
                End If
            Case 3
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Orden From Detalle_Requerimiento_Bienes_Movimientos Where Codigo_Estado_Orden In('01') And Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero_Orden & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Recorrdido As Integer = 0
                    For Recorrdido = 0 To Ds.Tables(0).Rows.Count - 1
                        Dim Cm As New OleDb.OleDbCommand
                        Cm.CommandTimeout = 0
                        Cm.Connection = Cn
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Update Requerimiento_Bienes Set Codigo_Estado_Requerimiento='" & Codigo_Estado & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero ='" & Ds.Tables(0).Rows(Recorrdido).Item("Numero").ToString & "'"
                        Cm.ExecuteNonQuery()
                    Next
                Else
                    Exit Select
                End If
            Case 4
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Orden From Detalle_Requerimiento_Servicios_Movimientos Where Codigo_Estado_Orden In('01') And Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Numero_Orden & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Recorrdido As Integer = 0
                    For Recorrdido = 0 To Ds.Tables(0).Rows.Count - 1
                        Dim Cm As New OleDb.OleDbCommand
                        Cm.CommandTimeout = 0
                        Cm.Connection = Cn
                        Cm.CommandType = CommandType.Text
                        Cm.CommandText = "Update Requerimiento_Servicios Set Codigo_Estado_Requerimiento='" & Codigo_Estado & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero ='" & Ds.Tables(0).Rows(Recorrdido).Item("Numero").ToString & "'"
                        Cm.ExecuteNonQuery()
                    Next
                Else
                    Exit Select
                End If
        End Select
    End Sub
    Public Sub Cargar_Items_Catalogo_Bienes_Servicios_Obras_Grid_For_Report(ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Select Case Codigo_Catalogo
            Case "01"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Bienes Where Codigo_Grupo='" & Codigo_Grupo & "'  And Codigo_Clase='" & Codigo_Clase & "' And Codigo_Familia='" & Codigo_Familia & "' And Codigo_Item='" & Codigo_Item & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Unidad_Medida").ToString
                    Next
                End If
            Case "02"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Servicios Where Codigo_Grupo='" & Codigo_Grupo & "'  And Codigo_Clase='" & Codigo_Clase & "' And Codigo_Familia='" & Codigo_Familia & "' And Codigo_Item='" & Codigo_Item & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Item").ToString
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Unidad_Medida").ToString
                    Next
                End If
        End Select
    End Sub
    Public Sub Exportar_Data_Transparencia(ByVal Consulta As String, ByVal Tipo As Integer)
        Dim Da As New OleDb.OleDbDataAdapter(Consulta, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "MEF_GAS_ORDENES"
            Excel.Application.Cells(1, "A") = "FK_ID_ORDEN_TIPO"
            Excel.Application.Cells(1, "B") = "IN_ORDEN_ANNO"
            Excel.Application.Cells(1, "C") = "IN_ORDEN_MES"
            Excel.Application.Cells(1, "D") = "VC_ORDEN_RUC"
            Excel.Application.Cells(1, "E") = "VC_ORDEN_PERIODO"
            Excel.Application.Cells(1, "F") = "VC_ORDEN_NUMERO"
            Excel.Application.Cells(1, "G") = "VC_ORDEN_NUMERO_SIAF"
            Excel.Application.Cells(1, "H") = "DT_ORDEN_FECHA"
            Excel.Application.Cells(1, "I") = "DC_ORDEN_MONTO"
            Excel.Application.Cells(1, "J") = "VC_ORDEN_PROVEEDOR"
            Excel.Application.Cells(1, "K") = "VC_ORDEN_DESCRIPCION"
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Excel.Application.Cells(Recorrido + 2, "A") = Tipo
                Excel.Application.Cells(Recorrido + 2, "B") = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                Excel.Application.Cells(Recorrido + 2, "C") = Convert.ToDouble(Month(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision")))
                Excel.Application.Cells(Recorrido + 2, "D") = "'20135604551"
                Excel.Application.Cells(Recorrido + 2, "E") = "MES DE " & UCase(MonthName(Convert.ToDouble(Month(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision"))))) & " " & Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                Excel.Application.Cells(Recorrido + 2, "F") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                Excel.Application.Cells(Recorrido + 2, "G") = 0
                Excel.Application.Cells(Recorrido + 2, "H") = Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                Excel.Application.Cells(Recorrido + 2, "I") = Ds.Tables(0).Rows(Recorrido).Item("Monto_Total")
                Excel.Application.Cells(Recorrido + 2, "J") = Ds.Tables(0).Rows(Recorrido).Item("Razon_Social")
                Excel.Application.Cells(Recorrido + 2, "K") = Ds.Tables(0).Rows(Recorrido).Item("Justificacion")
                Excel.Application.Range("A" & Recorrido + 1, "K" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 7
            Hoja.Range("C1").ColumnWidth = 5
            Hoja.Range("D1").ColumnWidth = 12
            Hoja.Range("E1").ColumnWidth = 24
            Hoja.Range("F1").ColumnWidth = 10
            Hoja.Range("G1").ColumnWidth = 5
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("J1").ColumnWidth = 40
            Hoja.Range("K1").ColumnWidth = 40
            Hoja.Range("A1", "K1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("J2", "K" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "K" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "K" & Recorrido + 2).WrapText = True
            Hoja.Range("I2", "I" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE TRANSPARENCIA"
            Hoja.Range("A" & Recorrido + 2, "K" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "K" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Data_SEACE(ByVal Consulta As String, ByVal Tipo As Integer)
        Dim Da As New OleDb.OleDbDataAdapter(Consulta, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Formulario"
            Excel.Application.Cells(1, "A") = "O/C U O/S"
            Excel.Application.Cells(1, "B") = "N°"
            Excel.Application.Cells(1, "C") = "ESTADO DE O/C U O/S"
            Excel.Application.Cells(1, "D") = "RUC DE CONTRATISTA"
            Excel.Application.Cells(1, "E") = "FECHA DE EMISIÓN"
            Excel.Application.Cells(1, "F") = "FECHA DE NOTIFICACIÓN"
            Excel.Application.Cells(1, "G") = "FECHA DE COMPROMISO PRESUPUESTAL"
            Excel.Application.Cells(1, "H") = "Nº DE EXPEDIENTE SIAF"
            Excel.Application.Cells(1, "I") = "TIPO DE CONTRATACIÓN"
            Excel.Application.Cells(1, "J") = "INFORMACIÓN COMPLEMENTARÍA"
            Excel.Application.Cells(1, "K") = "OBJETO DE CONTRATACIÓN"
            Excel.Application.Cells(1, "L") = "DESCRIPCIÓN Y FINALIDAD DE LA CONTRATACIÓN"
            Excel.Application.Cells(1, "M") = "UNIDADES ORGANICAS QUE SOLICITA LA CONTRATACIÓN"
            Excel.Application.Cells(1, "N") = "UNIDAD INFORMANTE"
            Excel.Application.Cells(1, "O") = "MONTO TOTAL DE LA ORDEN"
            Excel.Application.Cells(1, "P") = "TIPO DE MONEDA"
            Excel.Application.Cells(1, "Q") = "TIPO DE CAMBIO"
            Excel.Application.Range("A1", "Q1").Columns.WrapText = True
            Hoja.Range("A1", "Q1").HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("A1", "Q1").VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Select Case Tipo
                Case 1
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Excel.Application.Cells(Recorrido + 2, "A") = "10 - O/C"
                        Excel.Application.Cells(Recorrido + 2, "B") = Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString))
                        Select Case Ds.Tables(0).Rows(Recorrido).Item("Codigo_Estado_Orden").ToString
                            Case "01", "02"
                                Dim Variable As String = "1 - Emitida"
                                Excel.Application.Cells(Recorrido + 2, "C") = Variable
                            Case "03"
                                Dim Variable As String = "3 - Comprometida"
                                Excel.Application.Cells(Recorrido + 2, "C") = Variable
                            Case "04"
                                Dim Variable As String = "2 - Anulada"
                                Excel.Application.Cells(Recorrido + 2, "C") = Variable
                            Case "05"
                                Dim Variable As String = "4 - Devengada"
                                Excel.Application.Cells(Recorrido + 2, "C") = Variable
                        End Select
                        Excel.Application.Cells(Recorrido + 2, "D") = Ds.Tables(0).Rows(Recorrido).Item("Ruc_Proveedor")
                        Excel.Application.Cells(Recorrido + 2, "E") = Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                        Excel.Application.Cells(Recorrido + 2, "F") = Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                        Excel.Application.Cells(Recorrido + 2, "G") = Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                        Select Case Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Proceso").ToString
                            Case "01"
                                Dim Variable As String = "62 - Contrataciones hasta 8 UIT (LEY 30225)(No incluye las derivadas de contrataciones por catálogo electrónico.)"
                                Excel.Application.Cells(Recorrido + 2, "I") = Variable
                            Case Else
                                Dim Variable As String = "10 - Deviene de Procesos de Selección"
                                Excel.Application.Cells(Recorrido + 2, "I") = Variable
                        End Select
                        Excel.Application.Cells(Recorrido + 2, "J") = Ds.Tables(0).Rows(Recorrido).Item("Justificacion")
                        Excel.Application.Cells(Recorrido + 2, "K") = "1 - Bienes"
                        Excel.Application.Cells(Recorrido + 2, "L") = Ds.Tables(0).Rows(Recorrido).Item("Justificacion")
                        Excel.Application.Cells(Recorrido + 2, "M") = "Subgerencia de Logistica y Control Patrimonial"
                        Excel.Application.Cells(Recorrido + 2, "N") = "Sociedad de Beneficencia de Lima Metropolitana"
                        Excel.Application.Cells(Recorrido + 2, "O") = Ds.Tables(0).Rows(Recorrido).Item("Monto_Total")
                        Select Case Ds.Tables(0).Rows(Recorrido).Item("Codigo_Moneda").ToString
                            Case "01"
                                Dim Variable As String = "1 - Soles"
                                Excel.Application.Cells(Recorrido + 2, "P") = Variable
                            Case "02"
                                Dim Variable As String = "2 - Dolares"
                                Excel.Application.Cells(Recorrido + 2, "P") = Variable
                            Case "03"
                                Dim Variable As String = "3 - Euros"
                                Excel.Application.Cells(Recorrido + 2, "P") = Variable
                        End Select
                        Excel.Application.Cells(Recorrido + 2, "Q") = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Cambio")
                        Excel.Application.Range("A" & Recorrido + 1, "Q" & Recorrido + 3).Borders.LineStyle = 2
                    Next
                Case 2
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Excel.Application.Cells(Recorrido + 2, "A") = "20 - O/S"
                        Excel.Application.Cells(Recorrido + 2, "B") = Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString))
                        Select Case Ds.Tables(0).Rows(Recorrido).Item("Codigo_Estado_Orden").ToString
                            Case "01", "02"
                                Dim Variable As String = "1 - Emitida"
                                Excel.Application.Cells(Recorrido + 2, "C") = Variable
                            Case "03"
                                Dim Variable As String = "3 - Comprometida"
                                Excel.Application.Cells(Recorrido + 2, "C") = Variable
                            Case "04"
                                Dim Variable As String = "2 - Anulada"
                                Excel.Application.Cells(Recorrido + 2, "C") = Variable
                            Case "05"
                                Dim Variable As String = "4 - Devengada"
                                Excel.Application.Cells(Recorrido + 2, "C") = Variable
                        End Select
                        Excel.Application.Cells(Recorrido + 2, "D") = Ds.Tables(0).Rows(Recorrido).Item("Ruc_Proveedor")
                        Excel.Application.Cells(Recorrido + 2, "E") = Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                        Excel.Application.Cells(Recorrido + 2, "F") = Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                        Excel.Application.Cells(Recorrido + 2, "G") = Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                        Select Case Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Proceso").ToString
                            Case "01"
                                Dim Variable As String = "62 - Contrataciones hasta 8 UIT (LEY 30225)(No incluye las derivadas de contrataciones por catálogo electrónico.)"
                                Excel.Application.Cells(Recorrido + 2, "I") = Variable
                            Case Else
                                Dim Variable As String = "10 - Deviene de Procesos de Selección"
                                Excel.Application.Cells(Recorrido + 2, "I") = Variable
                        End Select
                        Excel.Application.Cells(Recorrido + 2, "J") = Ds.Tables(0).Rows(Recorrido).Item("Justificacion")
                        Excel.Application.Cells(Recorrido + 2, "K") = "2 - Servicios"
                        Excel.Application.Cells(Recorrido + 2, "L") = Ds.Tables(0).Rows(Recorrido).Item("Justificacion")
                        Excel.Application.Cells(Recorrido + 2, "M") = "Subgerencia de Logistica y Control Patrimonial"
                        Excel.Application.Cells(Recorrido + 2, "N") = "Sociedad de Beneficencia de Lima Metropolitana"
                        Excel.Application.Cells(Recorrido + 2, "O") = Ds.Tables(0).Rows(Recorrido).Item("Monto_Total")
                        Select Case Ds.Tables(0).Rows(Recorrido).Item("Codigo_Moneda").ToString
                            Case "01"
                                Dim Variable As String = "1 - Soles"
                                Excel.Application.Cells(Recorrido + 2, "P") = Variable
                            Case "02"
                                Dim Variable As String = "2 - Dolares"
                                Excel.Application.Cells(Recorrido + 2, "P") = Variable
                            Case "03"
                                Dim Variable As String = "3 - Euros"
                                Excel.Application.Cells(Recorrido + 2, "P") = Variable
                        End Select
                        Excel.Application.Cells(Recorrido + 2, "Q") = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Cambio")
                        Excel.Application.Range("A" & Recorrido + 1, "Q" & Recorrido + 3).Borders.LineStyle = 2
                    Next
            End Select
            Hoja.Range("A1", "Q1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("I2", "I" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("J2", "J" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("L2", "L" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "Q" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("O2", "O" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("Q2", "Q" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Caption = "Formulario"
            Hoja.Range("A" & Recorrido + 2, "Q" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "Q" & Recorrido + 2).MergeCells = True
            Hoja.Range("A1", "Q" & Recorrido + 2).Font.Name = "Calibri"
            Hoja.Range("A1", "Q" & Recorrido + 2).Font.Size = 9
            Hoja.Range("A1").ColumnWidth = 8
            Hoja.Range("B1").ColumnWidth = 5
            Hoja.Range("C1").ColumnWidth = 14
            Hoja.Range("D1").ColumnWidth = 11
            Hoja.Range("E1").ColumnWidth = 11.5
            Hoja.Range("F1").ColumnWidth = 11.5
            Hoja.Range("G1").ColumnWidth = 11.5
            Hoja.Range("H1").ColumnWidth = 9.25
            Hoja.Range("I1").ColumnWidth = 30
            Hoja.Range("J1").ColumnWidth = 36
            Hoja.Range("K1").ColumnWidth = 12
            Hoja.Range("L1").ColumnWidth = 40
            Hoja.Range("M1").ColumnWidth = 37
            Hoja.Range("N1").ColumnWidth = 40
            Hoja.Range("O1").ColumnWidth = 13
            Hoja.Range("P1").ColumnWidth = 11
            Hoja.Range("Q1").ColumnWidth = 7
            Dim Row_ As Object
            For Each Row_ In Excel.Application.ActiveCell.Rows("1:" & (Recorrido + 2))
                Row_.EntireRow.AutoFit()
            Next
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
        End If
    End Sub
    Public Function Valida_Fecha_Orden_Reenumeracion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal Nueva_Fecha As Date) As Boolean
        Valida_Fecha_Orden_Reenumeracion = True
        If Valida_Fecha_Orden_Reenumeracion = True Then
            Select Case Operacion
                Case 1
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim Certificado As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Orden_Reenumeracion = True
                            Else
                                Valida_Fecha_Orden_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Orden_Reenumeracion
                        End If
                        Return Valida_Fecha_Orden_Reenumeracion
                    End If
                    Return Valida_Fecha_Orden_Reenumeracion
                Case 2
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim Certificado As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Orden_Reenumeracion = True
                            Else
                                Valida_Fecha_Orden_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Orden_Reenumeracion
                        End If
                        Return Valida_Fecha_Orden_Reenumeracion
                    End If
                    Return Valida_Fecha_Orden_Reenumeracion
            End Select
        End If
        Return Valida_Fecha_Orden_Reenumeracion
    End Function
    Public Function Numero_Maximo_Documento_Presupuesto(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer) As Boolean
        Numero_Maximo_Documento_Presupuesto = True
        If Numero_Maximo_Documento_Presupuesto = True Then
            Select Case Operacion
                Case 1
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Max(Numero)) as Numero From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Maximo_Documento_Presupuesto = True
                        Else
                            Numero_Maximo_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Maximo_Documento_Presupuesto = False
                    End If
                Case 2
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Max(Numero)) As Numero From Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Maximo_Documento_Presupuesto = True
                        Else
                            Numero_Maximo_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Maximo_Documento_Presupuesto = False
                    End If
                Case 3
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Max(Numero)) As Numero From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Maximo_Documento_Presupuesto = True
                        Else
                            Numero_Maximo_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Maximo_Documento_Presupuesto = False
                    End If
                Case 4
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Max(Numero)) As Numero From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Maximo_Documento_Presupuesto = True
                        Else
                            Numero_Maximo_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Maximo_Documento_Presupuesto = False
                    End If
                Case 5
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Max(Numero)) As Numero From Prevision Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Maximo_Documento_Presupuesto = True
                        Else
                            Numero_Maximo_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Maximo_Documento_Presupuesto = False
                    End If
            End Select
        End If
        Return Numero_Maximo_Documento_Presupuesto
    End Function
    Public Function Numero_Primero_Documento_Presupuesto(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer) As Boolean
        Numero_Primero_Documento_Presupuesto = True
        If Numero_Primero_Documento_Presupuesto = True Then
            Select Case Operacion
                Case 1
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Min(Numero)) as Numero From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Primero_Documento_Presupuesto = True
                        Else
                            Numero_Primero_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Primero_Documento_Presupuesto = False
                    End If
                Case 2
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Min(Numero)) As Numero From Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Primero_Documento_Presupuesto = True
                        Else
                            Numero_Primero_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Primero_Documento_Presupuesto = False
                    End If
                Case 3
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Min(Numero)) As Numero From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Primero_Documento_Presupuesto = True
                        Else
                            Numero_Primero_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Primero_Documento_Presupuesto = False
                    End If
                Case 4
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Min(Numero)) As Numero From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Primero_Documento_Presupuesto = True
                        Else
                            Numero_Primero_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Primero_Documento_Presupuesto = False
                    End If
                Case 5
                    Dim Da As New OleDb.OleDbDataAdapter("Select Abs(Min(Numero)) As Numero From Prevision Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Numero").ToString) = Convert.ToInt32(Numero) Then
                            Numero_Primero_Documento_Presupuesto = True
                        Else
                            Numero_Primero_Documento_Presupuesto = False
                        End If
                    Else
                        Numero_Primero_Documento_Presupuesto = False
                    End If
            End Select
        End If
        Return Numero_Primero_Documento_Presupuesto
    End Function
    Public Function Valida_Fecha_Presupuesto_Documentos_Reenumeracion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal Nueva_Fecha As Date) As Boolean
        Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
        If Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True Then
            Select Case Operacion
                Case 1
                    If Me.Numero_Primero_Documento_Presupuesto(Año_Ejecucion, Numero, 1) = True Then
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 1) = True Then
                            Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= Nueva_Fecha Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    Else
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 1) = True Then
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Nueva_Fecha) >= DateValue(Fecha_Anterior) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            Ds = Nothing
                            Da = Nothing
                            Da = New OleDb.OleDbDataAdapter("Select * From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Ds = New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= DateValue(Nueva_Fecha) And DateValue(Fecha_Anterior) <= DateValue(Nueva_Fecha) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    End If
                Case 2
                    If Me.Numero_Primero_Documento_Presupuesto(Año_Ejecucion, Numero, 2) = True Then
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 2) = True Then
                            Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= Nueva_Fecha Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    Else
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 2) = True Then
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Nueva_Fecha) >= DateValue(Fecha_Anterior) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            Ds = Nothing
                            Da = Nothing
                            Da = New OleDb.OleDbDataAdapter("Select * From Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Ds = New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= DateValue(Nueva_Fecha) And DateValue(Fecha_Anterior) <= DateValue(Nueva_Fecha) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    End If

                Case 3
                    If Me.Numero_Primero_Documento_Presupuesto(Año_Ejecucion, Numero, 3) = True Then
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 3) = True Then
                            Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= Nueva_Fecha Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    Else
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 3) = True Then
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Nueva_Fecha) >= DateValue(Fecha_Anterior) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            Ds = Nothing
                            Da = Nothing
                            Da = New OleDb.OleDbDataAdapter("Select * From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Ds = New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= DateValue(Nueva_Fecha) And DateValue(Fecha_Anterior) <= DateValue(Nueva_Fecha) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    End If
                Case 4
                    If Me.Numero_Primero_Documento_Presupuesto(Año_Ejecucion, Numero, 4) = True Then
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 4) = True Then
                            Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= Nueva_Fecha Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    Else
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 4) = True Then
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Nueva_Fecha) >= DateValue(Fecha_Anterior) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            Ds = Nothing
                            Da = Nothing
                            Da = New OleDb.OleDbDataAdapter("Select * From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Ds = New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= DateValue(Nueva_Fecha) And DateValue(Fecha_Anterior) <= DateValue(Nueva_Fecha) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    End If
                Case 5
                    If Me.Numero_Primero_Documento_Presupuesto(Año_Ejecucion, Numero, 5) = True Then
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 5) = True Then
                            Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Prevision Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= Nueva_Fecha Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    Else
                        If Me.Numero_Maximo_Documento_Presupuesto(Año_Ejecucion, Numero, 5) = True Then
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Prevision Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Nueva_Fecha) >= DateValue(Fecha_Anterior) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        Else
                            Dim Fecha_Anterior As Date = Nothing
                            Dim Fecha_Posterior As Date = Nothing
                            Dim Da As New OleDb.OleDbDataAdapter("Select * From Prevision Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) <" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Dim Ds As New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Anterior = DateValue(Ds.Tables(0).Rows(Ds.Tables(0).Rows.Count - 1).Item("FechaEmision").ToString)
                            End If
                            Ds = Nothing
                            Da = Nothing
                            Da = New OleDb.OleDbDataAdapter("Select * From Prevision Where Año_Ejecucion='" & Año_Ejecucion & "' And Abs(Numero) >" & Convert.ToInt32(Numero) & " Order By Año_Ejecucion,Abs(Numero)", Cn)
                            Ds = New Data.DataSet
                            Da.Fill(Ds)
                            If Ds.Tables(0).Rows.Count > 0 Then
                                Fecha_Posterior = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                            End If
                            If DateValue(Fecha_Posterior) >= DateValue(Nueva_Fecha) And DateValue(Fecha_Anterior) <= DateValue(Nueva_Fecha) Then
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = True
                            Else
                                Valida_Fecha_Presupuesto_Documentos_Reenumeracion = False
                            End If
                        End If
                    End If

            End Select
        End If
        Return Valida_Fecha_Presupuesto_Documentos_Reenumeracion
    End Function
    Public Sub Reenumerar_Documentos_Presupuesto(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Anterior As String, ByVal Operacion As Integer, ByVal Nueva_Fecha As Date)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Certificado Set Numero='" & Numero & "',FechaEmision='" & DateValue(Nueva_Fecha) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Certificado porque está en uso", "..:: Reenumeración de Certificados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Nota_Modificatoria Set Numero='" & Numero & "',FechaEmision='" & DateValue(Nueva_Fecha) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Nota Modificatoria porque está en uso", "..:: Reenumeración de Certificados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 3
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Ampliacion Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Ampliacion Set Numero='" & Numero & "',FechaEmision='" & DateValue(Nueva_Fecha) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='03'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Certificado Set Ampliacion='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Ampliacion='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Ampliación porque está en uso", "..:: Reenumeración de Certificados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 4
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Rebaja Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Rebaja Set Numero='" & Numero & "',FechaEmision='" & DateValue(Nueva_Fecha) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='02'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Rebaja porque está en uso", "..:: Reenumeración de Certificados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 5
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Prevision Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Prevision Set Numero='" & Numero & "',FechaEmision='" & DateValue(Nueva_Fecha) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Prevision porque está en uso", "..:: Reenumeración de Certificados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
        End Select
    End Sub
    Public Function Valida_Fecha_Giro_Comprobante_Reenumeracion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal Nueva_Fecha As Date, Optional ByVal Año_Ejecucion_Referido As String = Nothing) As Boolean
        Valida_Fecha_Giro_Comprobante_Reenumeracion = True
        If Valida_Fecha_Giro_Comprobante_Reenumeracion = True Then
            Select Case Operacion
                Case 1
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim Devengado As String = ""
                        Dim Girado As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Girado & "' And Codigo_Tipo_Operacion='29'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            Devengado = DsKlaus.Tables(0).Rows(0).Item("Numero").ToString
                        Else
                            Devengado = ""
                        End If
                        DsKlaus = Nothing
                        DaKlaus = Nothing
                        DaKlaus = New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Devengado & "'", Cn)
                        DsKlaus = New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 2
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim Devengado As String = ""
                        Dim Girado As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Girado & "' And Codigo_Tipo_Operacion='30'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            Devengado = DsKlaus.Tables(0).Rows(0).Item("Numero").ToString
                        Else
                            Devengado = ""
                        End If
                        DsKlaus = Nothing
                        DaKlaus = Nothing
                        DaKlaus = New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Devengado & "'", Cn)
                        DsKlaus = New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 3
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim Devengado As String = ""
                        Dim Girado As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Girado & "' And Codigo_Tipo_Operacion='41'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            Devengado = DsKlaus.Tables(0).Rows(0).Item("Numero").ToString
                        Else
                            Devengado = ""
                        End If
                        DsKlaus = Nothing
                        DaKlaus = Nothing
                        DaKlaus = New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Devengado & "'", Cn)
                        DsKlaus = New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 4
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim Devengado As String = ""
                        Dim Girado As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Girado & "' And Codigo_Tipo_Operacion='42'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            Devengado = DsKlaus.Tables(0).Rows(0).Item("Numero").ToString
                        Else
                            Devengado = ""
                        End If
                        DsKlaus = Nothing
                        DaKlaus = Nothing
                        DaKlaus = New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Devengado & "'", Cn)
                        DsKlaus = New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 5
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim Devengado As String = ""
                        Dim Girado As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Girado & "' And Codigo_Tipo_Operacion='42'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            Devengado = DsKlaus.Tables(0).Rows(0).Item("Numero").ToString
                        Else
                            Devengado = ""
                        End If
                        DsKlaus = Nothing
                        DaKlaus = Nothing
                        DaKlaus = New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Devengado & "'", Cn)
                        DsKlaus = New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 6
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim Devengado As String = ""
                        Dim Girado As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Girado & "' And Codigo_Tipo_Operacion='45'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            Devengado = DsKlaus.Tables(0).Rows(0).Item("Numero").ToString
                        Else
                            Devengado = ""
                        End If
                        DsKlaus = Nothing
                        DaKlaus = Nothing
                        DaKlaus = New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Devengado & "'", Cn)
                        DsKlaus = New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 7
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim Devengado As String = ""
                        Dim Girado As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Girado & "' And Codigo_Tipo_Operacion='54'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            Devengado = DsKlaus.Tables(0).Rows(0).Item("Numero").ToString
                        Else
                            Devengado = ""
                        End If
                        DsKlaus = Nothing
                        DaKlaus = Nothing
                        DaKlaus = New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Devengado & "'", Cn)
                        DsKlaus = New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 11
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Comprobante='" & Numero & "'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 22
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Comprobante='" & Numero & "'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 33
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Comprobante='" & Numero & "'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 44
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Comprobante='" & Numero & "'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 55
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Comprobante='" & Numero & "'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 66
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Comprobante='" & Numero & "'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                Case 77
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Dim DaKlaus As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Comprobante='" & Numero & "'", Cn)
                        Dim DsKlaus As New Data.DataSet
                        DaKlaus.Fill(DsKlaus)
                        If DsKlaus.Tables(0).Rows.Count > 0 Then
                            If DateValue(Nueva_Fecha) >= DateValue(DsKlaus.Tables(0).Rows(0).Item("FechaEmision").ToString) Then
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = True
                            Else
                                Valida_Fecha_Giro_Comprobante_Reenumeracion = False
                            End If
                            Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                        End If
                        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
                    End If
                    Return Valida_Fecha_Giro_Comprobante_Reenumeracion
            End Select
        End If
        Return Valida_Fecha_Giro_Comprobante_Reenumeracion
    End Function
    Public Sub Reenumerar_Orden(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Anterior As String, ByVal FechaEmision As Date, ByVal Operacion As Integer)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Orden_Compra Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Numero_Documento=" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='05'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Requerimiento_Bienes_Movimientos Set Orden='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_orden_Compra_movimientos Set Numero='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "' And Codigo_Tipo_Operacion='05'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_orden_Compra_Centro_Costos Set Numero='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Orden_Compra_Documentos Set Numero='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden Set Numero='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Orden porque está en uso", "..:: Reenumeración de Ordenes ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Orden_Servicio Set Numero='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Numero_Documento=" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='06'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Requerimiento_Servicios_Movimientos Set Orden='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Orden='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_orden_Servicio_movimientos Set Numero='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "' And Codigo_Tipo_Operacion='06'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_orden_Servicio_Centro_Costos Set Numero='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Orden_Servicio_Distribucion Set Numero='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Orden_Servicio_Documentos Set Numero='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden Set Numero='" & Microsoft.VisualBasic.Right("0000" & Numero, 4) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Orden porque está en uso", "..:: Reenumeración de Ordenes ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
        End Select
    End Sub
    Public Sub Reenumerar_Girado_Comprobante(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Anterior As String, ByVal FechaEmision As Date, ByVal Operacion As Integer, ByVal Año_Ejecucion_Referido As String)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Girado Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Comprobante_Pago Set Numero_Giro=" & Numero & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Giro='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='29'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Girado Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Comprobante_Pago Set Numero_Giro=" & Numero & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Giro='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='30'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 3
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Girado Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Comprobante_Pago Set Numero_Giro=" & Numero & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Giro='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='41'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 4
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Girado Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Comprobante_Pago Set Numero_Giro=" & Numero & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Giro='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='42'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 5
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Girado Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Comprobante_Pago Set Numero_Giro=" & Numero & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Giro='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='34'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 6
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Girado Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Comprobante_Pago Set Numero_Giro=" & Numero & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Giro='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='45'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 7
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Girado Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Comprobante_Pago Set Numero_Giro=" & Numero & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Giro='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='54'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 8
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Girado Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Comprobante_Pago Set Numero_Giro=" & Numero & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Giro='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 9
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Girado Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Comprobante_Pago Set Numero_Giro=" & Numero & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Giro='" & Anterior & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Numero_Documento='" & Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Anterior & "' And Codigo_Tipo_Operacion='63'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
            Case 11, 22, 33, 44, 55, 66, 77, 88, 99
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' and Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    'Variable_Numero_Girado
                    'Cm.CommandText = "Update Comprobante_Pago Set Numero='" & Numero & "',FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'"
                    Cm.CommandText = "Update Comprobante_Pago Set Numero='" & Numero & "',FechaEmision='" & FechaEmision.ToString("dd/MM/yyyy") & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Anterior & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "' and Numero_Giro = '" & Variable_Numero_Girado & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    'Cm.CommandText = "Update Girado Set Numero_Comprobante='" & Numero & "',Fecha_Emision_Comprobante='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Comprobante='" & Anterior & "'"
                    Cm.CommandText = "Update Girado Set Numero_Comprobante='" & Numero & "',Fecha_Emision_Comprobante='" & FechaEmision.ToString("dd/MM/yyyy") & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Comprobante='" & Anterior & "' and Numero = '" & Variable_Numero_Girado & "'"
                    Cm.ExecuteNonQuery()
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    MessageBox.Show("No Se puede asignar el Número de Girado porque está en uso", "..:: Reenumeración de Girados ::..", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)
                End If
        End Select
    End Sub
    Public Sub Cambiar_Fecha_Orden(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal FechaEmision As Date, ByVal Operacion As Integer)
        Select Case Operacion
            Case 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Orden_Compra Set FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 2
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Orden_Servicio Set FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Cambiar_Fecha_Documento_Presupuesto(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal FechaEmision As Date, ByVal Operacion As Integer)
        Select Case Operacion
            Case 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Certificado Set FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 2
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Nota_Modificatoria Set FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 3
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Ampliacion Set FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 4
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Rebaja Set FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 5
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Prevision Set FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Cambiar_Fecha_Giro_Comprobante(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal FechaEmision As Date, ByVal Operacion As Integer)
        Select Case Operacion
            Case 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 2
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Comprobante_Pago Set FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Cargar_Data_Rebajas_Ordenes(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView, Optional ByVal Caja_Orden As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Certificado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto_Orden As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto_Certificado As System.Windows.Forms.TextBox = Nothing)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Sum(Monto) As Saldo From Lista_Centro_Costos_Orden_Compra_Pre Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero")
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado")
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Requerimiento")
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta")
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos")
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica")
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                        DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                        DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                        DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                        DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                        DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                        DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                        DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo")
                        DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo")
                        DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase")
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia")
                        DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item")
                        DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                        DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo")
                        DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Item")
                        DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                        DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = "0.00"
                    Next
                End If
                Dim Orden As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                Dim Año As String = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
                Dim Certificado As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                Dim Monto_Orden As Double = 0
                Dim Monto_Certificado As Double = 0
                Dim Justificacion As String = ""
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Compra_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Monto_Orden = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString)
                If Ds.Tables(0).Rows.Count > 0 Then Justificacion = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Monto_Certificado = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString)
                If TypeOf Caja_Orden Is System.Windows.Forms.TextBox Then Caja_Orden.Text = Orden & "-" & Año
                If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Certificado & "-" & Año
                If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Justificacion
                If TypeOf Caja_Monto_Orden Is System.Windows.Forms.TextBox Then Caja_Monto_Orden.Text = Format(Monto_Orden, "###,###,#.00")
                If TypeOf Caja_Monto_Certificado Is System.Windows.Forms.TextBox Then Caja_Monto_Certificado.Text = Format(Monto_Certificado, "###,###,#.00")
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Sum(Monto) As Saldo From Lista_Centro_Costos_Orden_Servicio_Pre Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero")
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado")
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Requerimiento")
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta")
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos")
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica")
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                        DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                        DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                        DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                        DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                        DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                        DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                        DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo")
                        DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo")
                        DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase")
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia")
                        DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item")
                        DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                        DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo")
                        DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Item")
                        DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                        DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = "0.00"
                    Next
                End If
                Dim Orden As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                Dim Año As String = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
                Dim Certificado As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                Dim Monto_Orden As Double = 0
                Dim Monto_Certificado As Double = 0
                Dim Justificacion As String = ""
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Servicio_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Monto_Orden = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString)
                If Ds.Tables(0).Rows.Count > 0 Then Justificacion = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Monto_Certificado = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString)
                If TypeOf Caja_Orden Is System.Windows.Forms.TextBox Then Caja_Orden.Text = Orden & "-" & Año
                If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Certificado & "-" & Año
                If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Justificacion
                If TypeOf Caja_Monto_Orden Is System.Windows.Forms.TextBox Then Caja_Monto_Orden.Text = Format(Monto_Orden, "###,###,#.00")
                If TypeOf Caja_Monto_Certificado Is System.Windows.Forms.TextBox Then Caja_Monto_Certificado.Text = Format(Monto_Certificado, "###,###,#.00")
        End Select
    End Sub
    Public Function Generar_Numero_Item(ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Codigo_Item)+1),1) As Numero From Item Where Codigo_Catalogo='" & Codigo_Catalogo & "' And Codigo_Grupo='" & Codigo_Grupo & "' And Codigo_Clase='" & Codigo_Clase & "' And Codigo_Familia='" & Codigo_Familia & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Item = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Item
    End Function
    Public Sub Nuevo_Item(ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Descripcion_Item As String, ByVal Codigo_Unidad_Medida As String, ByVal Tipo_Transaccion As Integer, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Activo As Boolean, ByVal IGV As Boolean, Byval PrecioReferencial as Decimal, Byval Año_Ejecucion as String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Item_Y_CN"
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Descripcion_Item", Descripcion_Item)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Medida", Codigo_Unidad_Medida)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Activo", Activo)
        Cm.Parameters.AddWithValue("@IGV", IGV)

        Cm.Parameters.AddWithValue("@año_ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@precio_referencial", PrecioReferencial)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Item(ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Descripcion_Item As String, ByVal Codigo_Unidad_Medida As String, ByVal Tipo_Transaccion As Integer, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Activo As Boolean, ByVal IGV As Boolean, Byval PrecioReferencial as Decimal, Byval Año_Ejecucion as String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Item_y_CN"
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Descripcion_Item", Descripcion_Item)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Medida", Codigo_Unidad_Medida)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Activo", Activo)
        Cm.Parameters.AddWithValue("@IGV", IGV)

        Cm.Parameters.AddWithValue("@año_ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@precio_referencial", PrecioReferencial)

        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Mostrar_Data_Item_Catalogo_Modificacion(ByVal Tipo As Integer, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Combo_Grupo As System.Windows.Forms.ComboBox, ByVal Combo_Clase As System.Windows.Forms.ComboBox, ByVal Combo_Familia As System.Windows.Forms.ComboBox, ByVal Caja_Codigo As System.Windows.Forms.TextBox, ByVal Caja_Item As System.Windows.Forms.TextBox, ByVal Combo_Unidad As System.Windows.Forms.ComboBox, ByVal Combo_TT As System.Windows.Forms.ComboBox, ByVal Combo_Generica As System.Windows.Forms.ComboBox, ByVal Combo_SubGenerica As System.Windows.Forms.ComboBox, ByVal Combo_SubGenerica_Detalle As System.Windows.Forms.ComboBox, ByVal Combo_Especifica As System.Windows.Forms.ComboBox, ByVal Combo_Especifica_Detalle As System.Windows.Forms.ComboBox, ByVal Check_Activo As System.Windows.Forms.CheckBox, ByVal Check_IGV As System.Windows.Forms.CheckBox, ByVal PrecioReferencia as System.Windows.Forms.TextBox, ByVal Año_Ejecucion As String)
        Select Case Tipo
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Bienes Where Codigo_Grupo='" & Codigo_Grupo & "' And Codigo_Clase='" & Codigo_Clase & "' And Codigo_Familia='" & Codigo_Familia & "' And Codigo_Item='" & Codigo_Item & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)

                Dim Da2 As New OleDb.OleDbDataAdapter("Select precio_unitario From Catalogo_CN Where Año_ejecucion = '"& Año_Ejecucion &"' And codigo='" & Codigo_Grupo & "." & Codigo_Clase & "." & Codigo_Familia & "." & Codigo_Item & "'", Cn)
                Dim Ds2 As New Data.DataSet
                Da2.Fill(Ds2)

                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Clasificador As String = Ds.Tables(0).Rows(0).Item("Clasificador")
                    If TypeOf Combo_Grupo Is System.Windows.Forms.ComboBox Then Combo_Grupo.Text = Ds.Tables(0).Rows(0).Item("Grupo").ToString
                    If TypeOf Combo_Clase Is System.Windows.Forms.ComboBox Then Combo_Clase.Text = Ds.Tables(0).Rows(0).Item("Clase").ToString
                    If TypeOf Combo_Familia Is System.Windows.Forms.ComboBox Then Combo_Familia.Text = Ds.Tables(0).Rows(0).Item("Familia").ToString
                    If TypeOf Caja_Codigo Is System.Windows.Forms.TextBox Then Caja_Codigo.Text = Ds.Tables(0).Rows(0).Item("Codigo").ToString
                    If TypeOf Caja_Item Is System.Windows.Forms.TextBox Then Caja_Item.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Item").ToString
                    If TypeOf Combo_Unidad Is System.Windows.Forms.ComboBox Then Combo_Unidad.Text = Ds.Tables(0).Rows(0).Item("Unidad").ToString

                    if Ds2.Tables(0).Rows.Count>0 
                        If TypeOf PrecioReferencia Is System.Windows.Forms.TextBox Then PrecioReferencia.Text = IIf(Ds2.Tables(0).Rows.Count>0, Ds2.Tables(0).Rows(0).Item("precio_unitario").ToString, "0.00")
                    else
                            If TypeOf PrecioReferencia Is System.Windows.Forms.TextBox Then PrecioReferencia.Text = "1.00"
                    End If
                    

                    If Ds.Tables(0).Rows(0).Item("Estado").ToString = "ACTIVO" Then
                        If TypeOf Check_Activo Is System.Windows.Forms.CheckBox Then Check_Activo.Checked = True
                    Else
                        If TypeOf Check_Activo Is System.Windows.Forms.CheckBox Then Check_Activo.Checked = False
                    End If
                    If TypeOf Check_IGV Is System.Windows.Forms.CheckBox Then Check_IGV.Checked = (Ds.Tables(0).Rows(0).Item("IGV"))
                    Da = Nothing
                    Ds = Nothing
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Clasificadores_2 Where Clasificador='" & Clasificador & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If TypeOf Combo_TT Is System.Windows.Forms.ComboBox Then Combo_TT.Text = Ds.Tables(0).Rows(0).Item("TT").ToString
                        If TypeOf Combo_Generica Is System.Windows.Forms.ComboBox Then Combo_Generica.Text = Ds.Tables(0).Rows(0).Item("G").ToString
                        If TypeOf Combo_SubGenerica Is System.Windows.Forms.ComboBox Then Combo_SubGenerica.Text = Ds.Tables(0).Rows(0).Item("SG").ToString
                        If TypeOf Combo_SubGenerica_Detalle Is System.Windows.Forms.ComboBox Then Combo_SubGenerica_Detalle.Text = Ds.Tables(0).Rows(0).Item("SGD").ToString
                        If TypeOf Combo_Especifica Is System.Windows.Forms.ComboBox Then Combo_Especifica.Text = Ds.Tables(0).Rows(0).Item("E").ToString
                        If TypeOf Combo_Especifica_Detalle Is System.Windows.Forms.ComboBox Then Combo_Especifica_Detalle.Text = Ds.Tables(0).Rows(0).Item("ED").ToString
                    End If
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Servicios Where Codigo_Grupo='" & Codigo_Grupo & "' And Codigo_Clase='" & Codigo_Clase & "' And Codigo_Familia='" & Codigo_Familia & "' And Codigo_Item='" & Codigo_Item & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Clasificador As String = Ds.Tables(0).Rows(0).Item("Clasificador")
                    If TypeOf Combo_Grupo Is System.Windows.Forms.ComboBox Then Combo_Grupo.Text = Ds.Tables(0).Rows(0).Item("Grupo").ToString
                    If TypeOf Combo_Clase Is System.Windows.Forms.ComboBox Then Combo_Clase.Text = Ds.Tables(0).Rows(0).Item("Clase").ToString
                    If TypeOf Combo_Familia Is System.Windows.Forms.ComboBox Then Combo_Familia.Text = Ds.Tables(0).Rows(0).Item("Familia").ToString
                    If TypeOf Caja_Codigo Is System.Windows.Forms.TextBox Then Caja_Codigo.Text = Ds.Tables(0).Rows(0).Item("Codigo").ToString
                    If TypeOf Caja_Item Is System.Windows.Forms.TextBox Then Caja_Item.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Item").ToString
                    If TypeOf Combo_Unidad Is System.Windows.Forms.ComboBox Then Combo_Unidad.Text = Ds.Tables(0).Rows(0).Item("Unidad").ToString

                    If TypeOf PrecioReferencia Is System.Windows.Forms.TextBox Then PrecioReferencia.Text = "1.00"

                    If Ds.Tables(0).Rows(0).Item("Estado").ToString = "ACTIVO" Then
                        If TypeOf Check_Activo Is System.Windows.Forms.CheckBox Then Check_Activo.Checked = True
                    Else
                        If TypeOf Check_Activo Is System.Windows.Forms.CheckBox Then Check_Activo.Checked = False
                    End If
                    If TypeOf Check_IGV Is System.Windows.Forms.CheckBox Then Check_IGV.Checked = (Ds.Tables(0).Rows(0).Item("IGV"))
                    Da = Nothing
                    Ds = Nothing
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Clasificadores_2 Where Clasificador='" & Clasificador & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If TypeOf Combo_TT Is System.Windows.Forms.ComboBox Then Combo_TT.Text = Ds.Tables(0).Rows(0).Item("TT").ToString
                        If TypeOf Combo_Generica Is System.Windows.Forms.ComboBox Then Combo_Generica.Text = Ds.Tables(0).Rows(0).Item("G").ToString
                        If TypeOf Combo_SubGenerica Is System.Windows.Forms.ComboBox Then Combo_SubGenerica.Text = Ds.Tables(0).Rows(0).Item("SG").ToString
                        If TypeOf Combo_SubGenerica_Detalle Is System.Windows.Forms.ComboBox Then Combo_SubGenerica_Detalle.Text = Ds.Tables(0).Rows(0).Item("SGD").ToString
                        If TypeOf Combo_Especifica Is System.Windows.Forms.ComboBox Then Combo_Especifica.Text = Ds.Tables(0).Rows(0).Item("E").ToString
                        If TypeOf Combo_Especifica_Detalle Is System.Windows.Forms.ComboBox Then Combo_Especifica_Detalle.Text = Ds.Tables(0).Rows(0).Item("ED").ToString
                    End If
                End If
        End Select
    End Sub
    Public Sub Cargar_Data_Devengar_Ordenes(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView, Optional ByVal Caja_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Fecha As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_TC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Certificado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Expediente As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_RUC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Procedimiento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Contrato As System.Windows.Forms.TextBox = Nothing)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Sum(Cantidad) As Cantidad,Costo From Lista_Centro_Costos_Orden_Compra_Pre_2 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Costo Having Sum(Cantidad) >0 ", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero")
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado")
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Requerimiento")
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta")
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos")
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica")
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                        DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                        DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                        DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                        DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                        DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                        DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                        DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo")
                        DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo")
                        DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase")
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia")
                        DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item")
                        DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                        DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo")
                        DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Item")
                        DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), "###,###,#.00000")
                        DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "###,###,#.00000")
                        DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00000")
                        DataGridView.Item(27, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00000")
                        DataGridView.Item(28, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                    Next
                End If
                Dim Orden As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                Dim Año As String = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
                Dim Certificado As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                Dim Monto_Orden As Double = 0
                Dim Monto_Certificado As Double = 0
                Dim Justificacion As String = ""
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Compra_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Monto_Orden = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString)
                If Ds.Tables(0).Rows.Count > 0 Then Justificacion = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = Orden & " - " & Año
                If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Justificacion
                If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Monto_Orden, "###,###,#.00")
                If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                If TypeOf Caja_TC Is System.Windows.Forms.TextBox Then Caja_TC.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Tipo_Cambio").ToString), "###,###,#.00")
                If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Moneda").ToString
                If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString, 10)
                If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString & " - " & Año
                If TypeOf Caja_Expediente Is System.Windows.Forms.TextBox Then Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Expediente").ToString
                If TypeOf Caja_RUC Is System.Windows.Forms.TextBox Then Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                Ds = Nothing
                Da = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ordenes_Compra_Basica_2 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = Ds.Tables(0).Rows(0).Item("Procedimiento").ToString
                If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = Ds.Tables(0).Rows(0).Item("Contrato").ToString
                Ds = Nothing
                Da = Nothing
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Cantidad ,Sum(Costo) As Costo From Lista_Centro_Costos_Orden_Servicio_Pre_2 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Cantidad Having Sum(Costo)>0", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero")
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado")
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Requerimiento")
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta")
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos")
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica")
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                        DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                        DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                        DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                        DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                        DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                        DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                        DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo")
                        DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo")
                        DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase")
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia")
                        DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item")
                        DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                        DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo")
                        DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Item")
                        DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), "###,###,#.00")
                        DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "###,###,#.00")
                        DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                        DataGridView.Item(27, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                        DataGridView.Item(28, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                    Next
                End If
                Dim Orden As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                Dim Año As String = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
                Dim Certificado As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                Dim Monto_Orden As Double = 0
                Dim Monto_Certificado As Double = 0
                Dim Justificacion As String = ""
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Servicio_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Monto_Orden = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString)
                If Ds.Tables(0).Rows.Count > 0 Then Justificacion = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = Orden & " - " & Año
                If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Justificacion
                If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Monto_Orden, "###,###,#.00")
                If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                If TypeOf Caja_TC Is System.Windows.Forms.TextBox Then Caja_TC.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Tipo_Cambio").ToString), "###,###,#.00")
                If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Moneda").ToString
                If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString, 10)
                If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString & " - " & Año
                If TypeOf Caja_Expediente Is System.Windows.Forms.TextBox Then Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Expediente").ToString
                If TypeOf Caja_RUC Is System.Windows.Forms.TextBox Then Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                Ds = Nothing
                Da = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ordenes_Servicio_Basica_2 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = Ds.Tables(0).Rows(0).Item("Procedimiento").ToString
                If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = Ds.Tables(0).Rows(0).Item("Contrato").ToString
                Ds = Nothing
                Da = Nothing
        End Select
    End Sub
    Public Sub Cargar_Data_Cuentas_Orden(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal DataGridView_1 As System.Windows.Forms.DataGridView, ByVal DataGridView_2 As System.Windows.Forms.DataGridView, Optional ByVal Caja_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Fecha As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_TC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Certificado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Expediente As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_RUC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Procedimiento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Contrato As System.Windows.Forms.TextBox = Nothing)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Sum(Cantidad) As Cantidad,Costo From Lista_Centro_Costos_Orden_Compra_Pre_3 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Costo ", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Orden As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                Dim Año As String = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
                Dim Certificado As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                Dim Monto_Orden As Double = 0
                Dim Monto_Certificado As Double = 0
                Dim Justificacion As String = ""
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Compra_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Monto_Orden = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString)
                If Ds.Tables(0).Rows.Count > 0 Then Justificacion = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = Orden & " - " & Año
                If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Justificacion
                If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Monto_Orden, "###,###,#.00")
                If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                If TypeOf Caja_TC Is System.Windows.Forms.TextBox Then Caja_TC.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Tipo_Cambio").ToString), "###,###,#.00")
                If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Moneda").ToString
                If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString, 10)
                If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString & " - " & Año
                If TypeOf Caja_Expediente Is System.Windows.Forms.TextBox Then Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Expediente").ToString
                If TypeOf Caja_RUC Is System.Windows.Forms.TextBox Then Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                Ds = Nothing
                Da = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ordenes_Compra_Basica_3 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = Ds.Tables(0).Rows(0).Item("Procedimiento").ToString
                If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = Ds.Tables(0).Rows(0).Item("Contrato").ToString
                Ds = Nothing
                Da = Nothing
                If Año_Ejecucion < 2020 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Cuentas_Orden_OC_Resumen_Debe_Haber_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Mayor='9101'", Cn)
                Else
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Cuentas_Orden_OC_Resumen_Debe_Haber_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Mayor='0101'", Cn)
                End If
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView_1.Rows.Add()
                        DataGridView_1.Item(0, DataGridView_1.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Operacion")
                        DataGridView_1.Item(1, DataGridView_1.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta_Orden")
                        DataGridView_1.Item(2, DataGridView_1.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Debe").ToString), "###,###,#.00")
                        DataGridView_1.Item(3, DataGridView_1.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Haber").ToString), "###,###,#.00")
                    Next
                End If
                Da = Nothing
                Ds = Nothing
                If Año_Ejecucion < 2020 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Cuentas_Orden_OC_Resumen_Debe_Haber_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Mayor='9102'", Cn)
                Else
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Cuentas_Orden_OC_Resumen_Debe_Haber_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Mayor='0102'", Cn)
                End If
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView_2.Rows.Add()
                        DataGridView_2.Item(0, DataGridView_2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Operacion")
                        DataGridView_2.Item(1, DataGridView_2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta_Orden")
                        DataGridView_2.Item(2, DataGridView_2.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Debe").ToString), "###,###,#.00")
                        DataGridView_2.Item(3, DataGridView_2.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Haber").ToString), "###,###,#.00")
                    Next
                End If
                Da = Nothing
                Ds = Nothing
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Cantidad ,Sum(Costo) As Costo From Lista_Centro_Costos_Orden_Servicio_Pre_3 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Certificado,Requerimiento,Meta,[C.Costos],Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Catalogo,Codigo_Grupo,Codigo_Clase,Codigo_Familia,Codigo_Item,Clasificador,Codigo,Item,Cantidad", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Orden As String = Ds.Tables(0).Rows(0).Item("Numero").ToString
                Dim Año As String = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
                Dim Certificado As String = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                Dim Monto_Orden As Double = 0
                Dim Monto_Certificado As Double = 0
                Dim Justificacion As String = ""
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Servicio_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Monto_Orden = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString)
                If Ds.Tables(0).Rows.Count > 0 Then Justificacion = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = Orden & " - " & Año
                If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Justificacion
                If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Monto_Orden, "###,###,#.00")
                If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                If TypeOf Caja_TC Is System.Windows.Forms.TextBox Then Caja_TC.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Tipo_Cambio").ToString), "###,###,#.00")
                If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Moneda").ToString
                If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString, 10)
                If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString & " - " & Año
                If TypeOf Caja_Expediente Is System.Windows.Forms.TextBox Then Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Expediente").ToString
                If TypeOf Caja_RUC Is System.Windows.Forms.TextBox Then Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                Ds = Nothing
                Da = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ordenes_Servicio_Basica_3 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = Ds.Tables(0).Rows(0).Item("Procedimiento").ToString
                If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = Ds.Tables(0).Rows(0).Item("Contrato").ToString
                Ds = Nothing
                Da = Nothing
                If Año_Ejecucion < 2020 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Cuentas_Orden_OS_Resumen_Debe_Haber_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Mayor='9101'", Cn)
                Else
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Cuentas_Orden_OS_Resumen_Debe_Haber_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Mayor='0101'", Cn)
                End If

                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView_1.Rows.Add()
                        DataGridView_1.Item(0, DataGridView_1.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Operacion")
                        DataGridView_1.Item(1, DataGridView_1.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta_Orden")
                        DataGridView_1.Item(2, DataGridView_1.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Debe").ToString), "###,###,#.00")
                        DataGridView_1.Item(3, DataGridView_1.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Haber").ToString), "###,###,#.00")
                    Next
                End If
                Da = Nothing
                Ds = Nothing
                If Año_Ejecucion < 2020 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Cuentas_Orden_OS_Resumen_Debe_Haber_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Mayor='9102'", Cn)
                Else
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Cuentas_Orden_OS_Resumen_Debe_Haber_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Mayor='0102'", Cn)
                End If

                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView_2.Rows.Add()
                        DataGridView_2.Item(0, DataGridView_2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Operacion")
                        DataGridView_2.Item(1, DataGridView_2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta_Orden")
                        DataGridView_2.Item(2, DataGridView_2.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Debe").ToString), "###,###,#.00")
                        DataGridView_2.Item(3, DataGridView_2.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Haber").ToString), "###,###,#.00")
                    Next
                End If
                Da = Nothing
                Ds = Nothing
        End Select
    End Sub
    Public Sub Nuevo_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Notas As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Devengado As String, ByVal Codigo_Comprobante As String, ByVal Serie_Comprobante As String, ByVal Numero_Comprobante As String, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String, ByVal Compromiso As String, ByVal Monto_Total As Double, ByVal IGV As Double, ByVal Sub_Total As Double, ByVal Porcentaje As Double, ByVal Porcentaje_Renta As Double, ByVal Otros As Double, ByVal Tercero As Boolean, ByVal Codigo_Moneda As String, ByVal Tipo_Cambio As Double, ByVal Certificado As String, ByVal Fecha_Emision_Comprobante As Date, ByVal Check_IGV As Boolean, ByVal Check_Renta As Boolean, ByVal Renta As Double, ByVal Codigo_Proveedor As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Devengado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Devengado", Codigo_Estado_Devengado)
        Cm.Parameters.AddWithValue("@Codigo_Comprobante", Codigo_Comprobante)
        Cm.Parameters.AddWithValue("@Serie_Comprobante", Serie_Comprobante)
        Cm.Parameters.AddWithValue("@Numero_Comprobante", Numero_Comprobante)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Compromiso", Compromiso)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Sub_Total", Sub_Total)
        Cm.Parameters.AddWithValue("@Porcentaje", Porcentaje)
        Cm.Parameters.AddWithValue("@Porcentaje_Renta", Porcentaje_Renta)
        Cm.Parameters.AddWithValue("@Otros", Otros)
        Cm.Parameters.AddWithValue("@Tercero", Tercero)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Fecha_Emision_Comprobante", Fecha_Emision_Comprobante)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@Check_Renta", Check_Renta)
        Cm.Parameters.AddWithValue("@Renta", Renta)
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Devengado Set Codigo_Proveedor='" & Codigo_Proveedor & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Modificar_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Notas As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Devengado As String, ByVal Codigo_Comprobante As String, ByVal Serie_Comprobante As String, ByVal Numero_Comprobante As String, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String, ByVal Compromiso As String, ByVal Monto_Total As Double, ByVal IGV As Double, ByVal Sub_Total As Double, ByVal Porcentaje As Double, ByVal Porcentaje_Renta As Double, ByVal Otros As Double, ByVal Tercero As Boolean, ByVal Codigo_Moneda As String, ByVal Tipo_Cambio As Double, ByVal Certificado As String, ByVal Fecha_Emision_Comprobante As Date, ByVal Check_IGV As Boolean, ByVal Check_Renta As Boolean, ByVal Renta As Double, ByVal Codigo_Proveedor As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Devengado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Devengado", Codigo_Estado_Devengado)
        Cm.Parameters.AddWithValue("@Codigo_Comprobante", Codigo_Comprobante)
        Cm.Parameters.AddWithValue("@Serie_Comprobante", Serie_Comprobante)
        Cm.Parameters.AddWithValue("@Numero_Comprobante", Numero_Comprobante)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Compromiso", Compromiso)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Sub_Total", Sub_Total)
        Cm.Parameters.AddWithValue("@Porcentaje", Porcentaje)
        Cm.Parameters.AddWithValue("@Porcentaje_Renta", Porcentaje_Renta)
        Cm.Parameters.AddWithValue("@Otros", Otros)
        Cm.Parameters.AddWithValue("@Tercero", Tercero)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Fecha_Emision_Comprobante", Fecha_Emision_Comprobante)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@Check_Renta", Check_Renta)
        Cm.Parameters.AddWithValue("@Renta", Renta)
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Devengado Set Codigo_Proveedor='" & Codigo_Proveedor & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Eliminar_Devengado(ByVal Tipo_Documento_Devengado As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        Select Case Tipo_Documento_Devengado
            Case "08"
                If Operacion = True Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='07'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion In('25','26')"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='07'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion In('25','26')"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "09"
                If Operacion = True Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='08'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion In('25','26')"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='08'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion In('25','26')"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "22"
                If Operacion = True Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='39'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='39'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "23"
                If Operacion = True Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='40'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='40'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "19"
                If Operacion = True Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Planilla_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='33'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Planilla_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='33'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "31"
                If Operacion = True Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Pagos_Varios_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='44'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Pagos_Varios_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='44'"
                    Cm.ExecuteNonQuery()
                End If
            Case "34"
                If Operacion = True Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Encargo_Interno_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='53'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Encargo_Interno_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='53'"
                    Cm.ExecuteNonQuery()
                End If

            Case "41"
                If Operacion = True Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Pagos_Varios_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Contrato_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                    Cm.ExecuteNonQuery()
                End If
        End Select
    End Sub
    Public Sub Nuevo_Detalle_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Codigo_Tipo_Recurso As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Devengado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Devengado_Movimientos(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Double, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Codigo_Documento As String, ByVal Numero_Documento As String, ByVal Codigo_Estado_Devengado_Movimientos As String, ByVal Codigo_Tipo_Recurso As String, ByVal Certificado As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Devengado_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Documento", Codigo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Devengado_Movimientos", Codigo_Estado_Devengado_Movimientos)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Generar_Nuevo_Detalle_Devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Devengado As String, ByVal Orden As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double)
        Select Case Codigo_Tipo_Documento_Devengar
            Case "08"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad, Sum(Cantidad * Costo) As Monto From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Orden & "' And Codigo_Tipo_Operacion ='07' And Numero_Documento='" & Devengado & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado(Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * Tipo_Cambio, Me.Determinar_Tipo_Recurso_Generando_Orden_Compra(Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")))
                    Next
                Else
                    Exit Sub
                End If
            Case "09"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad, Sum(Cantidad * Costo) As Monto From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Orden & "' And Codigo_Tipo_Operacion ='08' And Numero_Documento='" & Devengado & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado(Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * Tipo_Cambio, Me.Determinar_Tipo_Recurso_Generando_Orden_Compra(Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")))
                    Next
                Else
                    Exit Sub
                End If
        End Select
    End Sub
    Public Sub Generar_Nuevo_Detalle_Devengado_2(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Devengado As String, ByVal Numero As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double, Optional ByVal Codigo_Tipo_Caja As String = Nothing, Optional ByVal Codigo_Unidad_Organica As String = Nothing)
        Select Case Codigo_Tipo_Documento_Devengar
            Case "22"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='39' And  Numero_Documento='" & Devengado & "'  Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado(Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                    Next
                Else
                    Exit Sub
                End If
            Case "23"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='40' And  Numero_Documento='" & Devengado & "'  Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado(Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                    Next
                Else
                    Exit Sub
                End If
            Case "19"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Planilla_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='33' And  Numero_Documento='" & Devengado & "'  Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado(Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                    Next
                Else
                    Exit Sub
                End If
            Case "31"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Pagos_Varios_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='44' And  Numero_Documento='" & Devengado & "'  Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado(Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                    Next
                Else
                    Exit Sub
                End If
            Case "34"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Encargo_Interno_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='53' And  Numero_Documento='" & Devengado & "'  Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado(Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                    Next
                Else
                    Exit Sub
                End If
            Case "41"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Contrato_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='62' And  Numero_Documento='" & Devengado & "'  Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado(Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                    Next
                Else
                    Exit Sub
                End If
        End Select
    End Sub
    Public Sub Generar_Nuevo_Detalle_Devengado_Movimientos(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Devengado As String, ByVal Orden As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double, ByVal Codigo_Tipo_Documento As String)
        Select Case Codigo_Tipo_Documento_Devengar
            Case "08"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad, Sum(Cantidad * Costo) As Monto From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Orden & "' And Codigo_Tipo_Operacion ='07' And Numero_Documento='" & Devengado & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Devengado)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "07", Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * Tipo_Cambio, "12", Orden, "01", Me.Determinar_Tipo_Recurso_Generando_Orden_Compra(Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")), Certificado)
                    Next
                Else
                    Exit Sub
                End If
            Case "09"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad, Sum(Cantidad * Costo) As Monto From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Orden & "' And Codigo_Tipo_Operacion ='08' And Numero_Documento='" & Devengado & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Devengado)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "08", Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * Tipo_Cambio, "13", Orden, "01", Me.Determinar_Tipo_Recurso_Generando_Orden_Servicio(Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")), Certificado)
                    Next
                Else
                    Exit Sub
                End If
        End Select
    End Sub
    Public Sub Generar_Nuevo_Detalle_Devengado_Movimientos_2(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Devengado As String, ByVal Numero As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double, ByVal Codigo_Tipo_Documento As String)
        Select Case Codigo_Tipo_Documento_Devengar
            Case "22"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='39' And  Numero_Documento='" & Devengado & "'  Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Devengado)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "39", Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), "15", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Certificado)
                    Next
                Else
                    Exit Sub
                End If
            Case "23"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='40' And  Numero_Documento='" & Devengado & "'  Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Devengado)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "40", Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), "15", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Certificado)
                    Next
                Else
                    Exit Sub
                End If
            Case "19"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Planilla_Movimientos  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='33' And Numero_Documento='" & Devengado & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Devengado)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "33", Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), "20", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Certificado)
                    Next
                Else
                    Exit Sub
                End If
            Case "31"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Abs(Monto)) As Monto From Detalle_Pagos_Varios_Movimientos  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='44' And Numero_Documento='" & Devengado & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Devengado)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "44", Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), "31", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Certificado)
                    Next
                Else
                    Exit Sub
                End If
            Case "34"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Abs(Monto)) As Monto From Detalle_Encargo_Interno_Movimientos  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='53' And Numero_Documento='" & Devengado & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Devengado)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "53", Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), "34", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Certificado)
                    Next
                Else
                    Exit Sub
                End If
            Case "41"
                Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Abs(Monto)) As Monto From Detalle_Contrato_Movimientos  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion ='62' And Numero_Documento='" & Devengado & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Devengado)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "62", Año_Ejecucion, Devengado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Math.Abs(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)), "31", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Certificado)
                    Next
                Else
                    Exit Sub
                End If
        End Select
    End Sub
    Public Sub Autorizar_Devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Select Case Codigo_Tipo_Documento_Devengar
            Case "08"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Compra_Movimientos Set Codigo_Estado_Orden_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='07'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Servicio_Movimientos Set Codigo_Estado_Orden_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='08'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='39'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "23"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='40'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Planilla_Movimientos Set Codigo_Estado_Planilla_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='33'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Codigo_Estado_Pagos_Varios_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='44'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Encargo_Interno_Movimientos Set Codigo_Estado_Encargo_Interno_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='53'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "41"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Contrato_Movimientos Set Codigo_Estado_Contrato_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Aprobar_Devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Select Case Codigo_Tipo_Documento_Devengar
            Case "08"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Compra_Movimientos Set Codigo_Estado_Orden_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='07'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Servicio_Movimientos Set Codigo_Estado_Orden_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='08'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='39'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "23"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='40'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Planilla_Movimientos Set Codigo_Estado_Planilla_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='33'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Codigo_Estado_Pagos_Varios_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='44'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Encargo_Interno_Movimientos Set Codigo_Estado_Encargo_Interno_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='53'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "41"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Contrato_Movimientos Set Codigo_Estado_Contrato_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Anular_Devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Select Case Codigo_Tipo_Documento_Devengar
            Case "08"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "17", Año_Ejecucion, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "12", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Me.Obtener_Numero_Certificado_Devengado(Año_Ejecucion, Numero))
                    Next
                End If
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Compra_Movimientos Set Codigo_Estado_Orden_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='07'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden Set Costo=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='25'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "18", Año_Ejecucion, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "13", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Me.Obtener_Numero_Certificado_Devengado(Año_Ejecucion, Numero))
                    Next
                End If
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Servicio_Movimientos Set Codigo_Estado_Orden_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='08'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden Set Costo=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='26'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "39", Año_Ejecucion, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "26", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Me.Obtener_Numero_Certificado_Devengado(Año_Ejecucion, Numero))
                    Next
                End If
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='39'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "23"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "40", Año_Ejecucion, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "27", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Me.Obtener_Numero_Certificado_Devengado(Año_Ejecucion, Numero))
                    Next
                End If
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='40'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "36", Año_Ejecucion, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "15", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Me.Obtener_Numero_Certificado_Devengado(Año_Ejecucion, Numero))
                    Next
                End If
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Planilla_Movimientos Set Codigo_Estado_Planilla_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='36'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "48", Año_Ejecucion, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "31", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Me.Obtener_Numero_Certificado_Devengado(Año_Ejecucion, Numero))
                    Next
                End If
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Codigo_Estado_Pagos_Varios_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='44'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "57", Año_Ejecucion, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "34", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Me.Obtener_Numero_Certificado_Devengado(Año_Ejecucion, Numero))
                    Next
                End If
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Encargo_Interno_Movimientos Set Codigo_Estado_Encargo_Interno_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='53'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "41"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    Dim Correlativo As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo, "65", Año_Ejecucion, Numero, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "41", Numero, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString, Me.Obtener_Numero_Certificado_Devengado(Año_Ejecucion, Numero))
                    Next
                End If
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Contrato_Movimientos Set Codigo_Estado_Contrato_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Function Obtener_Numero_Certificado_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Obtener_Numero_Certificado_Devengado = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Obtener_Numero_Certificado_Devengado = Ds.Tables(0).Rows(0).Item("Certificado").ToString
        Else
            Obtener_Numero_Certificado_Devengado = ""
        End If
        Return Obtener_Numero_Certificado_Devengado
    End Function
    Public Function Obtener_Numero_Orden_Devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Devengado As String)
        Obtener_Numero_Orden_Devengado = ""
        Select Case Codigo_Tipo_Documento_Devengar
            Case "08"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Codigo_Tipo_Documento='08' And Numero='" & Devengado & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Obtener_Numero_Orden_Devengado = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString
                Else
                    Obtener_Numero_Orden_Devengado = String.Empty
                End If
            Case "09"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Codigo_Tipo_Documento='09' And Numero='" & Devengado & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Obtener_Numero_Orden_Devengado = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString
                Else
                    Obtener_Numero_Orden_Devengado = String.Empty
                End If
        End Select
        Return Obtener_Numero_Orden_Devengado
    End Function
    Public Function Obtener_Numero_Documento_Devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Devengado As String)
        Obtener_Numero_Documento_Devengado = ""
        Select Case Codigo_Tipo_Documento_Devengar
            Case "22"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Codigo_Tipo_Documento='22' And Numero='" & Devengado & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Obtener_Numero_Documento_Devengado = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString
                Else
                    Obtener_Numero_Documento_Devengado = String.Empty
                End If
            Case "23"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Codigo_Tipo_Documento='23' And Numero='" & Devengado & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Obtener_Numero_Documento_Devengado = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString
                Else
                    Obtener_Numero_Documento_Devengado = String.Empty
                End If
            Case "19"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Codigo_Tipo_Documento='19' And Numero='" & Devengado & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Obtener_Numero_Documento_Devengado = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString
                Else
                    Obtener_Numero_Documento_Devengado = String.Empty
                End If
            Case "31"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Codigo_Tipo_Documento='31' And Numero='" & Devengado & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Obtener_Numero_Documento_Devengado = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString
                Else
                    Obtener_Numero_Documento_Devengado = String.Empty
                End If
            Case "34"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Codigo_Tipo_Documento='34' And Numero='" & Devengado & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Obtener_Numero_Documento_Devengado = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString
                Else
                    Obtener_Numero_Documento_Devengado = String.Empty
                End If
        End Select
        Return Obtener_Numero_Documento_Devengado
    End Function
    Public Sub Cargar_Datos_Basicos_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Combo_Tipo_Comprobante As System.Windows.Forms.ComboBox, ByVal Caja_Serie As System.Windows.Forms.TextBox, ByVal Caja_Numero As System.Windows.Forms.TextBox, ByVal Caja_Notas As System.Windows.Forms.TextBox, ByVal Fechador As System.Windows.Forms.DateTimePicker)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Consulta As String = ""
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Caja_Serie Is System.Windows.Forms.TextBox Then Caja_Serie.Text = Ds.Tables(0).Rows(0).Item("Serie_Comprobante").ToString
            If TypeOf Caja_Numero Is System.Windows.Forms.TextBox Then Caja_Numero.Text = Ds.Tables(0).Rows(0).Item("Numero_Comprobante").ToString
            If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
            If TypeOf Fechador Is System.Windows.Forms.DateTimePicker Then Fechador.Value = Ds.Tables(0).Rows(0).Item("Fecha_Emision_Comprobante")
            Consulta = "Select * From Lista_Tipo_Comprobantes Where Codigo_Comprobante='" & Ds.Tables(0).Rows(0).Item("Codigo_Comprobante").ToString & "'"
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter(Consulta, Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Combo_Tipo_Comprobante Is System.Windows.Forms.ComboBox Then Combo_Tipo_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Comprobante").ToString
        End If
    End Sub
    Public Sub Extornar_Devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Numero As String)
        Select Case Codigo_Tipo_Documento_Devengar
            Case "08"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Compra_Movimientos Set Codigo_Estado_Orden_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='07'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion In ('29') And Codigo_Documento In ('16')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Orden_Servicio_Movimientos Set Codigo_Estado_Orden_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='08'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion In ('30') And Codigo_Documento In ('17')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='39'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion In ('39') And Codigo_Documento In ('22')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "23"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='40'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion In ('40') And Codigo_Documento In ('23')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Planilla_Movimientos Set Codigo_Estado_Planilla_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='33'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion In ('34') And Codigo_Documento In ('21')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Codigo_Estado_Pagos_Varios_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='44'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion In ('44') And Codigo_Documento In ('33')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Encargo_Interno_Movimientos Set Codigo_Estado_Encargo_Interno_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='53'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion In ('53') And Codigo_Documento In ('36')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "41"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Devengado Set Codigo_Estado_Devengado='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Contrato_Movimientos Set Codigo_Estado_Contrato_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion In ('62') And Codigo_Documento In ('42')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Asiento As DevComponents.DotNetBar.ButtonItem, ByVal Liberar As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem, ByVal Rebajar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Devengado").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Asiento.Enabled = False
                    Liberar.Enabled = False
                    Reenumerar.Enabled = True
                    Rebajar.Enabled = False
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Asiento.Enabled = False
                    Liberar.Enabled = False
                    Reenumerar.Enabled = False
                    Rebajar.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                    Select Case Ds.Tables(0).Rows(0).Item("Asiento").ToString
                        Case "SI"
                            Asiento.Enabled = False
                            Liberar.Enabled = True
                            Extornar.Enabled = False
                        Case "NO"
                            Asiento.Enabled = True
                            Liberar.Enabled = False
                            Extornar.Enabled = True
                    End Select

                    Dim Saldo As Double = 0
                    For Recorrido As Integer = 0 To Listar_Devengados_Detalle_Saldos_X_Rebajar(Año_Ejecucion, Numero).Tables(0).Rows.Count - 1
                        Saldo = Saldo + Convert.ToDouble(Listar_Devengados_Detalle_Saldos_X_Rebajar(Año_Ejecucion, Numero).Tables(0).Rows(Recorrido).Item("Saldo").ToString)
                    Next
                    If Saldo > 0 Then
                        Rebajar.Enabled = True
                    Else
                        Rebajar.Enabled = False
                    End If
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Asiento.Enabled = False
                    Liberar.Enabled = False
                    Reenumerar.Enabled = False
                    Rebajar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Asiento.Enabled = False
                    Liberar.Enabled = False
                    Reenumerar.Enabled = False
                    Rebajar.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Generar_Numero_Compromiso(ByVal Año_Ejecucion As String, ByVal Caja_Numero As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Expediente)+1),1) As Numero From Expediente Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Expediente As String = ""
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Expediente = Right("00000" & Numero.ToString, 5)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Insert Into Expediente(Año_Ejecucion,Expediente,FechaCreacion,Codigo_Tipo_Documento,Codigo_Proveedor) Values ('" & Año_Ejecucion & "','" & Right("00000" & Numero.ToString, 5) & "',GetDate(),'99','00000')"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Caja_Numero.Text = Right("00000" & Numero.ToString, 5)
    End Sub
    Public Sub Modificar_Compromiso(ByVal Año_Ejecucion As String, ByVal Expediente As String, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String, ByVal FechaEmisionDocumento As Date, ByVal Monto As Double, ByVal Codigo_Proveedor As String, Optional ByVal Codigo_Tipo_Caja As String = Nothing, Optional ByVal Codigo_Unidad_Organica As String = Nothing, Optional ByVal Numero_Rendicion As Integer = Nothing)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Expediente"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Expediente", Expediente)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@FechaEmisionDocumento", FechaEmisionDocumento)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Select Case Codigo_Tipo_Documento
            Case "08"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Orden_Compra Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Orden_Compra Set Expediente='" & Expediente & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Orden_Servicio Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Orden_Servicio Set Expediente='" & Expediente & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Planilla Set Compromiso=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Compromiso='" & Expediente & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Planilla Set Compromiso='" & Expediente & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22", "23"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Caja_Chica_SBLM Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Caja_Chica_SBLM Set Expediente='" & Expediente & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Pagos_Varios Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Pagos_Varios Set Expediente='" & Expediente & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Encargo_Interno Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Encargo_Interno Set Expediente='" & Expediente & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "41"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Contrato Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Contrato Set Expediente='" & Expediente & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Liberar_Compromiso(ByVal Año_Ejecucion As String, ByVal Expediente As String, ByVal Codigo_Tipo_Documento As String)
        If Me.Evaluar_Presencia_Expediente_Devengado(Año_Ejecucion, Expediente) = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Update Expediente Set Codigo_Tipo_Documento='99',Numero_Documento=Null,FechaEmisionDocumento=Null,Monto=Null,Codigo_Proveedor='00000' Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Select Case Codigo_Tipo_Documento
                Case "08"
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Orden_Compra Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "09"
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Orden_Servicio Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "19"
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Planilla Set Compromiso=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Compromiso='" & Expediente & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "22", "23"
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Caja_Chica_SBLM Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "31"
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Pagos_Varios Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "34"
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Encargo_Interno Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "41"
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Contrato Set Expediente=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
            End Select
        Else
            MessageBox.Show("El Numero de Expediente tiene 1 o mas registros de Devengado, No se puede Liberar", "..:: Liberar Compromisos ::..", MessageBoxButtons.OK, MessageBoxIcon.Information)
            Exit Sub
        End If
    End Sub
    Public Function Evaluar_Presencia_Expediente_Devengado(ByVal Año_Ejecucion As String, ByVal Expediente As String) As Boolean
        Evaluar_Presencia_Expediente_Devengado = True
        If Evaluar_Presencia_Expediente_Devengado = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Compromiso ='" & Expediente & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Evaluar_Presencia_Expediente_Devengado = False
            End If
        End If
        Return Evaluar_Presencia_Expediente_Devengado
    End Function
    Public Function Verificar_Liberacion_Compromiso(ByVal Año_Ejecucion As String, ByVal Expediente As String, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String) As Boolean
        Verificar_Liberacion_Compromiso = True
        If Verificar_Liberacion_Compromiso = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Compromiso='" & Expediente & "' And Codigo_Tipo_Documento='" & Codigo_Tipo_Documento & "' And Numero_Documento='" & Numero_Documento & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Verificar_Liberacion_Compromiso = False
            End If
        End If
        Return Verificar_Liberacion_Compromiso
    End Function
    Public Sub Mostrar_Data_Basica_Compromiso(ByVal Año_Ejecucion As String, ByVal Tipo_Documento As String, ByVal Numero_Documento As String, ByVal Caja_Numero_Documento As System.Windows.Forms.TextBox, ByVal Caja_Fecha As System.Windows.Forms.TextBox, ByVal Caja_Certificado As System.Windows.Forms.TextBox, ByVal Caja_Monto As System.Windows.Forms.TextBox, ByVal Caja_RUC As System.Windows.Forms.TextBox, ByVal Caja_Razon_Social As System.Windows.Forms.TextBox, ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox, Optional ByVal Codigo_Tipo_Caja As String = Nothing, Optional ByVal Codigo_Unidad_Organica As String = Nothing, Optional ByVal Numero_Rendicion As Integer = Nothing)
        Select Case Tipo_Documento
            Case "08"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Compra_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Numero_Documento.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
                    Caja_Fecha.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                    Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                    Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
                    Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("Ruc_Proveedor").ToString
                    Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "09"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Ordenes_Servicio_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Numero_Documento.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
                    Caja_Fecha.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                    Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                    Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
                    Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("Ruc_Proveedor").ToString
                    Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
                'Case "14"
                '    Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Basica_Caja_Chica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'", Cn)
                '    Dim Ds As New Data.DataSet
                '    Da.Fill(Ds)
                '    If Ds.Tables(0).Rows.Count > 0 Then
                '        Caja_Numero_Documento.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
                '        Caja_Fecha.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaApertura").ToString)
                '        Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                '        Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                '        Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("Ruc_Proveedor").ToString
                '        Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                '        Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                '    End If
            Case "19"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Planillas_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Numero_Documento.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
                    Caja_Fecha.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                    Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                    Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Planilla").ToString), "###,###,#.00")
                    Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("Ruc_Proveedor").ToString
                    Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "22"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion ='" & Numero_Rendicion & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Numero_Documento.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
                    Caja_Fecha.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaApertura").ToString)
                    Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                    Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("Ruc_Proveedor").ToString
                    Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "23"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Numero_Documento.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
                    Caja_Fecha.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaApertura").ToString)
                    Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                    Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("Ruc_Proveedor").ToString
                    Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "31"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Pagos_Varios_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Numero_Documento.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
                    Caja_Fecha.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                    Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                    Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("Ruc_Proveedor").ToString
                    Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "34"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Encargo_Interno_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Numero_Documento.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
                    Caja_Fecha.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                    Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                    Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("Ruc_Proveedor").ToString
                    Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "41"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Contratos_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Caja_Numero_Documento.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
                    Caja_Fecha.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
                    Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
                    Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("Ruc_Proveedor").ToString
                    Caja_Razon_Social.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
        End Select
    End Sub
    Public Sub Exportar_Lista_Certificados(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "Documento"
            Excel.Application.Cells(1, "D") = "Justificación"
            Excel.Application.Cells(1, "E") = "Emisión"
            Excel.Application.Cells(1, "F") = "Autorización"
            Excel.Application.Cells(1, "G") = "Aprobacion"
            Excel.Application.Cells(1, "H") = "Monto"
            Excel.Application.Cells(1, "I") = "Rebajas"
            Excel.Application.Cells(1, "J") = "Ampliaciones"
            Excel.Application.Cells(1, "K") = "Compromisos"
            Excel.Application.Cells(1, "L") = "Saldo"
            Excel.Application.Cells(1, "M") = "Estado"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Cells(Recorrido + 2, "J") = DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Cells(Recorrido + 2, "K") = DataGridView.Rows(Recorrido).Cells(10).Value
                Excel.Application.Cells(Recorrido + 2, "L") = DataGridView.Rows(Recorrido).Cells(11).Value
                Excel.Application.Cells(Recorrido + 2, "M") = DataGridView.Rows(Recorrido).Cells(12).Value
                Excel.Application.Range("A" & Recorrido + 1, "M" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 40
            Hoja.Range("D1").ColumnWidth = 60
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("J1").ColumnWidth = 12
            Hoja.Range("K1").ColumnWidth = 12
            Hoja.Range("L1").ColumnWidth = 12
            Hoja.Range("M1").ColumnWidth = 12
            Hoja.Range("A1", "M1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "M" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("H2", "H" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("I2", "I" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("J2", "J" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("K2", "K" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("L2", "L" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE CERTIFICADOS"
            Hoja.Range("A" & Recorrido + 2, "M" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "M" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Lista_Previsiones(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "Documento"
            Excel.Application.Cells(1, "D") = "Justificación"
            Excel.Application.Cells(1, "E") = "Emisión"
            Excel.Application.Cells(1, "F") = "Autorización"
            Excel.Application.Cells(1, "G") = "Aprobacion"
            Excel.Application.Cells(1, "H") = "Monto"
            Excel.Application.Cells(1, "I") = "CCP"
            Excel.Application.Cells(1, "J") = "Estado"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = "'" & DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Cells(Recorrido + 2, "J") = DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Range("A" & Recorrido + 1, "J" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 40
            Hoja.Range("D1").ColumnWidth = 60
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("J1").ColumnWidth = 12
            Hoja.Range("A1", "J1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "J" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("H2", "H" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE PREVISIONES"
            Hoja.Range("A" & Recorrido + 2, "J" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "J" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Lista_Rebajas(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "Certificado"
            Excel.Application.Cells(1, "D") = "Justificación"
            Excel.Application.Cells(1, "E") = "Emisión"
            Excel.Application.Cells(1, "F") = "Autorización"
            Excel.Application.Cells(1, "G") = "Aprobacion"
            Excel.Application.Cells(1, "H") = "Monto"
            Excel.Application.Cells(1, "I") = "Estado"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Range("A" & Recorrido + 1, "I" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 10
            Hoja.Range("D1").ColumnWidth = 60
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("A1", "I1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "I" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("I2", "I" & Recorrido + 2).WrapText = True
            Hoja.Range("H2", "H" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE REBAJAS"
            Hoja.Range("A" & Recorrido + 2, "I" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "I" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Lista_Ampliaciones(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "Certificado"
            Excel.Application.Cells(1, "D") = "Justificación"
            Excel.Application.Cells(1, "E") = "Emisión"
            Excel.Application.Cells(1, "F") = "Autorización"
            Excel.Application.Cells(1, "G") = "Aprobacion"
            Excel.Application.Cells(1, "H") = "Monto"
            Excel.Application.Cells(1, "I") = "Estado"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Range("A" & Recorrido + 1, "I" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 10
            Hoja.Range("D1").ColumnWidth = 60
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("A1", "I1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "I" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("I2", "I" & Recorrido + 2).WrapText = True
            Hoja.Range("H2", "H" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE AMPLIACIONES"
            Hoja.Range("A" & Recorrido + 2, "I" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "I" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Lista_Giros(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "Notas"
            Excel.Application.Cells(1, "D") = "Emisión"
            Excel.Application.Cells(1, "E") = "Autorización"
            Excel.Application.Cells(1, "F") = "Aprobacion"
            Excel.Application.Cells(1, "G") = "Monto"
            Excel.Application.Cells(1, "H") = "Saldo"
            Excel.Application.Cells(1, "I") = "Comprobante"
            Excel.Application.Cells(1, "J") = "Documento"
            Excel.Application.Cells(1, "K") = "Num.Doc."
            Excel.Application.Cells(1, "L") = "Exp."
            Excel.Application.Cells(1, "M") = "RUC"
            Excel.Application.Cells(1, "N") = "Proveedor"
            Excel.Application.Cells(1, "O") = "Estado"
            Excel.Application.Cells(1, "P") = "Asiento"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Cells(Recorrido + 2, "J") = DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Cells(Recorrido + 2, "K") = DataGridView.Rows(Recorrido).Cells(10).Value
                Excel.Application.Cells(Recorrido + 2, "L") = DataGridView.Rows(Recorrido).Cells(11).Value
                Excel.Application.Cells(Recorrido + 2, "M") = DataGridView.Rows(Recorrido).Cells(12).Value
                Excel.Application.Cells(Recorrido + 2, "N") = DataGridView.Rows(Recorrido).Cells(13).Value
                Excel.Application.Cells(Recorrido + 2, "O") = DataGridView.Rows(Recorrido).Cells(14).Value
                Excel.Application.Cells(Recorrido + 2, "P") = DataGridView.Rows(Recorrido).Cells(15).Value
                Excel.Application.Range("A" & Recorrido + 1, "P" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 8
            Hoja.Range("C1").ColumnWidth = 80
            Hoja.Range("D1").ColumnWidth = 12
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("J1").ColumnWidth = 12
            Hoja.Range("K1").ColumnWidth = 10
            Hoja.Range("L1").ColumnWidth = 6
            Hoja.Range("M1").ColumnWidth = 12
            Hoja.Range("N1").ColumnWidth = 40
            Hoja.Range("O1").ColumnWidth = 12
            Hoja.Range("P1").ColumnWidth = 8
            Hoja.Range("A1", "P1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A1", "P1").HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("A2", "B" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("D2", "F" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("G2", "H" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlRight
            Hoja.Range("I2", "M" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("O2", "P" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("A2", "P" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("G2", "G" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("H2", "H" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE GIROS"
            Hoja.Range("A" & Recorrido + 2, "P" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "P" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Lista_Devengados(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "Notas"
            Excel.Application.Cells(1, "D") = "Emisión"
            Excel.Application.Cells(1, "E") = "Autorización"
            Excel.Application.Cells(1, "F") = "Aprobacion"
            Excel.Application.Cells(1, "G") = "Monto"
            Excel.Application.Cells(1, "H") = "Saldo"
            Excel.Application.Cells(1, "I") = "Tipo.Comp."
            Excel.Application.Cells(1, "J") = "Serie"
            Excel.Application.Cells(1, "K") = "Numero"
            Excel.Application.Cells(1, "L") = "Documento"
            Excel.Application.Cells(1, "M") = "Num.Doc."
            Excel.Application.Cells(1, "N") = "Exp."
            Excel.Application.Cells(1, "O") = "RUC"
            Excel.Application.Cells(1, "P") = "Proveedor"
            Excel.Application.Cells(1, "Q") = "Estado"
            Excel.Application.Cells(1, "R") = "Asiento"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Cells(Recorrido + 2, "J") = DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Cells(Recorrido + 2, "K") = DataGridView.Rows(Recorrido).Cells(10).Value
                Excel.Application.Cells(Recorrido + 2, "L") = DataGridView.Rows(Recorrido).Cells(11).Value
                Excel.Application.Cells(Recorrido + 2, "M") = DataGridView.Rows(Recorrido).Cells(12).Value
                Excel.Application.Cells(Recorrido + 2, "N") = DataGridView.Rows(Recorrido).Cells(13).Value
                Excel.Application.Cells(Recorrido + 2, "O") = DataGridView.Rows(Recorrido).Cells(14).Value
                Excel.Application.Cells(Recorrido + 2, "P") = DataGridView.Rows(Recorrido).Cells(15).Value
                Excel.Application.Cells(Recorrido + 2, "Q") = DataGridView.Rows(Recorrido).Cells(16).Value
                Excel.Application.Cells(Recorrido + 2, "R") = DataGridView.Rows(Recorrido).Cells(17).Value
                Excel.Application.Range("A" & Recorrido + 1, "R" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 8
            Hoja.Range("C1").ColumnWidth = 40
            Hoja.Range("D1").ColumnWidth = 12
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 15
            Hoja.Range("J1").ColumnWidth = 6
            Hoja.Range("K1").ColumnWidth = 20
            Hoja.Range("L1").ColumnWidth = 20
            Hoja.Range("M1").ColumnWidth = 10
            Hoja.Range("N1").ColumnWidth = 6
            Hoja.Range("O1").ColumnWidth = 12
            Hoja.Range("P1").ColumnWidth = 40
            Hoja.Range("Q1").ColumnWidth = 12
            Hoja.Range("R1").ColumnWidth = 8
            Hoja.Range("A1", "R1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A1", "R1").HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("A2", "B" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("D2", "F" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("G2", "H" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlRight
            Hoja.Range("I2", "L" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlLeft
            Hoja.Range("O2", "P" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlLeft
            Hoja.Range("A2", "P" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("R2", "R" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("G2", "G" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("H2", "H" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE DEVENGADOS"
            Hoja.Range("A" & Recorrido + 2, "R" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "R" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Cargar_Orden_Servicio_Distribucion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Distribucion_Orden_Servicio Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Mes").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Nombre_Mes").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
            Next
        End If
    End Sub
    Public Sub Exportar_Lista_Ordenes_Compra(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "RUC"
            Excel.Application.Cells(1, "D") = "Proveedor"
            Excel.Application.Cells(1, "E") = "Justificación"
            Excel.Application.Cells(1, "F") = "Emision"
            Excel.Application.Cells(1, "G") = "Autorización"
            Excel.Application.Cells(1, "H") = "Aprobacion"
            Excel.Application.Cells(1, "I") = "Total"
            Excel.Application.Cells(1, "J") = "Saldo"
            Excel.Application.Cells(1, "K") = "CCP"
            Excel.Application.Cells(1, "L") = "Estado"
            Excel.Application.Cells(1, "M") = "Usuario"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Cells(Recorrido + 2, "J") = DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Cells(Recorrido + 2, "K") = DataGridView.Rows(Recorrido).Cells(10).Value
                Excel.Application.Cells(Recorrido + 2, "L") = DataGridView.Rows(Recorrido).Cells(11).Value
                Excel.Application.Cells(Recorrido + 2, "M") = DataGridView.Rows(Recorrido).Cells(15).Value
                Excel.Application.Range("A" & Recorrido + 1, "M" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 13
            Hoja.Range("D1").ColumnWidth = 40
            Hoja.Range("E1").ColumnWidth = 60
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("J1").ColumnWidth = 12
            Hoja.Range("K1").ColumnWidth = 12
            Hoja.Range("L1").ColumnWidth = 12
            Hoja.Range("M1").ColumnWidth = 20
            Hoja.Range("A1", "M1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("E2", "E" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "M" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("I2", "I" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("J2", "J" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE ORDENES DE COMPRA"
            Hoja.Range("A" & Recorrido + 2, "M" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "M" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Lista_Ordenes_Servicio(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "RUC"
            Excel.Application.Cells(1, "D") = "Proveedor"
            Excel.Application.Cells(1, "E") = "Justificación"
            Excel.Application.Cells(1, "F") = "Emision"
            Excel.Application.Cells(1, "G") = "Autorización"
            Excel.Application.Cells(1, "H") = "Aprobacion"
            Excel.Application.Cells(1, "I") = "Total"
            Excel.Application.Cells(1, "J") = "Saldo"
            Excel.Application.Cells(1, "K") = "CCP"
            Excel.Application.Cells(1, "L") = "Estado"
            Excel.Application.Cells(1, "M") = "Usuario"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Cells(Recorrido + 2, "J") = DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Cells(Recorrido + 2, "K") = DataGridView.Rows(Recorrido).Cells(10).Value
                Excel.Application.Cells(Recorrido + 2, "L") = DataGridView.Rows(Recorrido).Cells(11).Value
                Excel.Application.Cells(Recorrido + 2, "M") = DataGridView.Rows(Recorrido).Cells(15).Value
                Excel.Application.Range("A" & Recorrido + 1, "M" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 13
            Hoja.Range("D1").ColumnWidth = 40
            Hoja.Range("E1").ColumnWidth = 60
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("J1").ColumnWidth = 12
            Hoja.Range("K1").ColumnWidth = 12
            Hoja.Range("L1").ColumnWidth = 12
            Hoja.Range("M1").ColumnWidth = 20
            Hoja.Range("A1", "M1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("E2", "E" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "M" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("I2", "I" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("J2", "J" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE ORDENES DE COMPRA"
            Hoja.Range("A" & Recorrido + 2, "M" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "M" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Function VerificaRuc(ByVal cad As String) As Boolean
        Dim Pos(11) As Long, i As Long, Valor As Long, valorB As Double
        VerificaRuc = True
        cad = Trim(cad)
        For i = 1 To 11
            Pos(i) = Val(Mid(cad, i, 1))
        Next i
        Valor = Pos(1) * 5 + Pos(2) * 4 + Pos(3) * 3 + Pos(4) * 2 +
        Pos(5) * 7 + Pos(6) * 6 + Pos(7) * 5 + Pos(8) * 4 +
        Pos(9) * 3 + Pos(10) * 2
        valorB = Valor / 11
        valorB = Int(valorB)
        Valor = Valor - (valorB * 11)
        Valor = 11 - Valor
        If Valor = 10 Then
            Valor = 0 ': VerificaRuc = False
        Else
            If Valor = 11 Then
                Valor = 1 ': VerificaRuc = False
            End If
        End If
        If Pos(11) <> Valor Then
            VerificaRuc = False
        End If
        Exit Function
    End Function
    Public Function Verificar_Duplicidad_RUC_Proveedor(ByVal RUC As String, ByVal Nuevo As Boolean, Optional ByVal ID As String = Nothing) As Boolean
        Verificar_Duplicidad_RUC_Proveedor = True
        If Verificar_Duplicidad_RUC_Proveedor = True Then
            Select Case Nuevo
                Case True
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Proveedor Where RUC_Proveedor='" & RUC.Trim & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Verificar_Duplicidad_RUC_Proveedor = False
                        Exit Function
                    Else
                        Return Verificar_Duplicidad_RUC_Proveedor
                        Exit Function
                    End If
                Case False
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Proveedor Where RUC_Proveedor='" & RUC.Trim & "' And Codigo_Proveedor <>'" & ID.Trim & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Verificar_Duplicidad_RUC_Proveedor = False
                        Exit Function
                    Else
                        Return Verificar_Duplicidad_RUC_Proveedor
                        Exit Function
                    End If
            End Select
        End If
        Return Verificar_Duplicidad_RUC_Proveedor
    End Function
    Public Function Verificar_Duplicidad_Usuario(ByVal Usuario As String, ByVal Nuevo As Boolean, Optional ByVal ID As String = Nothing) As Boolean
        Verificar_Duplicidad_Usuario = True
        If Verificar_Duplicidad_Usuario = True Then
            Select Case Nuevo
                Case True
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Usuario Where Usuario='" & Usuario.Trim & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Verificar_Duplicidad_Usuario = False
                        Exit Function
                    Else
                        Return Verificar_Duplicidad_Usuario
                        Exit Function
                    End If
                Case False
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Usuario Where Usuario='" & Usuario.Trim & "' And Codigo_Usuario <>'" & ID.Trim & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Verificar_Duplicidad_Usuario = False
                        Exit Function
                    Else
                        Return Verificar_Duplicidad_Usuario
                        Exit Function
                    End If
            End Select
        End If
        Return Verificar_Duplicidad_Usuario
    End Function
    Public Function Verificar_Duplicidad_Item(ByVal Tipo_Catalogo As String, ByVal Descripcion As String, ByVal Codigo_Unidad_Medida As Boolean, ByVal Clasificador As String) As Boolean
        Verificar_Duplicidad_Item = True
        If Verificar_Duplicidad_Item = True Then
            Select Case Tipo_Catalogo
                Case "01"
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Bienes Where Descripcion_Item='" & Descripcion.Trim & "' And Codigo_Unidad_Medida='" & Codigo_Unidad_Medida & "' And Clasificador='" & Clasificador & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Verificar_Duplicidad_Item = False
                        Exit Function
                    Else
                        Return Verificar_Duplicidad_Item
                        Exit Function
                    End If
                Case "02"
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Servicios Where Descripcion_Item='" & Descripcion.Trim & "' And Codigo_Unidad_Medida='" & Codigo_Unidad_Medida & "' And Clasificador='" & Clasificador & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Verificar_Duplicidad_Item = False
                        Exit Function
                    Else
                        Return Verificar_Duplicidad_Item
                        Exit Function
                    End If
            End Select

        End If
        Return Verificar_Duplicidad_Item
    End Function
    Public Sub Nueva_Prevision(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Documento As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Prevision As String, ByVal Monto As Double, ByVal Certificacion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Prevision"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Prevision", Codigo_Estado_Prevision)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificacion", Certificacion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Prevision(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Documento As String, ByVal Justificacion As String, ByVal Monto As Double, ByVal Certificacion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Prevision"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificacion", Certificacion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Prevision(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Periodo As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Codigo_Tipo_Recurso As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Prevision"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Periodo", Periodo)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Eliminar_Prevision(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Prevision Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Prevision Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Prevision Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Prevision(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Previsiones_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Prevision").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Reenumerar.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Pagos_Varios_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Pago").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Reenumerar.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Contratos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem, ByVal Compromiso As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Contratos_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Contrato").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = True
                    Compromiso.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                    Compromiso.Enabled = True
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                    Compromiso.Enabled = True
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                    Compromiso.Enabled = True
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Reenumerar.Enabled = False
                    Compromiso.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Certificar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Rendiciones_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Rendicion").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Certificar.Enabled = False
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Certificar.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    If Ds.Tables(0).Rows(0).Item("CE").ToString = "NO" Then
                        Certificar.Enabled = True
                    Else
                        Certificar.Enabled = False
                    End If
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Certificar.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Certificar.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Nuevo_Procedimiento(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero As String, ByVal Nombre As String, ByVal Siglas As String, ByVal Monto As Double, ByVal Observaciones As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Procedimiento"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Proceso", Codigo_Tipo_Proceso)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Nombre", Nombre)
        Cm.Parameters.AddWithValue("@Siglas", Siglas)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Observaciones", Observaciones)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Procedimiento_Contrato(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero As String, ByVal Numero_Contrato As String, ByVal Año_Contrato As String, ByVal Siglas As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Proceso_Contrato"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Proceso", Codigo_Tipo_Proceso)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Numero_Contrato", Numero_Contrato)
        Cm.Parameters.AddWithValue("@Año_Contrato", Año_Contrato)
        Cm.Parameters.AddWithValue("@Siglas", Siglas)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Procedimiento(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero As String, ByVal Nombre As String, ByVal Siglas As String, ByVal Monto As Double, ByVal Observaciones As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Procedimiento"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Proceso", Codigo_Tipo_Proceso)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Nombre", Nombre)
        Cm.Parameters.AddWithValue("@Siglas", Siglas)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Observaciones", Observaciones)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Eliminar_Contratos(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Procesos_Contratos Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Proceso='" & Codigo_Tipo_Proceso & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Verificar_Procedimiento(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero As String)
        Verificar_Procedimiento = True
        If Verificar_Procedimiento = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Procesos Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Proceso='" & Codigo_Tipo_Proceso & "' And Numero='" & Numero & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Verificar_Procedimiento = False
            Else
                Verificar_Procedimiento = True
            End If
        End If
        Return Verificar_Procedimiento
    End Function
    Public Sub Cargar_Data_Procedimientos_Modificacion(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Proceso As String, ByVal Numero As String, ByVal Combo_Tipo_Proceso As System.Windows.Forms.ComboBox, ByVal Combo_Año_Ejecucion As System.Windows.Forms.ComboBox, ByVal Caja_Numero_Proceso As System.Windows.Forms.TextBox, ByVal Caja_Siglas As System.Windows.Forms.TextBox, ByVal Caja_Nombre As System.Windows.Forms.TextBox, ByVal Caja_Observaciones As System.Windows.Forms.TextBox, ByVal Caja_Monto As System.Windows.Forms.TextBox, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Contratos_Reporte Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Proceso='" & Codigo_Tipo_Proceso & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Combo_Tipo_Proceso.Text = Ds.Tables(0).Rows(0).Item("Tipo_Proceso_2").ToString
            Combo_Año_Ejecucion.Text = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Numero_Proceso.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
            Caja_Siglas.Text = Ds.Tables(0).Rows(0).Item("SIGLAS").ToString
            Caja_Nombre.Text = Ds.Tables(0).Rows(0).Item("Nombre").ToString
            Caja_Observaciones.Text = Ds.Tables(0).Rows(0).Item("Observaciones").ToString
            Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Proceso").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Numero").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Numero_Contrato").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Año_Contrato").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Siglas_Contrato").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Contrato").ToString), "###,###,#.00")
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Contrato_1").ToString
            Next
        End If
    End Sub
    Public Sub Genererar_Reporte_PIM(ByVal Cadena_1 As String, ByVal Cadena_2 As String)
        Dim Da As New OleDb.OleDbDataAdapter(Cadena_1, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)

        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Tabla_Temporal_PIM_Mensualizado"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Tabla_Temporal_PIM_Mensualizado(Año_Ejecucion,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Monto) Values('" & Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Generica") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Especifica") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad") & "','" & Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Credito")) + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Anulacion")) & "')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Next
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter(Cadena_2, Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Tabla_Temporal_PIM_Mensualizado(Año_Ejecucion,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Monto) Values('" & Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Generica") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Especifica") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad") & "','" & Ds.Tables(0).Rows(Recorrido).Item("Monto") & "')"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Next
        End If
    End Sub
    Public Sub Cargar_Datos_Cuenta(ByVal Cuenta As String, ByVal Caja_Cuenta As System.Windows.Forms.TextBox, ByVal Caja_Nombre_Cuenta As System.Windows.Forms.TextBox, ByVal Caja_Clasificador As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From LIsta_Cuentas_Basica Where Cuenta='" & Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Cuenta.Text = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Caja_Nombre_Cuenta.Text = Ds.Tables(0).Rows(0).Item("Nombre").ToString
            Caja_Clasificador.Text = Ds.Tables(0).Rows(0).Item("Clasificador").ToString
        End If
    End Sub
    Public Sub Mostrar_Datos_Devengado_Asiento(ByVal Operacion As Integer, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Fecha_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Estado_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox, ByVal Caja_Numero_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Moneda As System.Windows.Forms.TextBox, ByVal Caja_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Serie_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Numero_Comprobante As System.Windows.Forms.TextBox, Optional ByVal DataGridView As System.Windows.Forms.DataGridView = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Fecha_Devengado.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            Caja_Estado_Devengado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Devengado").ToString
            Caja_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Documento").ToString
            Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Numero_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
            Caja_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Abreviatura").ToString
            Caja_Serie_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Serie_Comprobante").ToString
            Caja_Numero_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Numero_Comprobante").ToString
            Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString & " - " & Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
        End If
        Dim Cadena As String = ""

        For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            Cadena = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & "',"
        Next
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Select Case Operacion
            Case 1
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador,Sum(Monto) As Monto from Lista_Devengados_Activos_Detalle_Final_OC Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
            Case 2
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Devengados_Activos_Detalle_Final_OS Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
        End Select
    End Sub
    Public Sub Mostrar_Datos_Devengado_Rebajas(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Fecha_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Estado_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox, ByVal Caja_Numero_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Moneda As System.Windows.Forms.TextBox, ByVal Caja_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Serie_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Numero_Comprobante As System.Windows.Forms.TextBox, Optional ByVal DataGridView As System.Windows.Forms.DataGridView = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Fecha_Devengado.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            Caja_Estado_Devengado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Devengado").ToString
            Caja_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Documento").ToString
            Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Numero_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
            Caja_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Nombre_Comprobante").ToString
            Caja_Serie_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Serie_Comprobante").ToString
            Caja_Numero_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Numero_Comprobante").ToString
            Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString & " - " & Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
        End If
    End Sub
    Public Sub Mostrar_Datos_Devengado_Asiento_2(ByVal Operacion As Integer, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Fecha_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Estado_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox, ByVal Caja_Numero_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Moneda As System.Windows.Forms.TextBox, ByVal Caja_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Serie_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Numero_Comprobante As System.Windows.Forms.TextBox, Optional ByVal DataGridView As System.Windows.Forms.DataGridView = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Fecha_Devengado.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            Caja_Estado_Devengado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Devengado").ToString
            Caja_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Documento").ToString
            Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Numero_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
            Caja_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Abreviatura").ToString
            Caja_Serie_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Serie_Comprobante").ToString
            Caja_Numero_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Numero_Comprobante").ToString
            Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString & " - " & Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
        End If
        Dim Cadena As String = ""

        For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            Cadena = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & "',"
        Next
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Select Case Operacion
            Case 1
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador,Sum(Monto) As Monto from Lista_Devengados_Activos_Detalle_Final_CC Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
            Case 2
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Devengados_Activos_Detalle_Final_CCC Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
        End Select
    End Sub
    Public Sub Mostrar_Datos_Devengado_Asiento_3(ByVal Operacion As Integer, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Fecha_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Estado_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox, ByVal Caja_Numero_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Moneda As System.Windows.Forms.TextBox, ByVal Caja_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Serie_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Numero_Comprobante As System.Windows.Forms.TextBox, Optional ByVal DataGridView As System.Windows.Forms.DataGridView = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Fecha_Devengado.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            Caja_Estado_Devengado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Devengado").ToString
            Caja_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Documento").ToString
            Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Numero_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
            Caja_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Abreviatura").ToString
            Caja_Serie_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Serie_Comprobante").ToString
            Caja_Numero_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Numero_Comprobante").ToString
            Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString & " - " & Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
        End If
        Dim Cadena As String = ""

        For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            Cadena = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & "',"
        Next
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Select Case Operacion
            Case 1
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Devengados_Activos_Detalle_Final_PV Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
        End Select
    End Sub
    Public Sub Mostrar_Datos_Devengado_Asiento_4(ByVal Operacion As Integer, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Fecha_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Estado_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox, ByVal Caja_Numero_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Moneda As System.Windows.Forms.TextBox, ByVal Caja_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Serie_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Numero_Comprobante As System.Windows.Forms.TextBox, Optional ByVal DataGridView As System.Windows.Forms.DataGridView = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Fecha_Devengado.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            Caja_Estado_Devengado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Devengado").ToString
            Caja_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Documento").ToString
            Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Numero_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
            Caja_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Abreviatura").ToString
            Caja_Serie_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Serie_Comprobante").ToString
            Caja_Numero_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Numero_Comprobante").ToString
            Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString & " - " & Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
        End If
        Dim Cadena As String = ""

        For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            Cadena = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & "',"
        Next
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Select Case Operacion
            Case 1
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Devengados_Activos_Detalle_Final_EI Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
        End Select
    End Sub
    Public Sub Mostrar_Datos_Devengado_Asiento_5(ByVal Operacion As Integer, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Fecha_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Estado_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox, ByVal Caja_Numero_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Moneda As System.Windows.Forms.TextBox, ByVal Caja_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Serie_Comprobante As System.Windows.Forms.TextBox, ByVal Caja_Numero_Comprobante As System.Windows.Forms.TextBox, Optional ByVal DataGridView As System.Windows.Forms.DataGridView = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Fecha_Devengado.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            Caja_Estado_Devengado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Devengado").ToString
            Caja_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Documento").ToString
            Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Numero_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
            Caja_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Abreviatura").ToString
            Caja_Serie_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Serie_Comprobante").ToString
            Caja_Numero_Comprobante.Text = Ds.Tables(0).Rows(0).Item("Numero_Comprobante").ToString
            Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString & " - " & Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
        End If
        Dim Cadena As String = ""

        For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            Cadena = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & "',"
        Next
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Select Case Operacion
            Case 1
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Devengados_Activos_Detalle_Final_Contrato Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
        End Select
    End Sub
    Public Sub Mostrar_Datos_Girado_Asiento(ByVal Operacion As Integer, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Girado As System.Windows.Forms.TextBox, ByVal Caja_Fecha_Girado As System.Windows.Forms.TextBox, ByVal Caja_Estado_Girado As System.Windows.Forms.TextBox, ByVal Caja_Documento_Girado As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox, ByVal Caja_Numero_Documento_Girado As System.Windows.Forms.TextBox, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Moneda As System.Windows.Forms.TextBox, ByVal Caja_Notas As System.Windows.Forms.TextBox, Optional ByVal DataGridView As System.Windows.Forms.DataGridView = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Girados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Girado.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Fecha_Girado.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            Caja_Estado_Girado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Giro").ToString
            Caja_Documento_Girado.Text = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Documento").ToString
            Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Numero_Documento_Girado.Text = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
            Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
            Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString & " - " & Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
        End If
        Dim Cadena As String = ""

        For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            Cadena = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & "',"
        Next
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Select Case Operacion
            Case 1
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador,Sum(Monto) As Monto from Lista_Girados_Activos_Detalle_Final_OC Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
            Case 2
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Girados_Activos_Detalle_Final_OS Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
            Case 3
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Girados_Activos_Detalle_Final_CC Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
            Case 4
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Girados_Activos_Detalle_Final_CCC Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
            Case 5
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Girados_Activos_Detalle_Final_PV Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
            Case 6
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Girados_Activos_Detalle_Final_EI Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
            Case 7
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("select Clasificador, Sum(Monto) As Monto from Lista_Girados_Activos_Detalle_Contrato_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador In(" & Cadena & ") Group By Clasificador", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                    Next
                End If
        End Select
    End Sub
    Public Sub Mostrar_Datos_Pagar_Giro(ByVal Operacion As Integer, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Girado As System.Windows.Forms.TextBox, ByVal Caja_Fecha_Girado As System.Windows.Forms.TextBox, ByVal Caja_Estado_Girado As System.Windows.Forms.TextBox, ByVal Caja_Documento_Girado As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox, ByVal Caja_Numero_Documento_Girado As System.Windows.Forms.TextBox, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Moneda As System.Windows.Forms.TextBox, ByVal Caja_Notas As System.Windows.Forms.TextBox, ByVal Caja_RUC As System.Windows.Forms.TextBox, ByVal Caja_Proveedor As System.Windows.Forms.TextBox, ByVal Caja_Tipo_Pago As System.Windows.Forms.TextBox, ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox, ByVal Caja_RUC_Proveedor As System.Windows.Forms.TextBox, ByVal Caja_Razon_Social_Proveedor As System.Windows.Forms.TextBox, ByVal Caja_Expediente As System.Windows.Forms.TextBox, ByVal Caja_Retencion As System.Windows.Forms.TextBox, ByVal Caja_Liquido_Pagar As System.Windows.Forms.TextBox, ByVal Check_Retenciones As System.Windows.Forms.CheckBox, ByVal Caja_Total_Girado As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Girado.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Fecha_Girado.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            Caja_Estado_Girado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Giro").ToString
            Caja_Documento_Girado.Text = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Documento").ToString
            Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Liquido_Pagar").ToString), "###,###,#.00")
            Caja_Numero_Documento_Girado.Text = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
            Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
            Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
            Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
            Caja_Tipo_Pago.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Tipo_Pago").ToString
            Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
            Caja_RUC_Proveedor.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
            Caja_Razon_Social_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
            Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Compromiso").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Check_Retenciones.Checked = Ds.Tables(0).Rows(0).Item("Retenciones")
            Caja_Total_Girado.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Total_Girado").ToString), "###,###,#.00")
            Caja_Retencion.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Deducciones").ToString), "###,###,#.00")
            Caja_Liquido_Pagar.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Liquido_Pagar").ToString), "###,###,#.00")
        End If
    End Sub
    Public Sub Cargar_Cuenta_Contable_Detalle_Lista_Cuentas(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Plan_Sub_Cuenta Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            DataGridView.Rows.Add()
            DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
            DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
        End If
    End Sub
    Public Sub Cargar_Cuenta_Contable_Detalle_DataGridView(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            DataGridView.Rows.Add()
            DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
    End Sub
    Public Sub Cargar_Cuentas_Debe_OC(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Cadena As String = ""


        If Año_Ejecucion < "2020" Then
            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '2101.010501','1503.05','1202.0902','2103.03','1301.9999'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'2103.010101','4502.020199'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '4011.01010501','3369.0108','1212.0902','4671.01','2524.9999'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'4212.0101','7599.0101020199'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_PV(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Cadena As String = ""


        If Año_Ejecucion < "2020" Then

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '2101.010501' "
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'2101.0102','2103.010101','2103.010102'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '4011.01010501' "
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'4017.02','4212.0101','4212.0102'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_EI(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Cadena As String = ""


        If Año_Ejecucion < "2020" Then
            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '2101.010501' "
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'2101.0102','2103.010102'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '4011.01010501' "
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'4017.02','4212.0102'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_Contrato(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Cadena As String = ""



        If Año_Ejecucion < "2020" Then
            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '2101.010501' "
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'2101.0102','2103.010102'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '4011.01010501' "
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'4017.02','4212.0102'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_PV_Adicional(ByVal Año_Ejecucion As String, ByVal Cuenta As String, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView, ByVal Operacion As Integer)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta ='" & Cuenta & "' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridViewDebe.Rows.Add()
                        DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                        DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                        DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                        DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                        DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                    Next
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta ='" & Cuenta & "' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridViewHaber.Rows.Add()
                        DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                        DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                        DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                        DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                        DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                    Next
                End If
        End Select
    End Sub
    Public Sub Cargar_Cuentas_Debe_EI_Adicional(ByVal Año_Ejecucion As String, ByVal Cuenta As String, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView, ByVal Operacion As Integer)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta ='" & Cuenta & "' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridViewDebe.Rows.Add()
                        DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                        DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                        DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                        DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                        DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                    Next
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta ='" & Cuenta & "' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridViewHaber.Rows.Add()
                        DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                        DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                        DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                        DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                        DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                    Next
                End If
        End Select
    End Sub
    Public Sub Cargar_Cuentas_Debe_CC(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Cadena As String = ""



        If Año_Ejecucion < "2020" Then
            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " 'Otros Que sean Necesarios'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'2103.010101','2103.010102'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " 'Otros Que sean Necesarios'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'4212.0101','4212.0102'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_OC_Giro(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView, ByVal Numero As String)
        Dim Cadena As String = ""
        Dim Cadena_FF As String = ""
        Dim Cadena_RB As String = ""

        Dim Codigo_Libro_Caja As String = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Codigo_FF,Codigo_Rubro From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet

        If Año_Ejecucion < "2020" Then
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena = Cadena & " '2101.010501','2103.010101'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1101' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('1202.0902','2103.03')Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena = Cadena & " '4011.01010501','4212.0101'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1011' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('1212.0902','4671.01')Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_PP_Giro(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView, ByVal Numero As String)
        Dim Cadena As String = ""
        Dim Cadena_FF As String = ""
        Dim Cadena_RB As String = ""

        Dim Codigo_Libro_Caja As String = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Codigo_FF,Codigo_Rubro From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)

        If Año_Ejecucion < "2020" Then
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena = Cadena & " '2101.010501','2103.010101','2103.010102','2103.990000.41'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1101' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('1202.0902','2103.03')Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena = Cadena & " '4011.01010501','4212.0101','4212.0102','4699.99090141'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1011' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('1212.0902','4671.01')Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_EI_Giro(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView, ByVal Numero As String)
        Dim Cadena As String = ""
        Dim Cadena_FF As String = ""
        Dim Cadena_RB As String = ""

        Dim Codigo_Libro_Caja As String = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Codigo_FF,Codigo_Rubro From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)

        If Año_Ejecucion < "2020" Then
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena = Cadena & " '2101.010501','2103.010102'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1101' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            'Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('1202.0902','2103.03')Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            'Ds = New Data.DataSet
            'Da.Fill(Ds)
            'If Ds.Tables(0).Rows.Count > 0 Then
            '    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            '        DataGridViewHaber.Rows.Add()
            '        DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
            '        DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
            '        DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
            '        DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
            '        DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            '    Next
            'End If

        Else

            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena = Cadena & " '4011.01010501','4212.0102'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1011' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            'Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('1202.0902','2103.03')Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            'Ds = New Data.DataSet
            'Da.Fill(Ds)
            'If Ds.Tables(0).Rows.Count > 0 Then
            '    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            '        DataGridViewHaber.Rows.Add()
            '        DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
            '        DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
            '        DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
            '        DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
            '        DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            '    Next
            'End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_OS_Giro(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView, ByVal Numero As String)
        Dim Cadena As String = ""
        Dim Cadena_FF As String = ""
        Dim Cadena_RB As String = ""

        Dim Codigo_Libro_Caja As String = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Codigo_FF,Codigo_Rubro From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)

        If Año_Ejecucion < "2020" Then
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena = Cadena & " '2101.010501','2103.010102','2103.990000.41'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1101' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('2101.0102','1202.0902','2103.03') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena = Cadena & " '4011.01010501','4212.0102','4699.99090141'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1011' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('4017.02','1212.0902','4671.01') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_CC_Giro(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView, ByVal Numero As String)
        Dim Cadena As String = ""
        Dim Cadena_FF As String = ""
        Dim Cadena_RB As String = ""
        Dim Cadena_UO As String = ""

        Dim Codigo_Libro_Caja As String = ""

        If Año_Ejecucion < "2020" Then


            Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Codigo_FF,Codigo_Rubro,Codigo_Unidad_Organica From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                    Cadena_UO = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena_UO = Microsoft.VisualBasic.Left(Cadena_UO, Cadena_UO.Trim.Length - 1)
            Cadena = Cadena & "'0.0.0.0.0.0'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica In(" & Cadena_UO & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1101' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('0000') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Codigo_FF,Codigo_Rubro,Codigo_Unidad_Organica From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_RB = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                    Cadena_UO = Cadena & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_RB = Microsoft.VisualBasic.Left(Cadena_RB, Cadena_RB.Trim.Length - 1)
            Cadena_UO = Microsoft.VisualBasic.Left(Cadena_UO, Cadena_UO.Trim.Length - 1)
            Cadena = Cadena & "'0.0.0.0.0.0'"
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica In(" & Cadena_UO & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Select Case Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
                    Case "01"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja_2").ToString.Trim
                    Case "02"
                        Codigo_Libro_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Libro_Caja").ToString.Trim
                End Select
            End If
            Ds = Nothing
            Da = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In(" & Cadena_RB & ") And Mayor='1011' And Cuenta In('" & Codigo_Libro_Caja & "') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta IN('0000') Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_OC_Orden(ByVal Año_Ejecucion As String, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Cadena As String = ""


        If Año_Ejecucion < "2020" Then

            Cadena = Cadena & " '9101.08'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'9102.08'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            Cadena = Cadena & " '0101.08'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'0102.08'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_OS_Orden(ByVal Año_Ejecucion As String, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Cadena As String = ""


        If Año_Ejecucion < "2020" Then
            Cadena = Cadena & " '9101.09'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'9102.09'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            Cadena = Cadena & " '0101.09'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'0102.09'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_OC_Presupuestal(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso,Sum(Monto) As Monto from Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'  Group By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
        Dim Ds As New Data.DataSet
        Dim Cadena_FF As String = ""
        Dim Cadena_Rubro As String = ""

        Da.Fill(Ds)

        If Año_Ejecucion < "2020" Then
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena_FF & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_Rubro = Cadena_Rubro & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_Rubro = Microsoft.VisualBasic.Left(Cadena_Rubro, Cadena_Rubro.Trim.Length - 1)
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='8401' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='8601' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena_FF & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_Rubro = Cadena_Rubro & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_Rubro = Microsoft.VisualBasic.Left(Cadena_Rubro, Cadena_Rubro.Trim.Length - 1)
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9401' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9601' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_PV_Presupuestal(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso,Sum(Monto) As Monto from Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'  Group By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
        Dim Ds As New Data.DataSet
        Dim Cadena_FF As String = ""
        Dim Cadena_Rubro As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cadena_FF = Cadena_FF & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                Cadena_Rubro = Cadena_Rubro & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
            Next
        End If
        Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
        Cadena_Rubro = Microsoft.VisualBasic.Left(Cadena_Rubro, Cadena_Rubro.Trim.Length - 1)
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9401' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridViewDebe.Rows.Add()
                DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9601' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridViewHaber.Rows.Add()
                DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuentas_Debe_EI_Presupuestal(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso,Sum(Monto) As Monto from Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'  Group By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
        Dim Ds As New Data.DataSet
        Dim Cadena_FF As String = ""
        Dim Cadena_Rubro As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cadena_FF = Cadena_FF & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                Cadena_Rubro = Cadena_Rubro & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
            Next
        End If
        Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
        Cadena_Rubro = Microsoft.VisualBasic.Left(Cadena_Rubro, Cadena_Rubro.Trim.Length - 1)
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9401' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridViewDebe.Rows.Add()
                DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9601' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridViewHaber.Rows.Add()
                DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuentas_Debe_Contrato_Presupuestal(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso,Sum(Monto) As Monto from Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'  Group By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
        Dim Ds As New Data.DataSet
        Dim Cadena_FF As String = ""
        Dim Cadena_Rubro As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Cadena_FF = Cadena_FF & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                Cadena_Rubro = Cadena_Rubro & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
            Next
        End If
        Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
        Cadena_Rubro = Microsoft.VisualBasic.Left(Cadena_Rubro, Cadena_Rubro.Trim.Length - 1)
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9401' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridViewDebe.Rows.Add()
                DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9601' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridViewHaber.Rows.Add()
                DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuentas_Debe_OS(ByVal Año_Ejecucion As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Cadena As String = ""


        If Año_Ejecucion < "2020" Then
            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '2101.010501','1202.0902','2103.03','5506.990000.01.06'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'2103.010102','2103.99','2101.0102','2103.990000.41','4502.020199'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
                Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(3).Value & "',"
            Next
            Cadena = Cadena & " '4011.01010501','1212.0902','4671.01','6599.9921'"
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Cadena = "'4212.0102','4699.99090113','4017.02','4699.99090141','7599.0101020199'"
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta In(" & Cadena & ") Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuentas_Debe_OS_Presupuestal(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridViewDebe As System.Windows.Forms.DataGridView, ByVal DataGridViewHaber As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Cadena_FF As String = ""
        Dim Cadena_Rubro As String = ""

        Da.Fill(Ds)

        If Año_Ejecucion < "2020" Then
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena_FF & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_Rubro = Cadena_Rubro & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_Rubro = Microsoft.VisualBasic.Left(Cadena_Rubro, Cadena_Rubro.Trim.Length - 1)
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='8401' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='8601' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        Else

            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    Cadena_FF = Cadena_FF & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "',"
                    Cadena_Rubro = Cadena_Rubro & "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "',"
                Next
            End If
            Cadena_FF = Microsoft.VisualBasic.Left(Cadena_FF, Cadena_FF.Trim.Length - 1)
            Cadena_Rubro = Microsoft.VisualBasic.Left(Cadena_Rubro, Cadena_Rubro.Trim.Length - 1)
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9401' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewDebe.Rows.Add()
                    DataGridViewDebe.Item(0, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewDebe.Item(1, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewDebe.Item(2, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewDebe.Item(3, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewDebe.Item(4, DataGridViewDebe.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_FF In(" & Cadena_FF & ") And Codigo_Rubro In (" & Cadena_Rubro & ") And Mayor='9601' Order By Año_Ejecucion,Mayor,Sub_Cuenta", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridViewHaber.Rows.Add()
                    DataGridViewHaber.Item(0, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridViewHaber.Item(1, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mayor").ToString
                    DataGridViewHaber.Item(2, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Cuenta").ToString
                    DataGridViewHaber.Item(3, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                    DataGridViewHaber.Item(4, DataGridViewHaber.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString & "." & Ds.Tables(0).Rows(0).Item("Mayor").ToString & "." & Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
                Next
            End If

        End If

    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Debe_Patrimonial(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""
        'Dim Var_Clasificador As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
            'Var_Clasificador = Ds.Tables(0).Rows(0).Item("Clasificador").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Debe_Patrimonial_CC(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas_Clasificador Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""
        Dim Var_Clasificador As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
            Var_Clasificador = Ds.Tables(0).Rows(0).Item("Clasificador").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Clasificador='" & Var_Clasificador & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Debe_Patrimonial_PV(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""
        'Dim Var_Clasificador As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
            'Var_Clasificador = Ds.Tables(0).Rows(0).Item("Clasificador").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Debe_Patrimonial_EI(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""
        'Dim Var_Clasificador As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
            'Var_Clasificador = Ds.Tables(0).Rows(0).Item("Clasificador").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Debe_Patrimonial_Contrato(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""
        'Dim Var_Clasificador As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
            'Var_Clasificador = Ds.Tables(0).Rows(0).Item("Clasificador").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Debe_Presupuestal(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Descripcion_Tipo_Recurso,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,[C.Costos],Sum(Monto) As Monto From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Descripcion_Tipo_Recurso,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,[C.Costos]", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Haber_Presupuestal(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Descripcion_Tipo_Recurso,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,[C.Costos],Sum(Monto) As Monto From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Descripcion_Tipo_Recurso,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,[C.Costos]", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = "0"
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Girado_Debe_Patrimonial(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Girados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Total_Girado").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Girado_Debe_Patrimonial_PV(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Girados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Total_Girado").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Girado_Debe_Patrimonial_EI(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Girados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Total_Girado").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Girado_Debe_Patrimonial_CC(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,FechaAnulacion,UsuarioAnulacion,Codigo_Estado_Giro,Descripcion_Estado_Giro,Monto_Total,Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,Tipo_Cambio,Codigo_Moneda,Fecha_Emision_Comprobante,Certificado,Codigo_FF,Codigo_Rubro,0 As Tipo_Transaccion,0 As Generica,0 As Sub_Generica,0 As Sub_Generica_Detalle,0 As Especifica,0 As Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Sum(Monto) As Monto,Codigo_Tipo_Recurso,Nombre_Unidad_Organica,[C.Costos],Descripcion_Tipo_Recurso,Cadena,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Operacion,Codigo_Tipo_Pago,Descripcion_Tipo_Pago,Fecha_Operacion From Lista_Detalle_Girados_Basica_Final Where Numero ='" & Numero & "' And Año_Ejecucion='" & Año_Ejecucion & "' Group By Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,FechaAnulacion,UsuarioAnulacion,Codigo_Estado_Giro,Descripcion_Estado_Giro,Monto_Total,Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,Tipo_Cambio,Codigo_Moneda,Fecha_Emision_Comprobante,Certificado,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso,Nombre_Unidad_Organica,[C.Costos],Descripcion_Tipo_Recurso,Cadena,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Operacion,Codigo_Tipo_Pago,Descripcion_Tipo_Pago,Fecha_Operacion", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Debe_Orden(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "D"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Haber_Patrimonial(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Haber_Patrimonial_CC_01(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" &
                                             Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" &
                                             Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,Codigo_Estado_Devengado,Descripcion_Estado_Devengado,Monto_Total,Codigo_Comprobante,Nombre_Comprobante,Abreviatura,Numero_Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,igv,Sub_Total,Porcentaje,Tipo_Cambio,Porcentaje_Renta,Tercero,Otros,Codigo_Moneda,Fecha_Emision_Comprobante,Check_IGV,Check_Renta,Certificado,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Sum(Monto) As Monto,Codigo_Tipo_Documento,[C.Costos],Clasificador,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Cadena,Comprobante,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Renta,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Codigo_Tipo_Recurso  From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Left(Clasificador,5) In ('2.3.1') Group By Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,Codigo_Estado_Devengado,Descripcion_Estado_Devengado,Monto_Total,Codigo_Comprobante,Nombre_Comprobante,Abreviatura,Numero_Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,igv,Sub_Total,Porcentaje,Tipo_Cambio,Porcentaje_Renta,Tercero,Otros,Codigo_Moneda,Fecha_Emision_Comprobante,Check_IGV,Check_Renta,Certificado,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Documento,[C.Costos],Clasificador,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Cadena,Comprobante,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Renta,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Codigo_Tipo_Recurso", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Haber_Patrimonial_PV(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Haber_Patrimonial_EI(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Haber_Patrimonial_Contrato(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Haber_Patrimonial_CC_02(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,Codigo_Estado_Devengado,Descripcion_Estado_Devengado,Monto_Total,Codigo_Comprobante,Nombre_Comprobante,Abreviatura,Numero_Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,igv,Sub_Total,Porcentaje,Tipo_Cambio,Porcentaje_Renta,Tercero,Otros,Codigo_Moneda,Fecha_Emision_Comprobante,Check_IGV,Check_Renta,Certificado,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Sum(Monto) As Monto,Codigo_Tipo_Documento,[C.Costos],Clasificador,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Cadena,Comprobante,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Renta,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Codigo_Tipo_Recurso  From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Left(Clasificador,5) In ('2.3.2') Group By Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,Codigo_Estado_Devengado,Descripcion_Estado_Devengado,Monto_Total,Codigo_Comprobante,Nombre_Comprobante,Abreviatura,Numero_Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,igv,Sub_Total,Porcentaje,Tipo_Cambio,Porcentaje_Renta,Tercero,Otros,Codigo_Moneda,Fecha_Emision_Comprobante,Check_IGV,Check_Renta,Certificado,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Documento,[C.Costos],Clasificador,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Cadena,Comprobante,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Renta,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Codigo_Tipo_Recurso", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Haber_Patrimonial_CC_00(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,Codigo_Estado_Devengado,Descripcion_Estado_Devengado,Monto_Total,Codigo_Comprobante,Nombre_Comprobante,Abreviatura,Numero_Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,igv,Sub_Total,Porcentaje,Tipo_Cambio,Porcentaje_Renta,Tercero,Otros,Codigo_Moneda,Fecha_Emision_Comprobante,Check_IGV,Check_Renta,Certificado,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Sum(Monto) As Monto,Codigo_Tipo_Documento,[C.Costos],Clasificador,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Cadena,Comprobante,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Renta,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Codigo_Tipo_Recurso  From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' /*And Left(Clasificador,5) In ('2.3.2')*/ Group By Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,Codigo_Estado_Devengado,Descripcion_Estado_Devengado,Monto_Total,Codigo_Comprobante,Nombre_Comprobante,Abreviatura,Numero_Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,igv,Sub_Total,Porcentaje,Tipo_Cambio,Porcentaje_Renta,Tercero,Otros,Codigo_Moneda,Fecha_Emision_Comprobante,Check_IGV,Check_Renta,Certificado,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Documento,[C.Costos],Clasificador,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Cadena,Comprobante,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Renta,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Codigo_Tipo_Recurso", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Girado_Haber_Patrimonial(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Girados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Total_Girado").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "H"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Girado_Haber_Patrimonial_PV(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Girados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Total_Girado").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "H"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Girado_Haber_Patrimonial_EI(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Girados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Total_Girado").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "H"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Girado_Haber_Patrimonial_CC(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,FechaAnulacion,UsuarioAnulacion,Codigo_Estado_Giro,Descripcion_Estado_Giro,Monto_Total,Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,Tipo_Cambio,Codigo_Moneda,Fecha_Emision_Comprobante,Certificado,Codigo_FF,Codigo_Rubro,0 As Tipo_Transaccion,0 As Generica,0 As Sub_Generica,0 As Sub_Generica_Detalle,0 As Especifica,0 As Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Sum(Monto) As Monto,Codigo_Tipo_Recurso,Nombre_Unidad_Organica,[C.Costos],Descripcion_Tipo_Recurso,Cadena,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Operacion,Codigo_Tipo_Pago,Descripcion_Tipo_Pago,Fecha_Operacion From Lista_Detalle_Girados_Basica_Final Where Numero ='" & Numero & "' And Año_Ejecucion='" & Año_Ejecucion & "' Group By Año_Ejecucion,Numero,Compuesto,Notas,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,FechaAnulacion,UsuarioAnulacion,Codigo_Estado_Giro,Descripcion_Estado_Giro,Monto_Total,Comprobante,Codigo_Tipo_Documento,Nombre_Tipo_Documento,Numero_Documento,Compromiso,Tipo_Cambio,Codigo_Moneda,Fecha_Emision_Comprobante,Certificado,Codigo_FF,Codigo_Rubro,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_Tipo_Recurso,Nombre_Unidad_Organica,[C.Costos],Descripcion_Tipo_Recurso,Cadena,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Asiento,Operacion,Codigo_Tipo_Pago,Descripcion_Tipo_Pago,Fecha_Operacion", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "H"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Cargar_Cuenta_Detalle_Cuenta_Devengado_Haber_Orden(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Mayor='" & Mayor & "' And Sub_Cuenta='" & Sub_Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Var_Cuenta As String = ""
        Dim Var_Mayor As String = ""
        Dim Var_Sub_Cuenta As String = ""
        Dim Var_Nombre_Cuenta As String = ""

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Var_Cuenta = Ds.Tables(0).Rows(0).Item("Cuenta").ToString
            Var_Mayor = Ds.Tables(0).Rows(0).Item("Mayor").ToString
            Var_Sub_Cuenta = Ds.Tables(0).Rows(0).Item("Sub_Cuenta").ToString
            Var_Nombre_Cuenta = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Basica_Final Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Año_Ejecucion
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Var_Mayor
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Var_Sub_Cuenta
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Var_Cuenta
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Var_Nombre_Cuenta
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = "H"
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(0), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Año_Ejecucion & "." & Var_Mayor & "." & Var_Sub_Cuenta & "." & Var_Cuenta & "." & Var_Nombre_Cuenta & "." & "D"
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            Next
        End If
    End Sub
    Public Sub Mostrar_Datos_Devengado_Asiento_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Fecha_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Estado_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_Certificacion As System.Windows.Forms.TextBox, ByVal Caja_Numero_Documento_Devengado As System.Windows.Forms.TextBox, ByVal Caja_IGV As System.Windows.Forms.TextBox, ByVal Caja_Renta As System.Windows.Forms.TextBox, ByVal Caja_Sub_Total As System.Windows.Forms.TextBox, ByVal Caja_Otros As System.Windows.Forms.TextBox, ByVal Caja_Total As System.Windows.Forms.TextBox, Optional ByVal DataGridView As System.Windows.Forms.DataGridView = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_Fecha_Devengado.Text = DateValue(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            Caja_Estado_Devengado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Devengado").ToString
            Caja_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Nombre_Tipo_Documento").ToString
            Caja_Certificacion.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Numero_Documento_Devengado.Text = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
            Caja_IGV.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("IGV").ToString), "###,###,#.00")
            Caja_Renta.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Renta").ToString), "###,###,#.00")
            Caja_Sub_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Sub_Total").ToString), "###,###,#.00")
            Caja_Otros.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Otros").ToString), "###,###,#.00")
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Total").ToString), "###,###,#.00")
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("select * from Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Cuenta").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto_Debe").ToString), "###,###,#.00")
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto_Haber").ToString), "###,###,#.00")
            Next
        End If
    End Sub
    Public Sub Nuevo_Asiento_Contable(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Cm As New OleDb.OleDbCommand

        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.StoredProcedure
            Cm.CommandText = "Nuevo_Asiento_Contable"
            Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
            Cm.Parameters.AddWithValue("@Numero", Numero)
            Cm.Parameters.AddWithValue("@Cuenta", DataGridView.Rows(Recorrido).Cells(0).Value)
            Cm.Parameters.AddWithValue("@Monto_Debe", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(2).Value))
            Cm.Parameters.AddWithValue("@Monto_Haber", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(3).Value))
            Cm.ExecuteNonQuery()
        Next
    End Sub
    Public Sub Nuevo_Asiento_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Cm As New OleDb.OleDbCommand

        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.StoredProcedure
            Cm.CommandText = "Nuevo_Asiento_Girado"
            Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
            Cm.Parameters.AddWithValue("@Numero", Numero)
            Cm.Parameters.AddWithValue("@Cuenta", DataGridView.Rows(Recorrido).Cells(0).Value)
            Cm.Parameters.AddWithValue("@Monto_Debe", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(2).Value))
            Cm.Parameters.AddWithValue("@Monto_Haber", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(3).Value))
            Cm.ExecuteNonQuery()
        Next
    End Sub
    Public Function Evaluar_Existencia_Asiento(ByVal Año_Ejecucion As String, ByVal Numero As String) As Boolean
        Evaluar_Existencia_Asiento = True
        If Evaluar_Existencia_Asiento = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Cuenta_Presupuestal Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Dim Ds As New Data.DataSet
            Dim Acumulado As Integer = 0
            Da.Fill(Ds)
            Acumulado = Acumulado + Ds.Tables(0).Rows.Count
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Cuenta_Patrimonial Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            Acumulado = Acumulado + Ds.Tables(0).Rows.Count
            Da = Nothing
            Ds = Nothing
            Da = New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds)
            Acumulado = Acumulado + Ds.Tables(0).Rows.Count
            If Acumulado = 0 Then
                Evaluar_Existencia_Asiento = True
                Return Evaluar_Existencia_Asiento
            Else
                Evaluar_Existencia_Asiento = False
                Return Evaluar_Existencia_Asiento
            End If
        End If
        Return Evaluar_Existencia_Asiento
    End Function
    Public Function Evaluar_Existencia_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String) As Boolean
        Evaluar_Existencia_Girado = True
        If Evaluar_Existencia_Girado = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion In ('29','30','34','41','42','45','54') And Codigo_Documento In ('16','17','21','28','29','33','36') And Codigo_Estado_Devengado_Movimientos In ('01','02','03')", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count = 0 Then
                Evaluar_Existencia_Girado = True
                Return Evaluar_Existencia_Girado
            Else
                Evaluar_Existencia_Girado = False
                Return Evaluar_Existencia_Girado
            End If
        End If
        Return Evaluar_Existencia_Girado
    End Function
    Public Function Evaluar_Existencia_Asiento_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String) As Boolean
        Evaluar_Existencia_Asiento_Girado = True
        If Evaluar_Existencia_Asiento_Girado = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Girado_Cuenta_Patrimonial Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count = 0 Then
                Evaluar_Existencia_Asiento_Girado = True
                Return Evaluar_Existencia_Asiento_Girado
            Else
                Evaluar_Existencia_Asiento_Girado = False
                Return Evaluar_Existencia_Asiento_Girado
            End If
        End If
        Return Evaluar_Existencia_Asiento_Girado
    End Function
    Public Sub Evaluacion_Botones_Asientos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Asiento As DevComponents.DotNetBar.ButtonItem, ByVal Liberar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Asiento_Contable Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Asiento.Enabled = False
            Liberar.Enabled = True
        Else
            Asiento.Enabled = True
            Liberar.Enabled = False
        End If
    End Sub
    Public Sub Evaluacion_Botones_Asientos_2(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Asiento As DevComponents.DotNetBar.ButtonItem, ByVal Liberar As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Asiento_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Asiento.Enabled = False
            Liberar.Enabled = True
        Else
            Asiento.Enabled = True
            Liberar.Enabled = False
        End If
    End Sub
    Public Sub Liberar_Asiento_Contable(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Devengado_Cuenta_Presupuestal Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Devengado_Cuenta_Patrimonial Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Devengado_Cuenta_Orden Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Devengado_Cuenta_Retenciones Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Me.Establecer_Asiento_Contable_Devengado(Año_Ejecucion, Numero, False)
    End Sub
    Public Sub Liberar_Asiento_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand

        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Girado_Cuenta_Patrimonial Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Girado_Asiento_Contable_Comprobante Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Me.Establecer_Asiento_Contable_Girado(Año_Ejecucion, Numero, False)
    End Sub
    Public Sub Revertir_Girado_Pago_Comprobante(ByVal Año_Ejecucion As String, ByVal Numero_Giro As String, ByVal Numero_Comprobante As String, ByVal Documento_Girar As String)
        Me.Eliminar_Girado(Documento_Girar, Año_Ejecucion, Numero_Giro, True)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Comprobante & "' And Numero_Giro='" & Numero_Giro & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Determinar_Existencia_Compromiso(ByVal Tipo_Documento As String, ByVal Año_Ejecucion As String, ByVal Numero As String, Optional ByVal Codigo_Unidad_Organica As String = Nothing) As Boolean
        Determinar_Existencia_Compromiso = True
        If Determinar_Existencia_Compromiso = True Then
            Select Case Tipo_Documento
                Case "08"
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Ds.Tables(0).Rows(0).Item("Expediente") Is DBNull.Value Then
                            Determinar_Existencia_Compromiso = True
                        Else
                            Determinar_Existencia_Compromiso = False
                        End If
                    Else
                        Exit Function
                    End If
                Case "09"
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Ds.Tables(0).Rows(0).Item("Expediente") Is DBNull.Value Then
                            Determinar_Existencia_Compromiso = True
                        Else
                            Determinar_Existencia_Compromiso = False
                        End If
                    Else
                        Exit Function
                    End If
                Case "22", "23"
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Ds.Tables(0).Rows(0).Item("Expediente") Is DBNull.Value Then
                            Determinar_Existencia_Compromiso = True
                        Else
                            Determinar_Existencia_Compromiso = False
                        End If
                    Else
                        Exit Function
                    End If
                Case "19"
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Planilla Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Ds.Tables(0).Rows(0).Item("Compromiso") Is DBNull.Value Then
                            Determinar_Existencia_Compromiso = True
                        Else
                            Determinar_Existencia_Compromiso = False
                        End If
                    Else
                        Exit Function
                    End If
                Case "31"
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Pagos_Varios Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Ds.Tables(0).Rows(0).Item("Expediente") Is DBNull.Value Then
                            Determinar_Existencia_Compromiso = True
                        Else
                            Determinar_Existencia_Compromiso = False
                        End If
                    Else
                        Exit Function
                    End If
                Case "34"
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Encargo_Interno Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Ds.Tables(0).Rows(0).Item("Expediente") Is DBNull.Value Then
                            Determinar_Existencia_Compromiso = True
                        Else
                            Determinar_Existencia_Compromiso = False
                        End If
                    Else
                        Exit Function
                    End If
                Case "61"
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Contrato Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        If Ds.Tables(0).Rows(0).Item("Expediente") Is DBNull.Value Then
                            Determinar_Existencia_Compromiso = True
                        Else
                            Determinar_Existencia_Compromiso = False
                        End If
                    Else
                        Exit Function
                    End If
            End Select
            Return Determinar_Existencia_Compromiso
        End If
    End Function
    Public Function Determinar_Liquidacion(ByVal Año_Ejecucion As String, ByVal Numero As String) As Boolean
        Determinar_Liquidacion = False
        If Determinar_Liquidacion = False Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                If Ds.Tables(0).Rows(0).Item("Liquidacion") = False Then
                    Determinar_Liquidacion = False
                Else
                    Determinar_Liquidacion = True
                End If
            End If
        End If
        Return Determinar_Liquidacion
    End Function
    Public Sub Reenumerar_Devengado(ByVal Tipo_Documento As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo_Numero As String, ByVal FechaEmision As Date)
        Select Case Tipo_Documento
            Case "08"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Nuevo_Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    MessageBox.Show("No Se Puede Asignar el Nuevo Número de Devengado porque esta en Uso", "..:: Reenumeración de Devengados ::..", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
                    Exit Sub
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Devengado Set Numero='" & Nuevo_Numero & "', FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Orden_Compra_Movimientos Set Numero_Documento='" & Nuevo_Numero & "' Where Codigo_Tipo_Operacion='07' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden Set Numero_Documento='" & Nuevo_Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='25'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing

                End If
            Case "09"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Nuevo_Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    MessageBox.Show("No Se Puede Asignar el Nuevo Número de Devengado porque esta en Uso", "..:: Reenumeración de Devengados ::..", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
                    Exit Sub
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Devengado Set Numero='" & Nuevo_Numero & "', FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Orden_Servicio_Movimientos Set Numero_Documento='" & Nuevo_Numero & "' Where Codigo_Tipo_Operacion='08' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden Set Numero_Documento='" & Nuevo_Numero & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='26'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "22"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Nuevo_Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    MessageBox.Show("No Se Puede Asignar el Nuevo Número de Devengado porque esta en Uso", "..:: Reenumeración de Devengados ::..", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
                    Exit Sub
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Devengado Set Numero='" & Nuevo_Numero & "', FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Numero_Documento='" & Nuevo_Numero & "' Where Codigo_Tipo_Operacion='39' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "23"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Nuevo_Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    MessageBox.Show("No Se Puede Asignar el Nuevo Número de Devengado porque esta en Uso", "..:: Reenumeración de Devengados ::..", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
                    Exit Sub
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Devengado Set Numero='" & Nuevo_Numero & "', FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Numero_Documento='" & Nuevo_Numero & "' Where Codigo_Tipo_Operacion='40' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "19"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Nuevo_Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    MessageBox.Show("No Se Puede Asignar el Nuevo Número de Devengado porque esta en Uso", "..:: Reenumeración de Devengados ::..", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
                    Exit Sub
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Devengado Set Numero='" & Nuevo_Numero & "', FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Planilla_Movimientos Set Numero_Documento='" & Nuevo_Numero & "' Where Codigo_Tipo_Operacion='33' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "31"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Nuevo_Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    MessageBox.Show("No Se Puede Asignar el Nuevo Número de Devengado porque esta en Uso", "..:: Reenumeración de Devengados ::..", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
                    Exit Sub
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Devengado Set Numero='" & Nuevo_Numero & "', FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Numero_Documento='" & Nuevo_Numero & "' Where Codigo_Tipo_Operacion='44' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "34"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Nuevo_Numero & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    MessageBox.Show("No Se Puede Asignar el Nuevo Número de Devengado porque esta en Uso", "..:: Reenumeración de Devengados ::..", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
                    Exit Sub
                Else
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Devengado Set Numero='" & Nuevo_Numero & "', FechaEmision='" & DateValue(FechaEmision) & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Numero_Documento='" & Nuevo_Numero & "' Where Codigo_Tipo_Operacion='53' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
        End Select
    End Sub
    Public Function Estado_Aprobado_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String) As Boolean
        Estado_Aprobado_Certificado = True
        If Estado_Aprobado_Certificado = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                If Ds.Tables(0).Rows(0).Item("Codigo_Estado_Certificado").ToString = "03" Then
                    Estado_Aprobado_Certificado = True
                Else
                    Estado_Aprobado_Certificado = False
                End If
            End If
        End If
        Return Estado_Aprobado_Certificado
    End Function
    Public Sub Adicionar_Detalle_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, Optional ByVal Ampliacion As String = Nothing)

        For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
            With DataGridView.Rows(Recorrido).Cells
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_FF=" & .Item(1).Value & " And Codigo_Rubro='" & .Item(2).Value & "' And Tipo_Transaccion='" & .Item(3).Value & "' And Generica='" & .Item(4).Value & "' And Sub_Generica='" & .Item(5).Value & "' And Sub_Generica_Detalle='" & .Item(6).Value & "' And Especifica='" & .Item(7).Value & "' And Especifica_Detalle='" & .Item(8).Value & "' And Codigo_Secuencia_Funcional='" & .Item(10).Value & "' And Codigo_Unidad_Organica='" & .Item(11).Value & "' And Codigo_Actividad='" & .Item(12).Value & "' And Codigo_Tipo_Recurso='" & .Item(17).Value & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count = 0 Then
                    Me.Nuevo_Detalle_Certificado_2(Año_Ejecucion, Numero, .Item(1).Value, .Item(2).Value, .Item(3).Value, .Item(4).Value, .Item(5).Value, .Item(6).Value, .Item(7).Value, .Item(8).Value, .Item(10).Value, .Item(11).Value, .Item(12).Value, 0, .Item(17).Value, Ampliacion)
                End If
            End With
        Next
    End Sub
    Public Sub Nueva_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Resolucion As String, ByVal Justificacion As String, ByVal FechaApertura As Date, ByVal UsuarioApertura As String, ByVal Codigo_Estado_Caja As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Caja_Chica"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Resolucion", Resolucion)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaApertura", FechaApertura)
        Cm.Parameters.AddWithValue("@UsuarioApertura", UsuarioApertura)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Caja", Codigo_Estado_Caja)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Resolucion As String, ByVal Justificacion As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Caja_Chica"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Resolucion", Resolucion)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Caja_Chica(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Caja_Chica Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Caja_Chica = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Caja_Chica
    End Function
    Public Sub Evaluacion_Botones_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Rendir As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Detallar As DevComponents.DotNetBar.ButtonItem, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, ByVal Formatos As DevComponents.DotNetBar.ButtonItem, ByVal Notas As DevComponents.DotNetBar.ButtonItem, ByVal Hoja As DevComponents.DotNetBar.ButtonItem, ByVal Folear As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Caja").ToString
                Case "01" 'APERTURADA()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Rendir.Enabled = True
                    'Liquidar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Detallar.Enabled = True
                    Formatos.Enabled = True
                    Notas.Enabled = True
                    Hoja.Enabled = True
                    Folear.Enabled = True
                Case "02" 'RENDIDA()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Rendir.Enabled = False
                    'Liquidar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Detallar.Enabled = False
                    Formatos.Enabled = True
                    Notas.Enabled = True
                    Hoja.Enabled = True
                    Folear.Enabled = True
                Case "03" 'ANULADA()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Rendir.Enabled = False
                    'Liquidar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Detallar.Enabled = False
                    Formatos.Enabled = False
                    Notas.Enabled = False
                    Hoja.Enabled = False
                    Folear.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Rendir.Enabled = False
                    'Liquidar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Detallar.Enabled = False
                    Formatos.Enabled = False
                    Notas.Enabled = False
                    Hoja.Enabled = False
                    Folear.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Cargar_Data_Caja_Chica_Modificacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Combo_Unidad As System.Windows.Forms.ComboBox, ByVal Caja_Resolucion As System.Windows.Forms.TextBox, ByVal Caja_Monto As System.Windows.Forms.TextBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Basica_Caja_Chica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Combo_Unidad Is System.Windows.Forms.ComboBox Then Combo_Unidad.Text = Ds.Tables(0).Rows(0).Item("Abreviatura")
            If TypeOf Caja_Resolucion Is System.Windows.Forms.TextBox Then Caja_Resolucion.Text = Ds.Tables(0).Rows(0).Item("Resolucion")
            If TypeOf Caja_Monto Is System.Windows.Forms.TextBox Then Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
            If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion")
        End If
    End Sub
    Public Function Devolver_Abreviatura_Detalle_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Basica_Caja_Chica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Devolver_Abreviatura_Detalle_Caja_Chica = Ds.Tables(0).Rows(0).Item("Abreviatura").ToString
        Else
            Devolver_Abreviatura_Detalle_Caja_Chica = ""
        End If
        Return Devolver_Abreviatura_Detalle_Caja_Chica
    End Function
    Public Sub Nueva_Rendicion_Caja(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Tipo_Recurso As String, ByVal Codigo_Comprobante As String, ByVal Serie_Comprobante As String, ByVal Numero_Comprobante As String, ByVal Justificacion_Comprobante As String, ByVal Monto As Double, ByVal FechaComprobante As Date, ByVal Porcentaje As Double, ByVal Porcentaje_Renta As Double, ByVal Renta As Double, ByVal IGV As Double, ByVal Otros As Double, ByVal Sub_Total As Double, ByVal Codigo_Proveedor As String, ByVal Tercero As Boolean, ByVal Check_IGV As Boolean, ByVal Check_Renta As Boolean)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Rendicion_Caja"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Codigo_Comprobante", Codigo_Comprobante)
        Cm.Parameters.AddWithValue("@Serie_Comprobante", Serie_Comprobante)
        Cm.Parameters.AddWithValue("@Numero_Comprobante", Numero_Comprobante)
        Cm.Parameters.AddWithValue("@Justificacion_Comprobante", Justificacion_Comprobante)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@FechaComprobante", FechaComprobante)
        Cm.Parameters.AddWithValue("@Porcentaje", Porcentaje)
        Cm.Parameters.AddWithValue("@Porcentaje_Renta", Porcentaje_Renta)
        Cm.Parameters.AddWithValue("@Renta", Renta)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Otros", Otros)
        Cm.Parameters.AddWithValue("@Sub_Total", Sub_Total)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Tercero", Tercero)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@Check_Renta", Check_Renta)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nueva_Rendicion_Caja_Movimientos(ByVal Correlativo As String, ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Operacion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Tipo_Recurso As String, ByVal Codigo_Comprobante As String, ByVal Serie_Comprobante As String, ByVal Numero_Comprobante As String, ByVal Justificacion_Comprobante As String, ByVal Monto As Double, ByVal FechaComprobante As Date, ByVal Codigo_Documento As String, ByVal Numero_Documento As String, ByVal Codigo_Estado_Caja_Movimientos As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Rendicion_Caja_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Codigo_Comprobante", Codigo_Comprobante)
        Cm.Parameters.AddWithValue("@Serie_Comprobante", Serie_Comprobante)
        Cm.Parameters.AddWithValue("@Numero_Comprobante", Numero_Comprobante)
        Cm.Parameters.AddWithValue("@Justificacion_Comprobante", Justificacion_Comprobante)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@FechaComprobante", FechaComprobante)
        Cm.Parameters.AddWithValue("@Codigo_Documento", Codigo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Caja_Movimientos", Codigo_Estado_Caja_Movimientos)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Limpiar_Rendicion_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Rendicion_Caja Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Rendicion_Caja_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Cargar_Detalle_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Basica_Rendiciones_Caja Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional")
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica_Comprobante")
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Comprobante")
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Nombre_Comprobante")
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Serie_Comprobante")
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Comprobante")
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Format(DateValue(Ds.Tables(0).Rows(Recorrido).Item("FechaComprobante").ToString), "dd/MM/yyyy")
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Justificacion_Comprobante")
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto_Comprobante").ToString), "###,###,#.00")
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso")
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion") & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF") & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") & "." & Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion") & "." & Ds.Tables(0).Rows(Recorrido).Item("Generica") & "." & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica") & "." & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") & "." & Ds.Tables(0).Rows(Recorrido).Item("Especifica") & "." & Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional") & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") & "." & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Porcentaje")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Porcentaje_Renta")
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Renta").ToString), "###,###,#.00")
                DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("IGV").ToString), "###,###,#.00")
                DataGridView.Item(27, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Otros").ToString), "###,###,#.00")
                DataGridView.Item(28, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Sub_Total").ToString), "###,###,#.00")
                DataGridView.Item(29, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Proveedor_Comprobante")
                DataGridView.Item(30, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tercero")
                DataGridView.Item(31, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Check_IGV")
                DataGridView.Item(32, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Check_Renta")
                DataGridView.Item(33, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto_Comprobante").ToString), "###,###,#.00")
            Next
        End If
    End Sub
    Public Function Determinar_Editabilidad_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero_Rendicion As Integer) As Boolean
        Determinar_Editabilidad_Caja_Chica = True
        If Determinar_Editabilidad_Caja_Chica = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Determinar_Editabilidad_Caja_Chica = False
            Else
                Determinar_Editabilidad_Caja_Chica = True
            End If
        End If
        Return Determinar_Editabilidad_Caja_Chica
    End Function
    Public Function Cargar_Data_Basica_Caja_Chica_Editar(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer) As DataTable
        Cargar_Data_Basica_Caja_Chica_Editar = New DataTable
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Cargar_Data_Basica_Caja_Chica_Editar)
        Return Cargar_Data_Basica_Caja_Chica_Editar
    End Function
    Public Function Verificar_Extornabilidad_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As String) As Boolean
        Verificar_Extornabilidad_Caja_Chica = True
        If Verificar_Extornabilidad_Caja_Chica = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Estado_Caja In('02') And Expediente Is Null And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Verificar_Extornabilidad_Caja_Chica = True
            Else
                Verificar_Extornabilidad_Caja_Chica = False
            End If
        End If
        Return Verificar_Extornabilidad_Caja_Chica
    End Function
    Public Sub Cargar_Certificado_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Emision As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("select Año_Ejecucion,Numero,Emision,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Descripcion_Tipo_Recurso as TR,Meta,Codigo_Secuencia_Funcional As [Sec.Fun.],Clasificador,Monto,Saldo,Total,Codigo_Tipo_Recurso From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Total").ToString), "###,###,#.00")

            DataGridView.Rows.Clear()
            Dim Saldo As Double = 0
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sec.Fun.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Saldo = Saldo + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString)
            Next
            Caja_Emision.Text = DateValue(Ds.Tables(0).Rows(0).Item("Emision"))
        End If
    End Sub
    Public Function Evaluar_Certificado_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Caja As String, ByVal Certificado As String) As String
        Evaluar_Certificado_Caja_Chica = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Clasificador,Codigo_Secuencia_Funcional,Abreviatura,Codigo_Unidad_Organica_Comprobante,Codigo_Actividad,Descripcion_Tipo_Recurso as TR ,Sum(Monto_Comprobante) As Monto From Lista_Basica_Rendiciones_Caja Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Caja & "' Group By Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Clasificador,Codigo_Secuencia_Funcional,Abreviatura,Codigo_Unidad_Organica_Comprobante,Codigo_Actividad,Descripcion_Tipo_Recurso", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim DaCertificado As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Descripcion_Tipo_Recurso as TR,Meta,Codigo_Secuencia_Funcional As [Sec.Fun.],Clasificador,Monto,Saldo,Total,Codigo_Tipo_Recurso From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "' And Codigo_FF=" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF") & " And Codigo_Rubro='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") & "' And Codigo_Tipo_Recurso='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso") & "' And Codigo_Secuencia_Funcional='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional") & "' And Codigo_Actividad='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad") & "' And Clasificador='" & Ds.Tables(0).Rows(Recorrido).Item("Clasificador") & "'", Cn)
                Dim DsCertificado As New Data.DataSet
                DaCertificado.Fill(DsCertificado)
                If DsCertificado.Tables(0).Rows.Count > 0 Then
                    If Convert.ToDouble(DsCertificado.Tables(0).Rows(0).Item("Saldo").ToString) >= Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) Then
                        Evaluar_Certificado_Caja_Chica = Evaluar_Certificado_Caja_Chica & ""
                    Else
                        Evaluar_Certificado_Caja_Chica = Evaluar_Certificado_Caja_Chica & vbNewLine & "- Rubro: " & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & ", TR: " & Ds.Tables(0).Rows(Recorrido).Item("TR").ToString & ", Clasificador: " & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & ", Meta: " & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                    End If
                Else
                    Evaluar_Certificado_Caja_Chica = Evaluar_Certificado_Caja_Chica & vbNewLine & "- Rubro: " & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & ", TR: " & Ds.Tables(0).Rows(Recorrido).Item("TR").ToString & ", Clasificador: " & Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString & ", Meta: " & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString & "-" & Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                End If
            Next
        Else
            Evaluar_Certificado_Caja_Chica = ""
        End If
        If Evaluar_Certificado_Caja_Chica.Trim.Length > 0 Then
            Return "==>> No hay Saldos o no se ha Certificado lo siguiente <<==" & vbNewLine & "=========================================" & vbNewLine & Evaluar_Certificado_Caja_Chica
        Else
            Return Evaluar_Certificado_Caja_Chica
        End If
    End Function
    Public Sub Rendir_Caja_Chica_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Usuario As String)

        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Caja_Chica Set Certificado='" & Certificado & "', Codigo_Estado_Caja='02', FechaRendicion=GetDate(), UsuarioRendicion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rendicion_Caja_Movimientos Set Codigo_Estado_Caja_Movimientos = '02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Tipo_Recurso,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Sum(Monto) As Monto  From Rendicion_Caja Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero ='" & Numero & "' Group By Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Tipo_Recurso,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Correlativo As String = Me.Generar_Numero_Correlativo_Certificado(Año_Ejecucion, Certificado)
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                With Ds.Tables(0).Rows(Recorrido)
                    Me.Nuevo_Detalle_Certificado_Movimiento(Correlativo, "19", Año_Ejecucion, Certificado, .Item("Codigo_FF"), .Item("Codigo_Rubro"), .Item("Tipo_Transaccion"), .Item("Generica"), .Item("Sub_Generica"), .Item("Sub_Generica_Detalle"), .Item("Especifica"), .Item("Especifica_Detalle"), .Item("Codigo_Secuencia_Funcional"), .Item("Codigo_Unidad_Organica"), .Item("Codigo_Actividad"), Numero, Convert.ToDouble(.Item("Monto").ToString) * -1, "02", .Item("Codigo_Tipo_Recurso"))
                End With
            Next
        End If
    End Sub
    Public Sub Liquidar_Caja_Chica_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)

        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Caja_Chica Set Codigo_Estado_Caja='03', FechaLiquidacion=GetDate(), UsuarioLiquidacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rendicion_Caja_Movimientos Set Codigo_Estado_Caja_Movimientos = '03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='19'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer)
        Select Case Codigo_Tipo_Caja
            Case "01"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Caja_Chica_SBLM Set Codigo_Estado_Caja='01',FechaRendicion=Null,UsuarioRendicion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Operacion='37' And Numero_Documento='" & Numero & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "02"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Caja_Chica_SBLM Set Codigo_Estado_Caja='01',FechaRendicion=Null,UsuarioRendicion=Null,Certificado=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Operacion='38' And Numero_Documento='" & Numero & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Anular_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer)
        Select Case Codigo_Tipo_Caja
            Case "01"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Caja_Chica_SBLM Set Codigo_Estado_Caja='03',FechaRendicion=Null,UsuarioRendicion=Null,Rendido=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='03',Rendido=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM Set Rendido=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "02"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Caja_Chica_SBLM Set Codigo_Estado_Caja='03',FechaRendicion=Null,UsuarioRendicion=Null,Certificado=Null,Rendido=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Codigo_Estado_Caja_Movimientos='03',Rendido=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM Set Rendido=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Eliminar_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Serie_Comprobante(ByVal Codigo_Comprobante As String) As Boolean
        Serie_Comprobante = True
        If Serie_Comprobante = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Tipo_Comprobantes Where Codigo_Comprobante='" & Codigo_Comprobante & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows(0).Item("Serie") = True Then
                Serie_Comprobante = True
            Else
                Serie_Comprobante = False
            End If
        End If
        Return Serie_Comprobante
    End Function
    Public Function Obtener_Numero_Certificado_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer) As String
        Obtener_Numero_Certificado_Caja_Chica = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Obtener_Numero_Certificado_Caja_Chica = Ds.Tables(0).Rows(0).Item("Certificado_Rendicion").ToString
        Else
            Obtener_Numero_Certificado_Caja_Chica = ""
        End If
        Return Obtener_Numero_Certificado_Caja_Chica
    End Function
    Public Function Obtener_Numero_Certificado_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String) As String
        Obtener_Numero_Certificado_Pagos_Varios = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Pagos_Varios_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Obtener_Numero_Certificado_Pagos_Varios = Ds.Tables(0).Rows(0).Item("Certificado").ToString
        Else
            Obtener_Numero_Certificado_Pagos_Varios = ""
        End If
        Return Obtener_Numero_Certificado_Pagos_Varios
    End Function
    Public Function Obtener_Numero_Certificado_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String) As String
        Obtener_Numero_Certificado_Contrato = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Contratos_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Obtener_Numero_Certificado_Contrato = Ds.Tables(0).Rows(0).Item("Certificado").ToString
        Else
            Obtener_Numero_Certificado_Contrato = ""
        End If
        Return Obtener_Numero_Certificado_Contrato
    End Function
    Public Function Obtener_Numero_Certificado_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String) As String
        Obtener_Numero_Certificado_Planilla = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Planilla Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Obtener_Numero_Certificado_Planilla = Ds.Tables(0).Rows(0).Item("Certificado").ToString
        Else
            Obtener_Numero_Certificado_Planilla = ""
        End If
        Return Obtener_Numero_Certificado_Planilla
    End Function
    Public Sub Cargar_Data_Devengar_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Expediente As String, Optional ByVal Caja_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Fecha As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Certificado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Expediente As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_RUC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Numero_Rendicion As Integer = Nothing)
        Dim Certificado As String = Me.Obtener_Numero_Certificado_Caja_Chica(Año_Ejecucion, Numero, Codigo_Tipo_Caja, Codigo_Unidad_Organica, Numero_Rendicion)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro, Convert(VarChar(1), Codigo_FF) +' - '+ Codigo_Rubro As Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Sum(Monto_Comprobante) As Monto,Abreviatura,Codigo_Tipo_Recurso ,Codigo_Comprobante,Serie_Comprobante,Numero_Comprobante ,Codigo_Comprobante ,Abreviatura_Comprobante,Denominacion,Convert(VarChar(10),FechaEmision,103) As FechaEmision From  Lista_Caja_Chica_SBLM_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Expediente='" & Expediente & "' Group By Año_Ejecucion,Numero,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Abreviatura,Codigo_Tipo_Recurso,Codigo_Secuencia_Funcional,Codigo_Comprobante,Serie_Comprobante,Numero_Comprobante,Abreviatura_Comprobante,Denominacion,FechaEmision   Having Sum(Monto_Comprobante) >0", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero")
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Certificado
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional")
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura")
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica")
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                        DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro")
                        DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                        DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                        DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                        DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                        DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                        DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                        DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso")
                        DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Comprobante")
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Comprobante") & " - " & Ds.Tables(0).Rows(Recorrido).Item("Abreviatura_Comprobante")
                        DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Serie_Comprobante")
                        DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Comprobante")
                        DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto")), "###,###,#.00")
                        DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                        DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = DateValue(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision"))
                        DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Denominacion")
                    Next
                End If
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Resolucion")
                    If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Notas")
                    If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaApertura").ToString, 10)
                    If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion")
                    If TypeOf Caja_Expediente Is System.Windows.Forms.TextBox Then Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Expediente").ToString
                    If TypeOf Caja_RUC Is System.Windows.Forms.TextBox Then Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                    If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
        End Select
    End Sub
    Public Sub Cargar_Data_Devengar_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Expediente As String, Optional ByVal Caja_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Fecha As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Certificado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Expediente As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_RUC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing)
        Dim Certificado As String = Me.Obtener_Numero_Certificado_Pagos_Varios(Año_Ejecucion, Numero)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro, Convert(VarChar(1), Codigo_FF) +' - '+ Codigo_Rubro As Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Sum(Monto) As Disponible,Saldito,Abreviatura,Codigo_Tipo_Recurso,Descripcion_Tipo_Recurso ,Convert(VarChar(10),FechaEmision,103) As FechaEmision,Descripcion_Especifica_Detalle From  Lista_Pagos_Varios_Basica_Detallada  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Expediente='" & Expediente & "' Group By Año_Ejecucion,Numero,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Abreviatura,Codigo_Tipo_Recurso,Codigo_Secuencia_Funcional,Descripcion_Tipo_Recurso,FechaEmision,Descripcion_Especifica_Detalle,Saldito   Having Sum(Monto) >0 And Saldito>0", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero")
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Certificado
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional")
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura")
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica")
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                        DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro")
                        DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                        DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                        DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                        DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                        DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                        DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                        DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle")
                        DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso")
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso")
                        DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Disponible")), "###,###,#.00")
                        DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                    Next
                End If
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Denominacion,Descripcion_Denominacion,Documento,Justificacion,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,FechaAnulacion,UsuarioAnulacion,Codigo_Estado_Pago,Descripcion_Estado_Pago,Total,Saldo,Certificado,Expediente,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Codigo_Moneda,Tipo_Cambio,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Descripcion_Especifica_Detalle,Nombre_Unidad_Organica,Abreviatura,Codigo_Secuencia_Funcional,Nombre_FF,Codigo_Unidad_Organica,Codigo_Actividad,Sum(Monto) As Monto,Saldito,Descripcion_Tipo_Recurso,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,RB,Fuente  From Lista_Pagos_Varios_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Codigo_Denominacion,Descripcion_Denominacion,Documento,Justificacion,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,FechaAnulacion,UsuarioAnulacion,Codigo_Estado_Pago,Descripcion_Estado_Pago,Total,Saldo,Certificado,Expediente,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Codigo_Moneda,Tipo_Cambio,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Descripcion_Especifica_Detalle,Nombre_Unidad_Organica,Abreviatura,Codigo_Secuencia_Funcional,Nombre_FF,Codigo_Unidad_Organica,Codigo_Actividad,Saldito,Descripcion_Tipo_Recurso,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda,RB,Fuente", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento")
                    If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion")
                    If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString, 10)
                    If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion")
                    If TypeOf Caja_Expediente Is System.Windows.Forms.TextBox Then Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Expediente").ToString
                    If TypeOf Caja_RUC Is System.Windows.Forms.TextBox Then Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                    If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select Sum(Monto) As Monto From Lista_Pagos_Varios_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                End If
        End Select
    End Sub
    Public Sub Cargar_Data_Devengar_Contratos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Expediente As String, Optional ByVal Caja_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Fecha As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Certificado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Expediente As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_RUC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing)
        Dim Certificado As String = Me.Obtener_Numero_Certificado_Contrato(Año_Ejecucion, Numero)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro, Convert(VarChar(1), Codigo_FF) +' - '+ Codigo_Rubro As Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Sum(Monto) As Disponible,Saldito,Abreviatura,Codigo_Tipo_Recurso,Descripcion_Tipo_Recurso ,Convert(VarChar(10),FechaEmision,103) As FechaEmision,Descripcion_Especifica_Detalle From  Lista_Contratos_Basica_Detallada  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Expediente='" & Expediente & "' Group By Año_Ejecucion,Numero,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Abreviatura,Codigo_Tipo_Recurso,Codigo_Secuencia_Funcional,Descripcion_Tipo_Recurso,FechaEmision,Descripcion_Especifica_Detalle,Saldito   Having Sum(Monto) >0 And Saldito>0", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero")
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Certificado
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional")
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura")
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica")
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                        DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro")
                        DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                        DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                        DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                        DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                        DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                        DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                        DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle")
                        DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso")
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso")
                        DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Disponible")), "###,###,#.00")
                        DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                    Next
                End If
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,FechaAnulacion,UsuarioAnulacion,Codigo_Estado_Contrato,Descripcion_Estado_Contrato,Monto,Saldo,Certificado,Expediente,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Codigo_Moneda,Tipo_Cambio,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Descripcion_Especifica_Detalle,Nombre_Unidad_Organica,Abreviatura,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Sum(Monto) As Monto,Saldito,Descripcion_Tipo_Recurso,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda  From Lista_Contratos_Basica_Detallada Where Año_Ejecucion='" & My.Settings.Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,FechaEmision,UsuarioEmision,FechaAutorizacion,UsuarioAutorizacion,FechaAprobacion,UsuarioAprobacion,FechaAnulacion,UsuarioAnulacion,Codigo_Estado_Contrato,Descripcion_Estado_Contrato,Monto,Saldo,Certificado,Expediente,Codigo_Proveedor,RUC_Proveedor,Razon_Social,Codigo_Moneda,Tipo_Cambio,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Descripcion_Especifica_Detalle,Nombre_Unidad_Organica,Abreviatura,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Saldito,Descripcion_Tipo_Recurso,Nombre_Moneda,Simbolo_Moneda,Plural_Moneda", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = "CONTRATO DE LOCACACIÓN DE SERVICIOS NRO." & Ds.Tables(0).Rows(0).Item("Numero") & "-" & My.Settings.Año_Ejecucion
                    If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = "CONTRATO DE LOCACACIÓN DE SERVICIOS NRO." & Ds.Tables(0).Rows(0).Item("Numero") & "-" & My.Settings.Año_Ejecucion
                    If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString, 10)
                    If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion")
                    If TypeOf Caja_Expediente Is System.Windows.Forms.TextBox Then Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Expediente").ToString
                    If TypeOf Caja_RUC Is System.Windows.Forms.TextBox Then Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                    If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select Sum(Monto) As Monto From Lista_Contratos_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                End If
        End Select
    End Sub
    Public Sub Cargar_Data_Devengar_Encargos_Internos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Expediente As String, Optional ByVal Caja_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Fecha As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Certificado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Expediente As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_RUC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing)
        Dim Certificado As String = Me.Obtener_Numero_Certificado_Pagos_Varios(Año_Ejecucion, Numero)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro, Convert(VarChar(1), Codigo_FF) +' - '+ Codigo_Rubro As Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Sum(Monto) As Monto,Abreviatura,Codigo_Tipo_Recurso,Descripcion_Tipo_Recurso ,Convert(VarChar(10),FechaEmision,103) As FechaEmision,Descripcion_Especifica_Detalle From  Lista_Encargo_Interno_Basica_Detallada  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Expediente='" & Expediente & "' Group By Año_Ejecucion,Numero,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Abreviatura,Codigo_Tipo_Recurso,Codigo_Secuencia_Funcional,Descripcion_Tipo_Recurso,FechaEmision,Descripcion_Especifica_Detalle   Having Sum(Monto) >0", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero")
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Certificado
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional")
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura")
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica")
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                        DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro")
                        DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                        DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                        DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                        DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                        DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                        DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                        DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle")
                        DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso")
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso")
                        DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto")), "###,###,#.00")
                        DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                    Next
                End If
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Encargo_Interno_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento")
                    If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion")
                    If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString, 10)
                    If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion")
                    If TypeOf Caja_Expediente Is System.Windows.Forms.TextBox Then Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Expediente").ToString
                    If TypeOf Caja_RUC Is System.Windows.Forms.TextBox Then Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                    If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
        End Select
    End Sub
    Public Sub Cargar_Data_Devengar_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView, Optional ByVal Caja_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Fecha As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Certificado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Expediente As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_RUC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing)
        Dim Certificado As String = Me.Obtener_Numero_Certificado_Planilla(Año_Ejecucion, Numero)
        Select Case Operacion
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro, Convert(VarChar(1), Codigo_FF) +' - '+ Codigo_Rubro As Rubro    ,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Sum(Monto) As Monto,Abreviatura,Codigo_Tipo_Recurso,Descripcion_Especifica_Detalle From Lista_Planillas_Basica_Detallada_Resumen_2 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Codigo_Unidad_Organica,Codigo_Actividad,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Clasificador,Abreviatura,Codigo_Tipo_Recurso,Codigo_Secuencia_Funcional,Descripcion_Especifica_Detalle Having Sum(Monto) >0 ", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion")
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero")
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Certificado
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional")
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura")
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica")
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                        DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro")
                        DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion")
                        DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica")
                        DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica")
                        DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle")
                        DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica")
                        DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle")
                        DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                        DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle")
                        DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso")
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto")), "###,###,#.00")
                        DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                    Next
                End If
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Lista_Planillas_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento")
                    If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Notas")
                    If TypeOf Caja_Monto_Documento Is System.Windows.Forms.TextBox Then Caja_Monto_Documento.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Planilla").ToString), "###,###,#.00")
                    If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString, 10)
                    If TypeOf Caja_Certificado Is System.Windows.Forms.TextBox Then Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString & " - " & Ds.Tables(0).Rows(0).Item("Año_Ejecucion")
                    If TypeOf Caja_Expediente Is System.Windows.Forms.TextBox Then Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Compromiso").ToString
                    If TypeOf Caja_RUC Is System.Windows.Forms.TextBox Then Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
                    If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
        End Select
    End Sub
    Public Function Generar_Numero_Correlativo_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Numero_Caja As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Rendicion_Caja_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Caja_Chica = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Caja_Chica
    End Function
    Public Sub Cargar_Data_Detalles_Certificaciones_Seleccionadas(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal AmpliacionesRebajas As System.Windows.Forms.DataGridView, ByVal Compromisos As System.Windows.Forms.DataGridView, ByVal Devengados As System.Windows.Forms.DataGridView, ByVal Girados As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Ampliaciones_Rebajas Where Certificado='" & Numero & "' And Año='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                AmpliacionesRebajas.Rows.Add()
                AmpliacionesRebajas.Item(0, AmpliacionesRebajas.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                AmpliacionesRebajas.Item(1, AmpliacionesRebajas.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                AmpliacionesRebajas.Item(2, AmpliacionesRebajas.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo").ToString
                AmpliacionesRebajas.Item(3, AmpliacionesRebajas.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                AmpliacionesRebajas.Item(4, AmpliacionesRebajas.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                AmpliacionesRebajas.Item(5, AmpliacionesRebajas.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Estado").ToString
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Compromisos Where Certificado='" & Numero & "' And Año='" & Año_Ejecucion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Compromisos.Rows.Add()
                Compromisos.Item(0, Compromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                Compromisos.Item(1, Compromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                Compromisos.Item(2, Compromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo").ToString
                Compromisos.Item(3, Compromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                Compromisos.Item(4, Compromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Proveedor").ToString
                Compromisos.Item(5, Compromisos.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                Compromisos.Item(6, Compromisos.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Compromisos.Item(7, Compromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Estado").ToString
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Devengados Where Certificado='" & Numero & "' And Año='" & Año_Ejecucion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Devengados.Rows.Add()
                Devengados.Item(0, Devengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                Devengados.Item(1, Devengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString
                Devengados.Item(2, Devengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo").ToString
                Devengados.Item(3, Devengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                Devengados.Item(4, Devengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Proveedor").ToString
                Devengados.Item(5, Devengados.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                Devengados.Item(6, Devengados.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Devengados.Item(7, Devengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Estado").ToString
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Girados Where Certificado='" & Numero & "' And Año='" & Año_Ejecucion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Girados.Rows.Add()
                Girados.Item(0, Girados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                Girados.Item(1, Girados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString
                Girados.Item(2, Girados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo").ToString
                Girados.Item(3, Girados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                Girados.Item(4, Girados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Proveedor").ToString
                Girados.Item(5, Girados.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                Girados.Item(6, Girados.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Girados.Item(7, Girados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Estado").ToString
            Next
        End If
    End Sub
    Public Sub Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Naturaleza As String, ByVal Codigo_Tipo_Operacion As String, ByVal Numero_Documento As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Mayor", Mayor)
        Cm.Parameters.AddWithValue("@Sub_Cuenta", Sub_Cuenta)
        Cm.Parameters.AddWithValue("@Naturaleza", Naturaleza)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden_2(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Naturaleza As String, ByVal Codigo_Tipo_Operacion As String, ByVal Numero_Documento As String, ByVal IGV As Boolean)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden_2"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Mayor", Mayor)
        Cm.Parameters.AddWithValue("@Sub_Cuenta", Sub_Cuenta)
        Cm.Parameters.AddWithValue("@Naturaleza", Naturaleza)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Ejecutar_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0101", "08", "D", "23", Orden)
            Next
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0102", "08", "H", "23", Orden)
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden_2(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden_2(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0101", "08", "D", "23", Orden, Ds.Tables(0).Rows(Recorrido).Item("IGV"))
            Next
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden_2(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0102", "08", "H", "23", Orden, Ds.Tables(0).Rows(Recorrido).Item("IGV"))
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Anulacion_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden(ByVal Año_Ejecucion As String, ByVal Orden As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Centro_Costos Where Año_Ejecucion='" & Año_Ejecucion & "' And  Numero='" & Orden & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "0101", "08", "H", "13", Orden)
            Next
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "0102", "08", "D", "13", Orden)
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Anulacion_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden(ByVal Año_Ejecucion As String, ByVal Orden As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Servicio_Centro_Costos Where Año_Ejecucion='" & Año_Ejecucion & "' And  Numero='" & Orden & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "0101", "09", "H", "14", Orden)
            Next
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString), "0102", "09", "D", "14", Orden)
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden_Devengado(ByVal Año_Ejecucion As String, ByVal Correlativo As String, ByVal Devengado As String, ByVal Orden As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Correlativo='" & Correlativo & "' And Numero='" & Orden & "' And Codigo_Tipo_Operacion='07' And Numero_Documento='" & Devengado & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0101", "08", "H", "25", Devengado)
            Next
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0102", "08", "D", "25", Devengado)
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden_Devengado_2(ByVal Año_Ejecucion As String, ByVal Correlativo As String, ByVal Devengado As String, ByVal Orden As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Correlativo='" & Correlativo & "' And Numero='" & Orden & "' And Codigo_Tipo_Operacion='07' And Numero_Documento='" & Devengado & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden_2(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0101", "08", "H", "25", Devengado, Ds.Tables(0).Rows(Recorrido).Item("IGV"))
            Next
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_Cuenta_Orden_2(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0102", "08", "D", "25", Devengado, Ds.Tables(0).Rows(Recorrido).Item("IGV"))
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Ejecutar_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden_Devengado(ByVal Año_Ejecucion As String, ByVal Correlativo As String, ByVal Devengado As String, ByVal Orden As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Correlativo='" & Correlativo & "' And Numero='" & Orden & "' And Codigo_Tipo_Operacion='08' And Numero_Documento='" & Devengado & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0101", "09", "H", "26", Devengado)
            Next
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0102", "09", "D", "26", Devengado)
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Nuevo_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal Costo As Double, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Naturaleza As String, ByVal Codigo_Tipo_Operacion As String, ByVal Numero_Documento As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.Parameters.AddWithValue("@Mayor", Mayor)
        Cm.Parameters.AddWithValue("@Sub_Cuenta", Sub_Cuenta)
        Cm.Parameters.AddWithValue("@Naturaleza", Naturaleza)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Ejecutar_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden(ByVal Año_Ejecucion As String, ByVal Operacion As String, ByVal Orden As String, ByVal Tipo_Cambio As Double)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Temporal_Detalle_Ejecucion_Orden_Servicio Where Año_Ejecucion='" & Año_Ejecucion & "' And Operacion='" & Operacion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0101", "09", "D", "24", Orden)
            Next
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Orden_Servicio_Centro_Costos_Cuenta_Orden(Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString, Orden, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Cantidad").ToString), Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Costo").ToString) * Tipo_Cambio, "0102", "09", "H", "24", Orden)
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Copiar_Data_Catalogo_BS_Portapapeles(ByVal Tipo As Integer, ByVal Codigo As String, ByVal Campo As String)
        Select Case Tipo
            Case 1
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Bienes Where Codigo='" & Codigo.Trim & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    My.Computer.Clipboard.SetText(Ds.Tables(0).Rows(0).Item(Campo).ToString)
                Else
                    My.Computer.Clipboard.Clear()
                End If
            Case 2
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Catalogo_Servicios Where Codigo='" & Codigo.Trim & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    My.Computer.Clipboard.SetText(Ds.Tables(0).Rows(0).Item(Campo).ToString)
                Else
                    My.Computer.Clipboard.Clear()
                End If
        End Select
    End Sub
    Public Sub Cargar_Devengados_Para_Girar(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, Optional ByVal Caja_Codigo_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Contrato As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Notas As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Tipo_Cambio As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Procedimiento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion As Año,Numero,CONVERT(VarChar(10),FechaEmision,103) As Emision,Monto_Total as Monto,Saldo,Compromiso As [Exp.],Certificado,Nombre_Tipo_Documento As [Tipo Documento],Numero_Documento as [N.Doc.],Abreviatura as Comprobante,Serie_Comprobante As Serie,Numero_Comprobante As [Num.Com.],Ruc_Proveedor As RUC,Razon_Social as Proveedor,Codigo_Tipo_Documento From Lista_Devengados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Expediente As String = ""
        Dim Codigo_Tipo_Documento As String = ""
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Expediente = Ds.Tables(0).Rows(0).Item("Exp.").ToString
            Codigo_Tipo_Documento = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Documento").ToString
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Exp.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo Documento").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("N.Doc.").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Comprobante").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Serie").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Num.Com.").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("RUC").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Proveedor").ToString
            Next
        End If
        Select Case Codigo_Tipo_Documento
            Case "08"
                Ds = Nothing
                Da = Nothing
                If Expediente.Trim.Length > 0 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ordenes_Compra_Basica_2 Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                    If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Moneda").ToString
                    If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = Ds.Tables(0).Rows(0).Item("Contrato").ToString
                    If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                    If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Tipo_Cambio").ToString), "###,###,#.000")
                    If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = Ds.Tables(0).Rows(0).Item("Procedimiento").ToString
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "09"
                Ds = Nothing
                Da = Nothing
                If Expediente.Trim.Length > 0 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Ordenes_Servicio_Basica_2 Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                    If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Moneda").ToString
                    If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = Ds.Tables(0).Rows(0).Item("Contrato").ToString
                    If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                    If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Tipo_Cambio").ToString), "###,###,#.000")
                    If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = Ds.Tables(0).Rows(0).Item("Procedimiento").ToString
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "22"
                Ds = Nothing
                Da = Nothing
                If Expediente.Trim.Length > 0 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                    If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
                    If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = "[N/A]"
                    If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
                    If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Format(Convert.ToDouble(1), "###,###,#.000")
                    If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = "[N/A]"
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "23"
                Ds = Nothing
                Da = Nothing
                If Expediente.Trim.Length > 0 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                    If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Plural_Moneda").ToString
                    If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = "[N/A]"
                    If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
                    If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Format(Convert.ToDouble(1), "###,###,#.000")
                    If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = "[N/A]"
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "19"
                Ds = Nothing
                Da = Nothing
                If Expediente.Trim.Length > 0 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Planillas_Basica_Detallada_Resumen Where Año_Ejecucion='" & Año_Ejecucion & "' And Compromiso='" & Expediente & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                    If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Nombre_Moneda").ToString
                    If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = "[N/A]"
                    If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
                    If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Format(Convert.ToDouble(1), "###,###,#.000")
                    If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = "[N/A]"
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "31"
                Ds = Nothing
                Da = Nothing
                If Expediente.Trim.Length > 0 Then
                    'Da = New OleDb.OleDbDataAdapter("Select * From Lista_Pagos_Varios_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'", Cn)
                    Da = New OleDb.OleDbDataAdapter("exec USP_Lista_Pagos_Varios_Basica_Detallada '" & Año_Ejecucion & "','" & Expediente & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                    If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Nombre_Moneda").ToString
                    If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = "[N/A]"
                    If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                    If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Format(Convert.ToDouble(1), "###,###,#.000")
                    If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = "[N/A]"
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "34"
                Ds = Nothing
                Da = Nothing
                If Expediente.Trim.Length > 0 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Encargo_Interno_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                    If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Nombre_Moneda").ToString
                    If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = "[N/A]"
                    If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
                    If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Format(Convert.ToDouble(1), "###,###,#.000")
                    If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = "[N/A]"
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
            Case "41"
                Ds = Nothing
                Da = Nothing
                If Expediente.Trim.Length > 0 Then
                    Da = New OleDb.OleDbDataAdapter("Select * From Lista_Contratos_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Expediente='" & Expediente & "'", Cn)
                    Ds = New Data.DataSet
                    Da.Fill(Ds)
                    If TypeOf Caja_Codigo_Moneda Is System.Windows.Forms.TextBox Then Caja_Codigo_Moneda.Text = Ds.Tables(0).Rows(0).Item("Codigo_Moneda").ToString
                    If TypeOf Caja_Moneda Is System.Windows.Forms.TextBox Then Caja_Moneda.Text = Ds.Tables(0).Rows(0).Item("Nombre_Moneda").ToString
                    If TypeOf Caja_Contrato Is System.Windows.Forms.TextBox Then Caja_Contrato.Text = "[N/A]"
                    If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then Caja_Notas.Text = "CONTRATACION DE LOCACION DE SERVICIO"
                    If TypeOf Caja_Tipo_Cambio Is System.Windows.Forms.TextBox Then Caja_Tipo_Cambio.Text = Format(Convert.ToDouble(1), "###,###,#.000")
                    If TypeOf Caja_Procedimiento Is System.Windows.Forms.TextBox Then Caja_Procedimiento.Text = "[N/A]"
                    If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
                End If
        End Select

    End Sub
    Public Function Verificar_Glosas_Devengados(ByVal Año_Ejecución As String, ByVal DataGridView As System.Windows.Forms.DataGridView) As String
        Dim Cadena As String = ""

        Dim Glosa As String = ""
        For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
            Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(1).Value & "',"
        Next
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Devengados_Basica Where Año_ejecucion='" & Año_Ejecución & "' And Numero In(" & Cadena & ") And Saldo>0", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Glosa = Glosa & "- NOTA CONTABILIDAD N° " & Recorrido + 1 & ":" & Ds.Tables(0).Rows(Recorrido).Item("Notas").ToString & vbNewLine
            Next
        Else
            Glosa = ""
        End If
        Return Glosa
    End Function
    Public Sub Cargar_Detalle_Devengados_Para_Girar(ByVal Año_Ejecución As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal DataGridView2 As System.Windows.Forms.DataGridView, ByVal Tipo_Operacion As String)
        Dim Cadena As String = ""

        For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
            Cadena = Cadena & "'" & DataGridView.Rows(Recorrido).Cells(1).Value & "',"
        Next
        Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Devengados_Movimientos_Reportar Where Año_ejecucion='" & Año_Ejecución & "' And Numero In(" & Cadena & ") And Saldo>0", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView2.Rows.Add()
                DataGridView2.Item(0, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView2.Item(1, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView2.Item(2, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString & " - " & Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView2.Item(3, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView2.Item(4, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView2.Item(5, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView2.Item(6, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView2.Item(7, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView2.Item(8, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView2.Item(9, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & " - " & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView2.Item(10, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView2.Item(11, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Recurso").ToString
                DataGridView2.Item(12, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView2.Item(13, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView2.Item(14, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView2.Item(15, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView2.Item(16, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView2.Item(17, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView2.Item(18, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView2.Item(19, DataGridView2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                DataGridView2.Item(20, DataGridView2.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                DataGridView2.Item(21, DataGridView2.Rows.Count - 1).Value = Format(0, "###,###,#.00")
            Next
        End If
    End Sub
    Public Sub Nuevo_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Notas As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Giro As String, ByVal Monto_Total As Double, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String, ByVal Compromiso As String, ByVal Tipo_Cambio As Double, ByVal Codigo_Moneda As String, ByVal Certificado As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Tipo_Pago As String, ByVal Codigo_Cuenta_Bancaria As String, ByVal Codigo_Tipo_Cheque As String, ByVal Codigo_Banco_Cheque As String, ByVal Numero_Cheque As String, ByVal Retenciones As Boolean, ByVal Total_Girado As Double, ByVal Deducciones As Double, ByVal Liquido_Pagar As Double, ByVal Codigo_Cuenta_Bancaria_Cheque As String, ByVal Documento_Sustentatorio As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Girado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Giro", Codigo_Estado_Giro)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Compromiso", Compromiso)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Pago", Codigo_Tipo_Pago)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria", Codigo_Cuenta_Bancaria)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Cheque", Codigo_Tipo_Cheque)
        Cm.Parameters.AddWithValue("@Codigo_Banco_Cheque", Codigo_Banco_Cheque)
        Cm.Parameters.AddWithValue("@Numero_Cheque", Numero_Cheque)
        Cm.Parameters.AddWithValue("@Retenciones", Retenciones)
        Cm.Parameters.AddWithValue("@Total_Girado", Total_Girado)
        Cm.Parameters.AddWithValue("@Deducciones", Deducciones)
        Cm.Parameters.AddWithValue("@Liquido_Pagar", Liquido_Pagar)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria_Cheque", Codigo_Cuenta_Bancaria_Cheque)
        Cm.Parameters.AddWithValue("@Documento_Sustentatorio", Documento_Sustentatorio)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Girado_Garantias(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Notas As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Giro As String, ByVal Monto_Total As Double, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String, ByVal Compromiso As String, ByVal Tipo_Cambio As Double, ByVal Codigo_Moneda As String, ByVal Certificado As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Tipo_Pago As String, ByVal Codigo_Cuenta_Bancaria As String, ByVal Codigo_Tipo_Cheque As String, ByVal Codigo_Banco_Cheque As String, ByVal Numero_Cheque As String, ByVal Retenciones As Boolean, ByVal Total_Girado As Double, ByVal Deducciones As Double, ByVal Liquido_Pagar As Double, ByVal Codigo_Cuenta_Bancaria_Cheque As String, ByVal Documento_Sustentatorio As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Girado_Garantias"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Giro", Codigo_Estado_Giro)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Compromiso", Compromiso)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Pago", Codigo_Tipo_Pago)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria", Codigo_Cuenta_Bancaria)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Cheque", Codigo_Tipo_Cheque)
        Cm.Parameters.AddWithValue("@Codigo_Banco_Cheque", Codigo_Banco_Cheque)
        Cm.Parameters.AddWithValue("@Numero_Cheque", Numero_Cheque)
        Cm.Parameters.AddWithValue("@Retenciones", Retenciones)
        Cm.Parameters.AddWithValue("@Total_Girado", Total_Girado)
        Cm.Parameters.AddWithValue("@Deducciones", Deducciones)
        Cm.Parameters.AddWithValue("@Liquido_Pagar", Liquido_Pagar)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria_Cheque", Codigo_Cuenta_Bancaria_Cheque)
        Cm.Parameters.AddWithValue("@Documento_Sustentatorio", Documento_Sustentatorio)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Girado_Garantias(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Notas As String, ByVal Codigo_Estado_Giro As String, ByVal Monto_Total As Double, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String, ByVal Compromiso As String, ByVal Tipo_Cambio As Double, ByVal Codigo_Moneda As String, ByVal Certificado As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Tipo_Pago As String, ByVal Codigo_Cuenta_Bancaria As String, ByVal Codigo_Tipo_Cheque As String, ByVal Codigo_Banco_Cheque As String, ByVal Numero_Cheque As String, ByVal Retenciones As Boolean, ByVal Total_Girado As Double, ByVal Deducciones As Double, ByVal Liquido_Pagar As Double, ByVal Codigo_Cuenta_Bancaria_Cheque As String, ByVal Documento_Sustentatorio As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Girado_Garantias"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Giro", Codigo_Estado_Giro)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Compromiso", Compromiso)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Pago", Codigo_Tipo_Pago)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria", Codigo_Cuenta_Bancaria)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Cheque", Codigo_Tipo_Cheque)
        Cm.Parameters.AddWithValue("@Codigo_Banco_Cheque", Codigo_Banco_Cheque)
        Cm.Parameters.AddWithValue("@Numero_Cheque", Numero_Cheque)
        Cm.Parameters.AddWithValue("@Retenciones", Retenciones)
        Cm.Parameters.AddWithValue("@Total_Girado", Total_Girado)
        Cm.Parameters.AddWithValue("@Deducciones", Deducciones)
        Cm.Parameters.AddWithValue("@Liquido_Pagar", Liquido_Pagar)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria_Cheque", Codigo_Cuenta_Bancaria_Cheque)
        Cm.Parameters.AddWithValue("@Documento_Sustentatorio", Documento_Sustentatorio)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Notas As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Giro As String, ByVal Monto_Total As Double, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String, ByVal Compromiso As String, ByVal Tipo_Cambio As Double, ByVal Codigo_Moneda As String, ByVal Certificado As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Tipo_Pago As String, ByVal Codigo_Cuenta_Bancaria As String, ByVal Codigo_Tipo_Cheque As String, ByVal Codigo_Banco_Cheque As String, ByVal Numero_Cheque As String, ByVal Retenciones As Boolean, ByVal Total_Girado As Double, ByVal Deducciones As Double, ByVal Liquido_Pagar As Double, ByVal Codigo_Cuenta_Bancaria_Cheque As String, ByVal Documento_Sustentatorio As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Girado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@Monto_Total", Monto_Total)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Compromiso", Compromiso)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Pago", Codigo_Tipo_Pago)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria", Codigo_Cuenta_Bancaria)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Cheque", Codigo_Tipo_Cheque)
        Cm.Parameters.AddWithValue("@Codigo_Banco_Cheque", Codigo_Banco_Cheque)
        Cm.Parameters.AddWithValue("@Numero_Cheque", Numero_Cheque)
        Cm.Parameters.AddWithValue("@Retenciones", Retenciones)
        Cm.Parameters.AddWithValue("@Total_Girado", Total_Girado)
        Cm.Parameters.AddWithValue("@Deducciones", Deducciones)
        Cm.Parameters.AddWithValue("@Liquido_Pagar", Liquido_Pagar)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria_Cheque", Codigo_Cuenta_Bancaria_Cheque)
        Cm.Parameters.AddWithValue("@Documento_Sustentatorio", Documento_Sustentatorio)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Girado_2(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Pago As String, ByVal Codigo_Cuenta_Bancaria As String, ByVal Codigo_Tipo_Cheque As String, ByVal Codigo_Banco_Cheque As String, ByVal Numero_Cheque As String, ByVal Codigo_Cuenta_Bancaria_Cheque As String, ByVal Operacion As String, ByVal Fecha_Operacion As Date)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Girado_2"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Pago", Codigo_Tipo_Pago)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria", Codigo_Cuenta_Bancaria)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Cheque", Codigo_Tipo_Cheque)
        Cm.Parameters.AddWithValue("@Codigo_Banco_Cheque", Codigo_Banco_Cheque)
        Cm.Parameters.AddWithValue("@Numero_Cheque", Numero_Cheque)
        Cm.Parameters.AddWithValue("@Codigo_Cuenta_Bancaria_Cheque", Codigo_Cuenta_Bancaria_Cheque)
        Cm.Parameters.AddWithValue("@Operacion", Operacion)
        Cm.Parameters.AddWithValue("@Fecha_Operacion", Fecha_Operacion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Girado(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Girado Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Girado = Right("00000" & Numero.ToString, 5)
        Return Generar_Numero_Girado
    End Function
    Public Function Generar_Numero_Correlativo_Girado(ByVal Año_Ejecucion As String, ByVal Numero_Girado As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Girado & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Girado = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Girado
    End Function
    Public Sub Nuevo_Detalle_Girado_Movimientos(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Codigo_Documento As String, ByVal Numero_Documento As String, ByVal Codigo_Estado_Girado_Movimientos As String, ByVal Codigo_Tipo_Recurso As String, ByVal Certificado As String, ByVal Devengado As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Girado_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Documento", Codigo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Girado_Movimientos", Codigo_Estado_Girado_Movimientos)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Devengado", Devengado)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Codigo_Tipo_Recurso As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Girado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Pagar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar_Comprobante As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir_Comprobante As DevComponents.DotNetBar.ButtonItem, ByVal Asiento_Girado As DevComponents.DotNetBar.ButtonItem, ByVal Liberar_Asiento As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar_Comprobante_Pago As DevComponents.DotNetBar.ButtonItem, ByVal Modificar_Comprobante As DevComponents.DotNetBar.ButtonItem, ByVal Retrotaer_Operacion As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Giro").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Anular.Enabled = True
                    Reenumerar.Enabled = True
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Pagar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Visualizar_Comprobante.Enabled = False
                    Imprimir_Comprobante.Enabled = False
                    Asiento_Girado.Enabled = False
                    Liberar_Asiento.Enabled = False
                    Reenumerar_Comprobante_Pago.Enabled = False
                    Modificar_Comprobante.Enabled = False
                    Retrotaer_Operacion.Enabled = False
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Anular.Enabled = False
                    Reenumerar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Pagar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Visualizar_Comprobante.Enabled = False
                    Imprimir_Comprobante.Enabled = False
                    Asiento_Girado.Enabled = False
                    Liberar_Asiento.Enabled = False
                    Reenumerar_Comprobante_Pago.Enabled = False
                    Modificar_Comprobante.Enabled = False
                    Retrotaer_Operacion.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Anular.Enabled = False
                    Reenumerar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Pagar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Select Case Ds.Tables(0).Rows(0).Item("Asiento").ToString
                        Case "SI"
                            Asiento_Girado.Enabled = False
                            Liberar_Asiento.Enabled = True
                            Visualizar_Comprobante.Enabled = False
                            Imprimir_Comprobante.Enabled = False
                        Case "NO"
                            Asiento_Girado.Enabled = True
                            Liberar_Asiento.Enabled = False
                            Visualizar_Comprobante.Enabled = False
                            Imprimir_Comprobante.Enabled = False
                    End Select
                    Reenumerar_Comprobante_Pago.Enabled = False
                    Modificar_Comprobante.Enabled = False
                    Retrotaer_Operacion.Enabled = False
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Anular.Enabled = False
                    Reenumerar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Pagar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Select Case Ds.Tables(0).Rows(0).Item("Asiento").ToString
                        Case "SI"
                            Asiento_Girado.Enabled = False
                            Liberar_Asiento.Enabled = False
                            Visualizar_Comprobante.Enabled = True
                            Imprimir_Comprobante.Enabled = True
                        Case "NO"
                            Asiento_Girado.Enabled = False
                            Liberar_Asiento.Enabled = False
                            Visualizar_Comprobante.Enabled = True
                            Imprimir_Comprobante.Enabled = True
                    End Select
                    Reenumerar_Comprobante_Pago.Enabled = False
                    Modificar_Comprobante.Enabled = False
                    Retrotaer_Operacion.Enabled = True
                Case "05" 'PAGADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Anular.Enabled = False
                    Reenumerar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Pagar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Select Case Ds.Tables(0).Rows(0).Item("Asiento").ToString
                        Case "SI"
                            Asiento_Girado.Enabled = False
                            Liberar_Asiento.Enabled = True
                            Visualizar_Comprobante.Enabled = True
                            Imprimir_Comprobante.Enabled = True
                        Case "NO"
                            Asiento_Girado.Enabled = True
                            Liberar_Asiento.Enabled = False
                            Visualizar_Comprobante.Enabled = False
                            Imprimir_Comprobante.Enabled = False
                    End Select
                    Reenumerar_Comprobante_Pago.Enabled = True
                    Modificar_Comprobante.Enabled = True
                    Retrotaer_Operacion.Enabled = True
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Anular.Enabled = False
                    Reenumerar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Pagar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Visualizar_Comprobante.Enabled = False
                    Imprimir_Comprobante.Enabled = False
                    Asiento_Girado.Enabled = False
                    Liberar_Asiento.Enabled = False
                    Reenumerar_Comprobante_Pago.Enabled = False
                    Modificar_Comprobante.Enabled = False
                    Retrotaer_Operacion.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Autorizar_Girado(ByVal Codigo_Tipo_Documento_Girar As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Select Case Codigo_Tipo_Documento_Girar
            Case "08"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "23"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = Nothing
            Case "39"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='60'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "41"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Aprobar_Girado(ByVal Codigo_Tipo_Documento_Girar As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Select Case Codigo_Tipo_Documento_Girar
            Case "08"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "23"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "39"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='60'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "41"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Extornar_Girado(ByVal Codigo_Tipo_Documento_Girar As String, ByVal Año_Ejecucion As String, ByVal Numero As String)
        Select Case Codigo_Tipo_Documento_Girar
            Case "08"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='01',FechaAutorizacion=Null,UsuarioAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='01',FechaAutorizacion=Null,UsuarioAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='01',FechaAutorizacion=Null,UsuarioAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "23"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='01',FechaAutorizacion=Null,UsuarioAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='01',FechaAutorizacion=Null,UsuarioAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='01',FechaAutorizacion=Null,UsuarioAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='01',FechaAutorizacion=Null,UsuarioAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "39"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='01',FechaAutorizacion=Null,UsuarioAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='60'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "41"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='01',FechaAutorizacion=Null,UsuarioAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Anular_Girado(ByVal Codigo_Tipo_Documento_Girar As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Select Case Codigo_Tipo_Documento_Girar
            Case "08"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "23"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "39"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04',Monto=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='60'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "41"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Function Evaluar_Eliminacion_Giro(ByVal Año_Ejecucion As String, ByVal Numero As String) As Boolean
        Evaluar_Eliminacion_Giro = False
        If Evaluar_Eliminacion_Giro = False Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                If Ds.Tables(0).Rows(0).Item("Numero_Comprobante") Is DBNull.Value Then
                    Evaluar_Eliminacion_Giro = True
                Else
                    Evaluar_Eliminacion_Giro = False
                End If
            End If
        End If
        Return Evaluar_Eliminacion_Giro
    End Function
    Public Sub Eliminar_Girado(ByVal Codigo_Tipo_Documento_Girar As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Select Case Codigo_Tipo_Documento_Girar
                Case "08"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "09"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "22"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "23"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "19"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "31"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "34"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "39"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "41"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
            End Select
        Else
            Select Case Codigo_Tipo_Documento_Girar
                Case "08"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='29'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "09"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='30'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "22"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='41'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "23"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='42'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "19"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='34'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "31"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='45'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "34"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='54'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "39"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='60'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                Case "41"
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.Text
                    Cm.CommandText = "Delete From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='63'"
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
            End Select
        End If
    End Sub
    Public Sub Cargar_Data_Girado_Edicion(ByVal Año_Ejecucion As String, ByVal Numero As String, Optional ByVal DatagridView1 As System.Windows.Forms.DataGridView = Nothing, Optional ByVal Caja_Codigo_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Contrato As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Notas As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Tipo_Cambio As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Procedimiento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Notas_Giro As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Tipo_Pago As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Banco As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Numero_Cheque As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Cuenta As System.Windows.Forms.ComboBox = Nothing, Optional ByVal DataGridView As System.Windows.Forms.DataGridView = Nothing, Optional ByVal Combo_Cuenta_Cheque As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Documento_Sustentatorio As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select Distinct Devengado From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Variable_Numero_Devengado = Ds.Tables(0).Rows(Recorrido).Item("Devengado").ToString
                Me.Cargar_Devengados_Para_Girar(Año_Ejecucion, Variable_Numero_Devengado, DatagridView1, Caja_Codigo_Moneda, Caja_Moneda, Caja_Contrato, Caja_Notas, Caja_Tipo_Cambio, Caja_Procedimiento, Caja_Codigo_Proveedor)
            Next
        Else
            Exit Sub
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * from Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Caja_Notas_Giro Is System.Windows.Forms.TextBox Then
                Caja_Notas_Giro.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
            End If
            If TypeOf Combo_Tipo_Pago Is System.Windows.Forms.ComboBox Then
                Combo_Tipo_Pago.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Tipo_Pago").ToString
            End If
            If TypeOf Combo_Banco Is System.Windows.Forms.ComboBox Then
                Combo_Banco.Text = Ds.Tables(0).Rows(0).Item("Nombre_Banco").ToString
            End If
            If TypeOf Caja_Numero_Cheque Is System.Windows.Forms.TextBox Then
                Caja_Numero_Cheque.Text = Ds.Tables(0).Rows(0).Item("Numero_Cheque").ToString
            End If
            If TypeOf Combo_Cuenta Is System.Windows.Forms.ComboBox Then
                Combo_Cuenta.Text = Ds.Tables(0).Rows(0).Item("Numero_Cuenta_Formato").ToString
            End If
            If TypeOf Combo_Cuenta_Cheque Is System.Windows.Forms.ComboBox Then
                Combo_Cuenta_Cheque.Text = Ds.Tables(0).Rows(0).Item("Numero_Cuenta_Formato_Cheque_").ToString
            End If
            If TypeOf Caja_Documento_Sustentatorio Is System.Windows.Forms.TextBox Then
                Caja_Documento_Sustentatorio.Text = Ds.Tables(0).Rows(0).Item("Documento_Sustentatorio").ToString
            End If
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Data_Girado_Garantias_Edicion(ByVal Año_Ejecucion As String, ByVal Numero As String, Optional ByVal Caja_Notas As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Tipo_Pago As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Banco As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Numero_Cheque As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Cuenta As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Cuenta_Cheque As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Documento_Sustentatorio As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Total_Girado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Check_Retenciones As System.Windows.Forms.CheckBox = Nothing, Optional ByVal Caja_Deducciones As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Liquido_Pagar As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Unidad_Organica As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Fuente_Financiamiento As Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Rubro As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Secuencia_Funcional As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Actividad As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Tipo_Recurso As System.Windows.Forms.ComboBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Combo_Tipo_Pago Is System.Windows.Forms.ComboBox Then
                Combo_Tipo_Pago.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Tipo_Pago").ToString
            End If
            If TypeOf Combo_Banco Is System.Windows.Forms.ComboBox Then
                Combo_Banco.Text = Ds.Tables(0).Rows(0).Item("Nombre_Banco").ToString
            End If
            If TypeOf Caja_Numero_Cheque Is System.Windows.Forms.TextBox Then
                Caja_Numero_Cheque.Text = Ds.Tables(0).Rows(0).Item("Numero_Cheque").ToString
            End If
            If TypeOf Combo_Cuenta Is System.Windows.Forms.ComboBox Then
                Combo_Cuenta.Text = Ds.Tables(0).Rows(0).Item("Numero_Cuenta_Formato").ToString
            End If
            If TypeOf Combo_Cuenta_Cheque Is System.Windows.Forms.ComboBox Then
                Combo_Cuenta_Cheque.Text = Ds.Tables(0).Rows(0).Item("Numero_Cuenta_Formato_Cheque_").ToString
            End If
            If TypeOf Caja_Documento_Sustentatorio Is System.Windows.Forms.TextBox Then
                Caja_Documento_Sustentatorio.Text = Ds.Tables(0).Rows(0).Item("Documento_Sustentatorio").ToString
            End If
            If TypeOf Caja_Notas Is System.Windows.Forms.TextBox Then
                Caja_Notas.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
            End If
            If TypeOf Caja_Codigo_Proveedor Is System.Windows.Forms.TextBox Then
                Caja_Codigo_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
            End If
            If TypeOf Caja_Total_Girado Is System.Windows.Forms.TextBox Then
                Caja_Total_Girado.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Total_Girado").ToString), "###,###,#.00")
            End If
            If TypeOf Check_Retenciones Is System.Windows.Forms.CheckBox Then
                Check_Retenciones.Checked = Ds.Tables(0).Rows(0).Item("Retenciones")
            End If
            If TypeOf Caja_Deducciones Is System.Windows.Forms.TextBox Then
                Caja_Deducciones.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Deducciones").ToString), "###,###,#.00")
            End If
            If TypeOf Caja_Liquido_Pagar Is System.Windows.Forms.TextBox Then
                Caja_Liquido_Pagar.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Liquido_Pagar").ToString), "###,###,#.00")
            End If
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("select * from Lista_Detalle_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If TypeOf Combo_Unidad_Organica Is System.Windows.Forms.ComboBox Then
            Combo_Unidad_Organica.Text = Ds.Tables(0).Rows(0).Item("Nombre_Unidad_Organica").ToString
        End If
        If TypeOf Combo_Fuente_Financiamiento Is System.Windows.Forms.ComboBox Then
            Combo_Fuente_Financiamiento.Text = Ds.Tables(0).Rows(0).Item("Fuente").ToString
        End If
        If TypeOf Combo_Rubro Is System.Windows.Forms.ComboBox Then
            Combo_Rubro.Text = Ds.Tables(0).Rows(0).Item("Rubro").ToString
        End If
        If TypeOf Combo_Secuencia_Funcional Is System.Windows.Forms.ComboBox Then
            Combo_Secuencia_Funcional.Text = Ds.Tables(0).Rows(0).Item("Codigo_Secuencia_Funcional").ToString
        End If
        If TypeOf Combo_Actividad Is System.Windows.Forms.ComboBox Then
            Combo_Actividad.Text = Ds.Tables(0).Rows(0).Item("Actividad").ToString
        End If
        If TypeOf Combo_Tipo_Recurso Is System.Windows.Forms.ComboBox Then
            Combo_Tipo_Recurso.Text = Ds.Tables(0).Rows(0).Item("Tipo_Recurso").ToString
        End If
    End Sub
    Public Sub Cargar_Data_Girado_Edicion_Comprobante(ByVal Año_Ejecucion As String, ByVal Numero As String, Optional ByVal Caja_Codigo_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Contrato As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Notas As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Tipo_Cambio As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Procedimiento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Notas_Giro As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Tipo_Pago As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Banco As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Numero_Cheque As System.Windows.Forms.TextBox = Nothing, Optional ByVal Combo_Cuenta As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Combo_Cuenta_Cheque As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Caja_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Operacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Data_Fecha_Operacion As System.Windows.Forms.DateTimePicker = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Caja_Notas_Giro Is System.Windows.Forms.TextBox Then
                Caja_Notas_Giro.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
            End If
            If TypeOf Combo_Tipo_Pago Is System.Windows.Forms.ComboBox Then
                Combo_Tipo_Pago.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Tipo_Pago").ToString
            End If
            If TypeOf Combo_Banco Is System.Windows.Forms.ComboBox Then
                Combo_Banco.Text = Ds.Tables(0).Rows(0).Item("Nombre_Banco").ToString
            End If
            If TypeOf Caja_Numero_Cheque Is System.Windows.Forms.TextBox Then
                Caja_Numero_Cheque.Text = Ds.Tables(0).Rows(0).Item("Numero_Cheque").ToString
            End If
            If TypeOf Caja_Proveedor Is System.Windows.Forms.TextBox Then
                Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
            End If
            If TypeOf Combo_Cuenta Is System.Windows.Forms.ComboBox Then
                Combo_Cuenta.Text = Ds.Tables(0).Rows(0).Item("Numero_Cuenta_Formato").ToString
            End If
            If TypeOf Combo_Cuenta_Cheque Is System.Windows.Forms.ComboBox Then
                Combo_Cuenta_Cheque.Text = Ds.Tables(0).Rows(0).Item("Numero_Cuenta_Formato_Cheque_").ToString
            End If
            If TypeOf Caja_Operacion Is System.Windows.Forms.TextBox Then
                Caja_Operacion.Text = Ds.Tables(0).Rows(0).Item("Operacion").ToString
            End If
            If TypeOf Data_Fecha_Operacion Is System.Windows.Forms.DateTimePicker Then
                Data_Fecha_Operacion.Value = DateValue(Ds.Tables(0).Rows(0).Item("Fecha_Operacion").ToString)
            End If


        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Data_Girado_Edicion_Montos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DatagridView As System.Windows.Forms.DataGridView)

        For Recorrido As Integer = 0 To DatagridView.RowCount - 1
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Girado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Devengado='" & DatagridView.Rows(Recorrido).Cells(1).Value & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then

            End If





            '    Me.DataGridView1.Columns.Add("Año_Ejecucion", "Año")
            '    Me.DataGridView1.Columns.Add("Numero", "Numero")
            '    Me.DataGridView1.Columns.Add("Certificado", "Certificado")
            '    Me.DataGridView1.Columns.Add("Meta", "Meta")
            '    Me.DataGridView1.Columns.Add("C.Costos", "C.Costos")
            '    Me.DataGridView1.Columns.Add("Codigo_Unidad_Organica", "Codigo_Unidad_Organica")
            '    Me.DataGridView1.Columns.Add("Codigo_Actividad", "Codigo_Actividad")
            '    Me.DataGridView1.Columns.Add("Codigo_FF", "Codigo_FF")
            '    Me.DataGridView1.Columns.Add("Codigo_Rubro", "Codigo_Rubro")
            '    Me.DataGridView1.Columns.Add("Rubro", "Rubro")
            '    Me.DataGridView1.Columns.Add("Codigo_Tipo_Recurso", "Codigo_Tipo_Recurso")
            '    Me.DataGridView1.Columns.Add("T.R.", "T.R.")
            '    Me.DataGridView1.Columns.Add("Tipo_Transaccion", "Tipo_Transaccion")
            '    Me.DataGridView1.Columns.Add("Generica", "Generica")
            '    Me.DataGridView1.Columns.Add("Sub_Generica", "Sub_Generica")
            '    Me.DataGridView1.Columns.Add("Sub_Generica_Detalle", "Sub_Generica_Detalle")
            '    Me.DataGridView1.Columns.Add("Especifica", "Especifica")
            '    Me.DataGridView1.Columns.Add("Especifica_Detalle", "Especifica_Detalle")
            '    Me.DataGridView1.Columns.Add("Clasificador", "Clasificador")
            '    Me.DataGridView1.Columns.Add("Descripcion", "Descripcion")
            '    Me.DataGridView1.Columns.Add("Saldo", "Saldo")
            '    Me.DataGridView1.Columns.Add("Girar", "Girar")
        Next
    End Sub
    Public Sub Cargar_Devengados_Para_Girar_Masivo(ByVal Año_Ejecucion As String, ByVal Cadena As String, ByVal DataGridView As System.Windows.Forms.DataGridView, Optional ByVal Caja_Codigo_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Moneda As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Contrato As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Notas As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Tipo_Cambio As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Procedimiento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Proveedor As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion As Año,Numero,CONVERT(VarChar(10),FechaEmision,103) As Emision,Monto_Total as Monto,Saldo,Compromiso As [Exp.],Certificado,Nombre_Tipo_Documento As [Tipo Documento],Numero_Documento as [N.Doc.],Abreviatura as Comprobante,Serie_Comprobante As Serie,Numero_Comprobante As [Num.Com.],Ruc_Proveedor As RUC,Razon_Social as Proveedor,Codigo_Tipo_Documento From Lista_Devengados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero In(" & Cadena & ") Order By Numero", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Emision").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Exp.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo Documento").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("N.Doc.").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Comprobante").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Serie").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Num.Com.").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("RUC").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Proveedor").ToString
            Next
        End If
    End Sub
    Public Function Determinar_Tipo_Pago(ByVal Año_Ejecucion As String, ByVal Numero As String) As String
        Determinar_Tipo_Pago = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Girados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Determinar_Tipo_Pago = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Pago").ToString
        End If
        Return Determinar_Tipo_Pago
    End Function
    Public Sub Modificar_IGV_Item_Orden_Compra_Temporal(ByVal Año_Ejecucion As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Operacion As String, ByVal IGV As Boolean)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        If IGV = True Then
            Cm.CommandText = "Update Temporal_Detalle_Ejecucion_Orden_Compra Set IGV=1 Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Grupo='" & Codigo_Grupo & "' And Codigo_Clase='" & Codigo_Clase & "' And Codigo_Familia='" & Codigo_Familia & "' And Codigo_Item='" & Codigo_Item & "' And Operacion='" & Operacion & "'"
        Else
            Cm.CommandText = "Update Temporal_Detalle_Ejecucion_Orden_Compra Set IGV=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Grupo='" & Codigo_Grupo & "' And Codigo_Clase='" & Codigo_Clase & "' And Codigo_Familia='" & Codigo_Familia & "' And Codigo_Item='" & Codigo_Item & "' And Operacion='" & Operacion & "'"
        End If
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Recalculo_Detalle_Orden_Compra(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)

        For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Catalogo='01' And Codigo_Grupo='" & DataGridView.Rows(Recorrido).Cells(0).Value & "' And Codigo_Clase='" & DataGridView.Rows(Recorrido).Cells(1).Value & "' And Codigo_Familia='" & DataGridView.Rows(Recorrido).Cells(2).Value & "' And Codigo_Item='" & DataGridView.Rows(Recorrido).Cells(3).Value & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                DataGridView.Rows(Recorrido).Cells(11).Value = Ds.Tables(0).Rows(0).Item("IGV")
            End If
        Next
    End Sub
    Public Sub Nuevo_Detalle_Devengado_Cuenta_Patrimonial(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Tipo_Recurso As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Naturaleza As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Devengado_Cuenta_Patrimonial"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Mayor", Mayor)
        Cm.Parameters.AddWithValue("@Sub_Cuenta", Sub_Cuenta)
        Cm.Parameters.AddWithValue("@Naturaleza", Naturaleza)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Girado_Cuenta_Patrimonial(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Tipo_Recurso As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Naturaleza As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Girado_Cuenta_Patrimonial"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Mayor", Mayor)
        Cm.Parameters.AddWithValue("@Sub_Cuenta", Sub_Cuenta)
        Cm.Parameters.AddWithValue("@Naturaleza", Naturaleza)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Devengado_Cuenta_Retenciones(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Tipo_Recurso As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Naturaleza As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Devengado_Cuenta_Retenciones"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Mayor", Mayor)
        Cm.Parameters.AddWithValue("@Sub_Cuenta", Sub_Cuenta)
        Cm.Parameters.AddWithValue("@Naturaleza", Naturaleza)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Devengado_Cuenta_Presupuestal(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Tipo_Recurso As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Naturaleza As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Devengado_Cuenta_Presupuestal"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Mayor", Mayor)
        Cm.Parameters.AddWithValue("@Sub_Cuenta", Sub_Cuenta)
        Cm.Parameters.AddWithValue("@Naturaleza", Naturaleza)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Devengado_Cuenta_Orden(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Catalogo As String, ByVal Codigo_Grupo As String, ByVal Codigo_Clase As String, ByVal Codigo_Familia As String, ByVal Codigo_Item As String, ByVal Cantidad As Double, ByVal IGV As Boolean, ByVal Codigo_Tipo_Recurso As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Naturaleza As String, ByVal Costo As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Devengado_Cuenta_Orden"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Catalogo", Codigo_Catalogo)
        Cm.Parameters.AddWithValue("@Codigo_Grupo", Codigo_Grupo)
        Cm.Parameters.AddWithValue("@Codigo_Clase", Codigo_Clase)
        Cm.Parameters.AddWithValue("@Codigo_Familia", Codigo_Familia)
        Cm.Parameters.AddWithValue("@Codigo_Item", Codigo_Item)
        Cm.Parameters.AddWithValue("@Cantidad", Cantidad)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Mayor", Mayor)
        Cm.Parameters.AddWithValue("@Sub_Cuenta", Sub_Cuenta)
        Cm.Parameters.AddWithValue("@Naturaleza", Naturaleza)
        Cm.Parameters.AddWithValue("@Costo", Costo)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Establecer_Asiento_Contable_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Asiento As Boolean)
        If Asiento = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Update Devengado Set Asiento=1 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Update Devengado Set Asiento=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Establecer_Asiento_Contable_Girado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Asiento As Boolean)
        If Asiento = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Update Girado Set Asiento=1 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Update Girado Set Asiento=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Ejecucion_Nuevo_Detalle_Devengado_Cuenta_Orden(ByVal Operacion As Integer, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Naturaleza As String)
        Dim Certificado As String = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Certificado = Ds.Tables(0).Rows(0).Item("Certificado").ToString
        End If
        Ds = Nothing
        Da = Nothing
        Select Case Operacion
            Case 1
                Da = New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And  Numero_Documento ='" & Numero & "' And Codigo_Tipo_Operacion In ('07','08') ", Cn)
                Ds = New Data.DataSet

                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Cuenta_Orden(Año_Ejecucion, Numero _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Cantidad"), Ds.Tables(0).Rows(Recorrido).Item("IGV"), Me.Determinar_Tipo_Recurso_Generando_Orden_Compra(Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")) _
                        , Mayor, Sub_Cuenta, Naturaleza, Ds.Tables(0).Rows(Recorrido).Item("Costo"))
                    Next
                End If
                Ds = Nothing
                Da = Nothing
            Case 2
                Da = New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And  Numero_Documento ='" & Numero & "' And Codigo_Tipo_Operacion In ('07','08') ", Cn)
                Ds = New Data.DataSet

                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Devengado_Cuenta_Orden(Año_Ejecucion, Numero _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item") _
                        , Ds.Tables(0).Rows(Recorrido).Item("Cantidad"), True, Me.Determinar_Tipo_Recurso_Generando_Orden_Servicio(Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad")) _
                        , Mayor, Sub_Cuenta, Naturaleza, Ds.Tables(0).Rows(Recorrido).Item("Costo"))
                    Next
                End If
                Ds = Nothing
                Da = Nothing
        End Select
    End Sub
    Public Function Generar_Numero_Comprobante_Pago(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Comprobante_Pago = Right("000000" & Numero.ToString, 6)
        Return Generar_Numero_Comprobante_Pago
    End Function
    Public Sub Nuevo_Comprobante_Pago(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Giro As String, ByVal Codigo_Proveedor As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Comprobante As String, ByVal Monto As Double, ByVal Deducciones As Double, ByVal Total_Pagar As Double, ByVal Letras As String, Optional ByVal Operacion As String = Nothing, Optional ByVal Fecha_Operacion As Date = Nothing, Optional ByVal Retenciones As Boolean = Nothing, Optional ByVal Año_Ejecucion_Referido As String = Nothing)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Comprobante_Pago"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Numero_Giro", Numero_Giro)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Comprobante", Codigo_Estado_Comprobante)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Deducciones", Deducciones)
        Cm.Parameters.AddWithValue("@Total_Pagar", Total_Pagar)
        Cm.Parameters.AddWithValue("@Letras", Letras)
        Cm.Parameters.AddWithValue("@Fecha_Operacion", Fecha_Operacion)
        Cm.Parameters.AddWithValue("@Retenciones", Retenciones)
        Cm.Parameters.AddWithValue("@Año_Ejecucion_Referido", Año_Ejecucion_Referido)
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Girado Set Operacion='" & Operacion & "',Codigo_Estado_Giro='05',Numero_Comprobante='" & Numero & "',Fecha_Emision_Comprobante='" & FechaEmision & "',Fecha_Operacion='" & Fecha_Operacion & "'  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Giro & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='05' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Giro & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Cargar_Certificado_Planillas(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If Me.Verificar_Duplicidad_Grid_Global(1, Numero, DataGridView) = True Then
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(0).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Saldo").ToString), "###,###,#.00")
            Else
                MessageBox.Show("El Certificado Seleccionado ya se encuentra en el Detalle", "Certificados", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If
        End If
    End Sub
    Public Function Mostrar_Descripcion_Cuenta_Contable(ByVal Año_Ejecucion As String, ByVal Cuenta As String) As String
        Mostrar_Descripcion_Cuenta_Contable = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Plan_Cuentas Where Año_Ejecucion='" & Año_Ejecucion & "' And Cuenta='" & Cuenta & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Mostrar_Descripcion_Cuenta_Contable = Ds.Tables(0).Rows(0).Item("Nombre_Sub_Cuenta").ToString
        Else
            Mostrar_Descripcion_Cuenta_Contable = "No Existe Descripción de la Cuenta Seleccionada"
        End If
        Return Mostrar_Descripcion_Cuenta_Contable
    End Function
    Public Sub Nueva_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Planilla As String, ByVal Codigo_Mes As String, ByVal Notas As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Planilla As String, ByVal Monto_Planilla As Double, ByVal Certificado As String, ByVal Documento As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Planilla"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Planilla", Codigo_Tipo_Planilla)
        Cm.Parameters.AddWithValue("@Codigo_Mes", Codigo_Mes)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Planilla", Codigo_Estado_Planilla)
        Cm.Parameters.AddWithValue("@Monto_Planilla", Monto_Planilla)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Planilla As String, ByVal Codigo_Mes As String, ByVal Notas As String, ByVal Codigo_Estado_Planilla As String, ByVal Monto_Planilla As Double, ByVal Certificado As String, ByVal Documento As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Planilla"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Planilla", Codigo_Tipo_Planilla)
        Cm.Parameters.AddWithValue("@Codigo_Mes", Codigo_Mes)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Planilla", Codigo_Estado_Planilla)
        Cm.Parameters.AddWithValue("@Monto_Planilla", Monto_Planilla)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Planilla"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Planilla_Movimientos(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Numero_Documento As String, ByVal Monto As Double, ByVal Codigo_Estado_Planilla_Movimientos As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Planilla_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Planilla_Movimientos", Codigo_Estado_Planilla_Movimientos)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Planilla(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select IsNull(Max(Abs(Numero)+1),1) As Numero From Planilla Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Planilla = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Planilla
    End Function
    Public Function Generar_Numero_Correlativo_Planilla(ByVal Año_Ejecucion As String, ByVal Numero_Planilla As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Planilla_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Planilla & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Planilla = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Planilla
    End Function
    Public Sub Ejecutar_Movimiento_Certificado_Planilla(ByVal Año_Ejecucion As String, ByVal Planilla As String, ByVal Certificado As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad, Monto,Codigo_Tipo_Recurso From Detalle_Planilla_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Planilla & "' And Certificado='" & Certificado & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Correlativo As String = Me.Generar_Numero_Correlativo_Certificado(My.Settings.Año_Ejecucion, Certificado)
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Me.Nuevo_Detalle_Certificado_Movimiento(Correlativo, "32", Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Planilla, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString) * -1, "01", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString)
            Next
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Autorizar_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Planilla Set Codigo_Estado_Planilla='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Planilla_Movimientos Set Codigo_Estado_Planilla_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='32'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='32'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Planilla Set Codigo_Estado_Planilla='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Planilla_Movimientos Set Codigo_Estado_Planilla_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='32'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='32'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Planilla Set Codigo_Estado_Planilla='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Planilla_Movimientos Set Codigo_Estado_Planilla_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='32'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='32'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Planilla Set Codigo_Estado_Planilla='01',FechaAprobacion=Null,UsuarioAprobacion=Null,FechaAutorizacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Planilla_Movimientos Set Codigo_Estado_Planilla_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='32'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='32'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Planillas_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Planilla").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
            End Select
        End If
    End Sub
    Public Sub Eliminar_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='32'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Planilla_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='32'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Planilla Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Planilla Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='32'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Planilla_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='32'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Planilla Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Consulta_Mes_Comprobantes_Faltantes(ByVal Año_Ejecucion As String, ByVal Codigo_Mes As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Label_Rango_Inicial As System.Windows.Forms.Label, ByVal Label_Rango_Final As System.Windows.Forms.Label, ByVal Label_Registros As System.Windows.Forms.Label)
        Dim Rango_Inicial As Double = 0
        Dim Rango_Final As Double = 0

        Dim Da As New OleDb.OleDbDataAdapter("Select IsNull(Min(Abs(Numero)) ,0)As Numero From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And MONTH(FechaEmision)='" & Codigo_Mes & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Rango_Inicial = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Else
            Rango_Inicial = 0
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select IsNull(Max(Abs(Numero)) ,0)As Numero From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And MONTH(FechaEmision)='" & Codigo_Mes & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Rango_Final = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Else
            Rango_Final = 0
        End If
        Ds = Nothing
        Da = Nothing
        If Rango_Inicial > 0 Then
            Da = New OleDb.OleDbDataAdapter("Listar_Espacios_Comprobantes '" & Año_Ejecucion & "'," & Rango_Inicial & "," & Rango_Final, Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds, "Listar_Espacios_Comprobantes")
            DataGridView.Rows.Clear()
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridView.Rows.Add()
                    DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo").ToString
                    DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                    DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                Next
                Label_Rango_Inicial.Text = Rango_Inicial.ToString
                Label_Rango_Final.Text = Rango_Final.ToString
                Label_Registros.Text = Ds.Tables(0).Rows.Count.ToString
            Else
                MessageBox.Show("¡¡¡Felicitaciones!!!, No se han Encontrado Comprobantes de Pago Sin Emisión", "Búsquedas Avanzadas...", MessageBoxButtons.OK, MessageBoxIcon.Information)
                DataGridView.Rows.Clear()
                Label_Rango_Inicial.Text = String.Empty
                Label_Rango_Final.Text = String.Empty
                Label_Registros.Text = String.Empty
            End If
        Else
            MessageBox.Show("No se han Emitido Comprobantes de Pago en el Rango Seleccionado", "Búsquedas Avanzadas...", MessageBoxButtons.OK, MessageBoxIcon.Information)
            DataGridView.Rows.Clear()
            Label_Rango_Inicial.Text = String.Empty
            Label_Rango_Final.Text = String.Empty
            Label_Registros.Text = String.Empty
            Exit Sub
        End If
    End Sub
    Public Sub Consulta_Rangos_Comprobantes_Faltantes(ByVal Año_Ejecucion As String, ByVal Rango_Inicial As Double, ByVal Rango_Final As Double, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Label_Rango_Inicial As System.Windows.Forms.Label, ByVal Label_Rango_Final As System.Windows.Forms.Label, ByVal Label_Registros As System.Windows.Forms.Label)
        If Rango_Inicial > 0 Then
            Dim Da As New OleDb.OleDbDataAdapter("Listar_Espacios_Comprobantes '" & Año_Ejecucion & "'," & Rango_Inicial & "," & Rango_Final, Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds, "Listar_Espacios_Comprobantes")
            DataGridView.Rows.Clear()
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridView.Rows.Add()
                    DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo").ToString
                    DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                    DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                Next
                Label_Rango_Inicial.Text = Rango_Inicial.ToString
                Label_Rango_Final.Text = Rango_Final.ToString
                Label_Registros.Text = Ds.Tables(0).Rows.Count.ToString
            Else
                MessageBox.Show("¡¡¡Felicitaciones!!!, No se han Encontrado Comprobantes de Pago Sin Emisión", "Búsquedas Avanzadas...", MessageBoxButtons.OK, MessageBoxIcon.Information)
                DataGridView.Rows.Clear()
                Label_Rango_Inicial.Text = String.Empty
                Label_Rango_Final.Text = String.Empty
                Label_Registros.Text = String.Empty
            End If
        Else
            MessageBox.Show("No se han Emitido Comprobantes de Pago en el Rango Seleccionado", "Búsquedas Avanzadas...", MessageBoxButtons.OK, MessageBoxIcon.Information)
            DataGridView.Rows.Clear()
            Label_Rango_Inicial.Text = String.Empty
            Label_Rango_Final.Text = String.Empty
            Label_Registros.Text = String.Empty
            Exit Sub
        End If
    End Sub
    Public Sub Consulta_Fechas_Comprobantes_Faltantes(ByVal Año_Ejecucion As String, ByVal Fecha_Inicial As Date, ByVal Fecha_Final As Date, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Label_Rango_Inicial As System.Windows.Forms.Label, ByVal Label_Rango_Final As System.Windows.Forms.Label, ByVal Label_Registros As System.Windows.Forms.Label)
        Dim Rango_Inicial As Double = 0
        Dim Rango_Final As Double = 0
        Dim Da As New OleDb.OleDbDataAdapter("Select IsNull(Min(Abs(Numero)) ,0)As Numero From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And FechaEmision Between '" & Fecha_Inicial & "' And '" & Fecha_Final & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Rango_Inicial = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Else
            Rango_Inicial = 0
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select IsNull(Max(Abs(Numero)) ,0)As Numero From Comprobante_Pago Where Año_Ejecucion='" & Año_Ejecucion & "' And FechaEmision Between '" & Fecha_Inicial & "' And '" & Fecha_Final & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Rango_Final = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Else
            Rango_Final = 0
        End If
        Ds = Nothing
        Da = Nothing
        If Rango_Inicial > 0 Then
            Da = New OleDb.OleDbDataAdapter("Listar_Espacios_Comprobantes '" & Año_Ejecucion & "'," & Rango_Inicial & "," & Rango_Final, Cn)
            Ds = New Data.DataSet
            Da.Fill(Ds, "Listar_Espacios_Comprobantes")
            DataGridView.Rows.Clear()
            If Ds.Tables(0).Rows.Count > 0 Then
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridView.Rows.Add()
                    DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo").ToString
                    DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                    DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                Next
                Label_Rango_Inicial.Text = Rango_Inicial.ToString
                Label_Rango_Final.Text = Rango_Final.ToString
                Label_Registros.Text = Ds.Tables(0).Rows.Count.ToString
            Else
                MessageBox.Show("¡¡¡Felicitaciones!!!, No se han Encontrado Comprobantes de Pago Sin Emisión", "Búsquedas Avanzadas...", MessageBoxButtons.OK, MessageBoxIcon.Information)
                DataGridView.Rows.Clear()
                Label_Rango_Inicial.Text = String.Empty
                Label_Rango_Final.Text = String.Empty
                Label_Registros.Text = String.Empty
            End If
        Else
            MessageBox.Show("No se han Emitido Comprobantes de Pago en el Rango Seleccionado", "Búsquedas Avanzadas...", MessageBoxButtons.OK, MessageBoxIcon.Information)
            DataGridView.Rows.Clear()
            Label_Rango_Inicial.Text = String.Empty
            Label_Rango_Final.Text = String.Empty
            Label_Registros.Text = String.Empty
            Exit Sub
        End If
    End Sub
    Public Sub Exportar_Lista_Comprobantes_No_Emitidos(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Tipo Documento"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "Año"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value
                Excel.Application.Range("A" & Recorrido + 1, "C" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 30
            Hoja.Range("B1").ColumnWidth = 12
            Hoja.Range("C1").ColumnWidth = 12
            Hoja.Range("A1", "C1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A2", "A" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlLeft
            Hoja.Range("B2", "B" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("C2", "C" & Recorrido + 2).WrapText = True
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE COMPROBANTES"
            Hoja.Range("A" & Recorrido + 2, "C" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "C" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Data_Comprobantes(ByVal Consulta As String)
        Dim Da As New OleDb.OleDbDataAdapter(Consulta, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Reporte Comprobantes"
            Excel.Application.Cells(1, "A") = "Nro."
            Excel.Application.Cells(1, "B") = "Fecha"
            Excel.Application.Cells(1, "C") = "Cheque"
            Excel.Application.Cells(1, "D") = "Operacion"
            Excel.Application.Cells(1, "E") = "RUC"
            Excel.Application.Cells(1, "F") = "Proveedor"
            Excel.Application.Cells(1, "G") = "Concepto"
            Excel.Application.Cells(1, "H") = "Doc.Sustentatorios"
            Excel.Application.Cells(1, "I") = "Tipo Documento"
            Excel.Application.Cells(1, "J") = "Número"
            Excel.Application.Cells(1, "K") = "C.Costos"
            Excel.Application.Cells(1, "L") = "C.C.P."
            Excel.Application.Cells(1, "M") = "Importe"
            Excel.Application.Cells(1, "N") = "Cta. Banco"
            Excel.Application.Cells(1, "O") = "Clasificador"
            Excel.Application.Cells(1, "P") = "FF"
            Excel.Application.Cells(1, "Q") = "RB"
            Excel.Application.Cells(1, "R") = "T.Recurso"
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Excel.Application.Cells(Recorrido + 2, "A") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                Excel.Application.Cells(Recorrido + 2, "B") = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                Excel.Application.Cells(Recorrido + 2, "C") = Ds.Tables(0).Rows(Recorrido).Item("Numero_Cheque").ToString
                Excel.Application.Cells(Recorrido + 2, "D") = Ds.Tables(0).Rows(Recorrido).Item("Operacion").ToString
                Excel.Application.Cells(Recorrido + 2, "E") = Ds.Tables(0).Rows(Recorrido).Item("Ruc_Proveedor").ToString
                Excel.Application.Cells(Recorrido + 2, "F") = Ds.Tables(0).Rows(Recorrido).Item("Razon_Social").ToString
                Excel.Application.Cells(Recorrido + 2, "G") = Ds.Tables(0).Rows(Recorrido).Item("Justificacion").ToString
                Excel.Application.Cells(Recorrido + 2, "H") = Ds.Tables(0).Rows(Recorrido).Item("Documento_Sustentatorio").ToString
                Excel.Application.Cells(Recorrido + 2, "I") = Ds.Tables(0).Rows(Recorrido).Item("Nombre_Tipo_Documento")
                Excel.Application.Cells(Recorrido + 2, "J") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero_Documento")
                Excel.Application.Cells(Recorrido + 2, "K") = Ds.Tables(0).Rows(Recorrido).Item("C.Costos")
                Excel.Application.Cells(Recorrido + 2, "L") = Ds.Tables(0).Rows(Recorrido).Item("Certificado")
                Excel.Application.Cells(Recorrido + 2, "M") = Ds.Tables(0).Rows(Recorrido).Item("Monto")
                Excel.Application.Cells(Recorrido + 2, "N") = Ds.Tables(0).Rows(Recorrido).Item("Numero_Cuenta")
                Excel.Application.Cells(Recorrido + 2, "O") = Ds.Tables(0).Rows(Recorrido).Item("Clasificador")
                Excel.Application.Cells(Recorrido + 2, "P") = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF")
                Excel.Application.Cells(Recorrido + 2, "Q") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro")
                Excel.Application.Cells(Recorrido + 2, "R") = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso")
                Excel.Application.Range("A" & Recorrido + 1, "R" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 6
            Hoja.Range("B1").ColumnWidth = 11
            Hoja.Range("C1").ColumnWidth = 11
            Hoja.Range("D1").ColumnWidth = 11
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 40
            Hoja.Range("G1").ColumnWidth = 50
            Hoja.Range("H1").ColumnWidth = 40
            Hoja.Range("I1").ColumnWidth = 25
            Hoja.Range("J1").ColumnWidth = 8
            Hoja.Range("K1").ColumnWidth = 13
            Hoja.Range("L1").ColumnWidth = 7
            Hoja.Range("M1").ColumnWidth = 10
            Hoja.Range("N1").ColumnWidth = 22
            Hoja.Range("O1").ColumnWidth = 12
            Hoja.Range("P1").ColumnWidth = 6
            Hoja.Range("Q1").ColumnWidth = 6
            Hoja.Range("R1").ColumnWidth = 12
            Hoja.Range("A1", "R1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("F2", "H" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "R" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("L2", "L" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("P2", "P" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("Q2", "Q" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("F2", "H" & Recorrido + 2).WrapText = True
            Hoja.Range("M2", "M" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE COMPROBANTES"
            Hoja.Range("A" & Recorrido + 2, "R" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "R" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Data_Comprobantes2(ByVal Consulta As String)
        Dim Da As New OleDb.OleDbDataAdapter(Consulta, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Reporte Comprobantes"
            Excel.Application.Cells(1, "A") = "Nro."
            Excel.Application.Cells(1, "B") = "Fecha"
            Excel.Application.Cells(1, "C") = "Cheque"
            Excel.Application.Cells(1, "D") = "Operacion"
            Excel.Application.Cells(1, "E") = "RUC"
            Excel.Application.Cells(1, "F") = "Proveedor"
            Excel.Application.Cells(1, "G") = "Concepto"
            Excel.Application.Cells(1, "H") = "Doc.Sustentatorios"
            Excel.Application.Cells(1, "I") = "Tipo Documento"
            Excel.Application.Cells(1, "J") = "Número"
            Excel.Application.Cells(1, "K") = "C.C.P."
            Excel.Application.Cells(1, "L") = "Importe"
            Excel.Application.Cells(1, "M") = "Cta. Banco"
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Excel.Application.Cells(Recorrido + 2, "A") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                Excel.Application.Cells(Recorrido + 2, "B") = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                Excel.Application.Cells(Recorrido + 2, "C") = Ds.Tables(0).Rows(Recorrido).Item("Numero_Cheque").ToString
                Excel.Application.Cells(Recorrido + 2, "D") = Ds.Tables(0).Rows(Recorrido).Item("Operacion").ToString
                Excel.Application.Cells(Recorrido + 2, "E") = Ds.Tables(0).Rows(Recorrido).Item("Ruc_Proveedor").ToString
                Excel.Application.Cells(Recorrido + 2, "F") = Ds.Tables(0).Rows(Recorrido).Item("Razon_Social").ToString
                Excel.Application.Cells(Recorrido + 2, "G") = Ds.Tables(0).Rows(Recorrido).Item("Justificacion").ToString
                Excel.Application.Cells(Recorrido + 2, "H") = Ds.Tables(0).Rows(Recorrido).Item("Documento_Sustentatorio").ToString
                Excel.Application.Cells(Recorrido + 2, "I") = Ds.Tables(0).Rows(Recorrido).Item("Nombre_Tipo_Documento")
                Excel.Application.Cells(Recorrido + 2, "J") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero_Documento")
                Excel.Application.Cells(Recorrido + 2, "K") = Ds.Tables(0).Rows(Recorrido).Item("Certificado")
                Excel.Application.Cells(Recorrido + 2, "L") = Ds.Tables(0).Rows(Recorrido).Item("Monto")
                Excel.Application.Cells(Recorrido + 2, "M") = Ds.Tables(0).Rows(Recorrido).Item("Numero_Cuenta")
                Excel.Application.Range("A" & Recorrido + 1, "M" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 6
            Hoja.Range("B1").ColumnWidth = 11
            Hoja.Range("C1").ColumnWidth = 11
            Hoja.Range("D1").ColumnWidth = 11
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 40
            Hoja.Range("G1").ColumnWidth = 50
            Hoja.Range("H1").ColumnWidth = 18
            Hoja.Range("I1").ColumnWidth = 25
            Hoja.Range("J1").ColumnWidth = 8
            Hoja.Range("K1").ColumnWidth = 6
            Hoja.Range("L1").ColumnWidth = 9
            Hoja.Range("M1").ColumnWidth = 20
            Hoja.Range("A1", "M1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("F2", "H" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "M" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("L2", "L" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlRight
            Hoja.Range("P2", "P" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("Q2", "Q" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("F2", "H" & Recorrido + 2).WrapText = True
            Hoja.Range("L2", "L" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE COMPROBANTES"
            Hoja.Range("A" & Recorrido + 2, "M" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "M" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Mostrar_Clasificador_Seleccionado(ByVal Año_Ejecucion As String, ByVal Clasificador As String, ByVal TT As System.Windows.Forms.TextBox, ByVal G As System.Windows.Forms.TextBox, ByVal SG As System.Windows.Forms.TextBox, ByVal SGD As System.Windows.Forms.TextBox, ByVal E As System.Windows.Forms.TextBox, ByVal ED As System.Windows.Forms.TextBox, ByVal Descripcion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Clasificadores_2 Where Año_Ejecucion='" & Año_Ejecucion & "' And Clasificador='" & Clasificador & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            TT.Text = Ds.Tables(0).Rows(0).Item("Tipo_Transaccion").ToString
            G.Text = Ds.Tables(0).Rows(0).Item("Generica").ToString
            SG.Text = Ds.Tables(0).Rows(0).Item("Sub_Generica").ToString
            SGD.Text = Ds.Tables(0).Rows(0).Item("Sub_Generica_Detalle").ToString
            E.Text = Ds.Tables(0).Rows(0).Item("Especifica").ToString
            ED.Text = Ds.Tables(0).Rows(0).Item("Especifica_Detalle").ToString
            Descripcion.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Especifica_Detalle").ToString
        End If
    End Sub
    Public Sub Nueva_Caja_Chica_SBLM_Apertura(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Resolucion As String, ByVal Monto As Double, ByVal Notas As String, ByVal FechaApertura As Date, ByVal UsuarioApertura As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Estado_Caja As String, ByVal Certificado As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Caja_Chica_SBLM_Apertura"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Caja", Codigo_Tipo_Caja)
        Cm.Parameters.AddWithValue("@Numero_Caja", Numero_Caja)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Resolucion", Resolucion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@FechaApertura", FechaApertura)
        Cm.Parameters.AddWithValue("@UsuarioApertura", UsuarioApertura)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Caja", Codigo_Estado_Caja)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nueva_Caja_Chica_SBLM_Rendicion(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Resolucion As String, ByVal Monto As Double, ByVal Notas As String, ByVal FechaApertura As Date, ByVal UsuarioApertura As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Estado_Caja As String, ByVal Numero_Rendicion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Caja_Chica_SBLM_Rendicion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Caja", Codigo_Tipo_Caja)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Numero_Rendicion", Numero_Rendicion)
        Cm.Parameters.AddWithValue("@Resolucion", Resolucion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@FechaApertura", FechaApertura)
        Cm.Parameters.AddWithValue("@UsuarioApertura", UsuarioApertura)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Caja", Codigo_Estado_Caja)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer) As String
        Generar_Numero_Caja_Chica_SBLM = ""
        Select Case Codigo_Tipo_Caja
            Case "01"
                Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica ='" & Codigo_Unidad_Organica & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
                Generar_Numero_Caja_Chica_SBLM = Right("0000" & Numero.ToString, 4)
            Case "02"
                Select Case Numero_Rendicion
                    Case 1
                        Dim Da As New OleDb.OleDbDataAdapter("Select IsNull(Max(Abs(Numero)+1),1) As Numero From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica ='" & Codigo_Unidad_Organica & "'", Cn)
                        Dim Ds As New Data.DataSet
                        Da.Fill(Ds)
                        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
                        Generar_Numero_Caja_Chica_SBLM = Right("0000" & Numero.ToString, 4)
                    Case 2
                        Dim Da As New OleDb.OleDbDataAdapter("Select IsNull(Max(Abs(Numero)),1) As Numero From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica ='" & Codigo_Unidad_Organica & "'", Cn)
                        Dim Ds As New Data.DataSet
                        Da.Fill(Ds)
                        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
                        Generar_Numero_Caja_Chica_SBLM = Right("0000" & Numero.ToString, 4)
                    Case 3
                        Dim Da As New OleDb.OleDbDataAdapter("Select IsNull(Max(Abs(Numero)),1) As Numero From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica ='" & Codigo_Unidad_Organica & "'", Cn)
                        Dim Ds As New Data.DataSet
                        Da.Fill(Ds)
                        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
                        Generar_Numero_Caja_Chica_SBLM = Right("0000" & Numero.ToString, 4)
                End Select
        End Select
        Return Generar_Numero_Caja_Chica_SBLM
    End Function
    Public Sub Nuevo_Detalle_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, ByVal Rendido As Boolean, ByVal Codigo_Comprobante As String, ByVal Serie As String, ByVal Numero As String, ByVal FechaEmision As Date, ByVal Codigo_Proveedor As String, ByVal Denominacion As String, ByVal Valor_Venta As Double, ByVal IGV As Double, ByVal Renta As Double, ByVal Porcentaje_IGV As Double, ByVal Porcentaje_Renta As Double, ByVal Otros As Double, ByVal Check_IGV As Boolean, ByVal CheCk_Renta As Boolean, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Certificado As String, ByVal Codigo_Denominacion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Caja_Chica_SBLM"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Caja", Codigo_Tipo_Caja)
        Cm.Parameters.AddWithValue("@Numero_Caja", Numero_Caja)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Numero_Rendicion", Numero_Rendicion)
        Cm.Parameters.AddWithValue("@Rendido", Rendido)
        Cm.Parameters.AddWithValue("@Codigo_Comprobante", Codigo_Comprobante)
        Cm.Parameters.AddWithValue("@Serie", Serie)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Denominacion", Denominacion)
        Cm.Parameters.AddWithValue("@Valor_Venta", Valor_Venta)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Renta", Renta)
        Cm.Parameters.AddWithValue("@Porcentaje_IGV", Porcentaje_IGV)
        Cm.Parameters.AddWithValue("@Porcentaje_Renta", Porcentaje_Renta)
        Cm.Parameters.AddWithValue("@Otros", Otros)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@CheCk_Renta", CheCk_Renta)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Denominacion", Codigo_Denominacion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Detalle_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, ByVal Rendido As Boolean, ByVal Codigo_Comprobante As String, ByVal Serie As String, ByVal Numero As String, ByVal FechaEmision As Date, ByVal Codigo_Proveedor As String, ByVal Denominacion As String, ByVal Valor_Venta As Double, ByVal IGV As Double, ByVal Renta As Double, ByVal Porcentaje_IGV As Double, ByVal Porcentaje_Renta As Double, ByVal Otros As Double, ByVal Check_IGV As Boolean, ByVal CheCk_Renta As Boolean, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Certificado As String, ByVal Codigo_Denominacion As String, ByVal Id As Integer)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Detalle_Caja_Chica_SBLM"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Caja", Codigo_Tipo_Caja)
        Cm.Parameters.AddWithValue("@Numero_Caja", Numero_Caja)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Numero_Rendicion", Numero_Rendicion)
        Cm.Parameters.AddWithValue("@Rendido", Rendido)
        Cm.Parameters.AddWithValue("@Codigo_Comprobante", Codigo_Comprobante)
        Cm.Parameters.AddWithValue("@Serie", Serie)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Denominacion", Denominacion)
        Cm.Parameters.AddWithValue("@Valor_Venta", Valor_Venta)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Renta", Renta)
        Cm.Parameters.AddWithValue("@Porcentaje_IGV", Porcentaje_IGV)
        Cm.Parameters.AddWithValue("@Porcentaje_Renta", Porcentaje_Renta)
        Cm.Parameters.AddWithValue("@Otros", Otros)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@CheCk_Renta", CheCk_Renta)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Denominacion", Codigo_Denominacion)
        Cm.Parameters.AddWithValue("@Id", Id)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Eliminar_Item_Detalle_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, ByVal Id As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Eliminar_Item_Detalle_Caja_Chica_SBLM"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Caja", Codigo_Tipo_Caja)
        Cm.Parameters.AddWithValue("@Numero_Caja", Numero_Caja)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Numero_Rendicion", Numero_Rendicion)
        Cm.Parameters.AddWithValue("@Id", Id)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Limpiar_Detalle_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Numero='" & Numero_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
        Cm.ExecuteNonQuery()
        Cm = New OleDb.OleDbCommand
    End Sub
    Public Sub Cargar_Detalle_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Orden As String)
        If Orden.Trim.Length = 0 Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero='" & Numero_Caja & "' And Numero_Rendicion='" & Numero_Rendicion & "' Order By Folio", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then

                DataGridView.Rows.Clear()
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridView.Rows.Add()
                    DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Caja").ToString
                    DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                    DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                    DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Rendicion").ToString
                    DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rendido")
                    DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Comprobante").ToString
                    DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Nombre_Comprobante").ToString
                    DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Serie_Comprobante").ToString
                    DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Comprobante").ToString
                    DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                    DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Proveedor_Comprobante").ToString
                    DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("RUC_Proveedor_Comprobante").ToString
                    DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Razon_Social_Comprobante").ToString
                    DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Denominacion").ToString
                    DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Valor_Venta").ToString), "#,###,##0.00")
                    DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("IGV").ToString), "#,###,##0.00")
                    DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Renta").ToString), "#,###,##0.00")
                    DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Porcentaje_IGV").ToString), "#,###,##0.00")
                    DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Porcentaje_Renta").ToString), "#,###,##0.00")
                    DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Otros").ToString), "#,###,##0.00")
                    DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto_Comprobante").ToString), "#,###,##0.00")
                    DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Check_IGV")
                    DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Check_Renta")
                    DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                    DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("FF").ToString
                    DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                    DataGridView.Item(27, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("RB").ToString
                    DataGridView.Item(28, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                    DataGridView.Item(29, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                    DataGridView.Item(30, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                    DataGridView.Item(31, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                    DataGridView.Item(32, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                    DataGridView.Item(33, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                    DataGridView.Item(34, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                    DataGridView.Item(35, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                    DataGridView.Item(36, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                    DataGridView.Item(37, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                    DataGridView.Item(38, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                    DataGridView.Item(39, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                    DataGridView.Item(40, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion").ToString
                    DataGridView.Item(41, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado_Rendicion").ToString
                    DataGridView.Item(42, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                    DataGridView.Item(43, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Denominacion").ToString
                    DataGridView.Item(44, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Denominacion").ToString
                    DataGridView.Item(45, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Folio").ToString
                    DataGridView.Item(46, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("ID").ToString
                Next
            End If
        Else
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero='" & Numero_Caja & "' And Numero_Rendicion='" & Numero_Rendicion & "' Order By " & Orden, Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then

                DataGridView.Rows.Clear()
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridView.Rows.Add()
                    DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Caja").ToString
                    DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                    DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                    DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Rendicion").ToString
                    DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rendido")
                    DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Comprobante").ToString
                    DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Nombre_Comprobante").ToString
                    DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Serie_Comprobante").ToString
                    DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Comprobante").ToString
                    DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                    DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Proveedor_Comprobante").ToString
                    DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("RUC_Proveedor_Comprobante").ToString
                    DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Razon_Social_Comprobante").ToString
                    DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Denominacion").ToString
                    DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Valor_Venta").ToString), "#,###,##0.00")
                    DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("IGV").ToString), "#,###,##0.00")
                    DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Renta").ToString), "#,###,##0.00")
                    DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Porcentaje_IGV").ToString), "#,###,##0.00")
                    DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Porcentaje_Renta").ToString), "#,###,##0.00")
                    DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Otros").ToString), "#,###,##0.00")
                    DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto_Comprobante").ToString), "#,###,##0.00")
                    DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Check_IGV")
                    DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Check_Renta")
                    DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                    DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("FF").ToString
                    DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                    DataGridView.Item(27, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("RB").ToString
                    DataGridView.Item(28, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                    DataGridView.Item(29, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                    DataGridView.Item(30, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                    DataGridView.Item(31, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                    DataGridView.Item(32, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                    DataGridView.Item(33, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                    DataGridView.Item(34, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                    DataGridView.Item(35, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                    DataGridView.Item(36, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                    DataGridView.Item(37, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                    DataGridView.Item(38, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                    DataGridView.Item(39, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                    DataGridView.Item(40, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion").ToString
                    DataGridView.Item(41, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado_Rendicion").ToString
                    DataGridView.Item(42, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                    DataGridView.Item(43, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Denominacion").ToString
                    DataGridView.Item(44, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Denominacion").ToString
                    DataGridView.Item(45, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Folio").ToString
                    DataGridView.Item(46, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("ID").ToString
                Next
            End If
        End If


    End Sub
    Public Sub Cargar_Detalle_Caja_Chica_SBLM_Folios(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica_Detallada_Folios Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero='" & Numero_Caja & "' And Numero_Rendicion='" & Numero_Rendicion & "' Order By Folio", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Caja").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Rendicion").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rendido")
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Comprobante").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Nombre_Comprobante").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Serie_Comprobante").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Comprobante").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString, 10)
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Proveedor_Comprobante").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("RUC_Proveedor_Comprobante").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Razon_Social_Comprobante").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Denominacion").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Valor_Venta").ToString), "#,###,##0.00")
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("IGV").ToString), "#,###,##0.00")
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Renta").ToString), "#,###,##0.00")
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Porcentaje_IGV").ToString), "#,###,##0.00")
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Porcentaje_Renta").ToString), "#,###,##0.00")
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Otros").ToString), "#,###,##0.00")
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto_Comprobante").ToString), "#,###,##0.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Check_IGV")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Check_Renta")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("FF").ToString
                DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(27, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("RB").ToString
                DataGridView.Item(28, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(29, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(30, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(31, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(32, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(33, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(34, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(35, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(36, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(37, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(38, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(39, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(40, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion").ToString
                DataGridView.Item(41, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado_Rendicion").ToString
                DataGridView.Item(42, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(43, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Denominacion").ToString
                DataGridView.Item(44, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Denominacion").ToString
                DataGridView.Item(45, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Id").ToString
                DataGridView.Item(46, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Folio").ToString
            Next
        End If
    End Sub
    Public Sub Nuevo_Detalle_Caja_Chica_SBLM_Movimientos(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero As String, ByVal Numero_Rendicion As Integer, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Numero_Documento As String, ByVal Monto As Double, ByVal Codigo_Estado_Caja_Movimientos As String, ByVal Codigo_Tipo_Recurso As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Caja_Chica_SBLM_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Caja", Codigo_Tipo_Caja)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Numero_Rendicion", Numero_Rendicion)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Caja_Movimientos", Codigo_Estado_Caja_Movimientos)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Correlativo_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Numero_Caja As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Caja_Chica_SBLM = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Caja_Chica_SBLM
    End Function
    Public Sub Generar_Movimientos_Detalle_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Numero_Caja As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion = '" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion, Codigo_Tipo_Caja, Numero, Codigo_Unidad_Organica, Numero_Rendicion, Codigo_FF, Codigo_Rubro, Codigo_Tipo_Recurso, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Actividad, Sum(Monto) As Monto From Detalle_Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Numero='" & Numero_Caja & "' And Codigo_Unidad_Organica ='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "' Group By Año_Ejecucion, Codigo_Tipo_Caja, Numero, Codigo_Unidad_Organica, Numero_Rendicion, Codigo_FF, Codigo_Rubro, Codigo_Tipo_Recurso, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Actividad", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Correlativo As String = Me.Generar_Numero_Correlativo_Caja_Chica_SBLM(Año_Ejecucion, Numero_Caja, Codigo_Tipo_Caja, Codigo_Unidad_Organica, Numero_Rendicion)

            Select Case Codigo_Tipo_Caja
                Case "01"
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Caja_Chica_SBLM_Movimientos(Correlativo,
                        "37",
                        Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Caja").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Numero_Rendicion"),
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString,
                        Numero_Caja,
                        Ds.Tables(0).Rows(Recorrido).Item("Monto"),
                        "01",
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString)
                    Next
                Case "02"
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Caja_Chica_SBLM_Movimientos(Correlativo,
                        "38",
                        Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Caja").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Numero_Rendicion"),
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString,
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString,
                        Numero_Caja,
                        Ds.Tables(0).Rows(Recorrido).Item("Monto"),
                        "01",
                        Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString)
                    Next
            End Select
        End If
    End Sub
    Public Sub Rendir_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Numero_Caja As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, ByVal Usuario_Rendicion As String, ByVal Certificado_Rendicion As String)
        Select Case Codigo_Tipo_Caja
            Case "01"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Caja_Chica_SBLM Set Rendido=1,Codigo_Estado_Caja='02',UsuarioRendicion='" & Usuario_Rendicion & "',FechaRendicion = GetDate() Where Año_Ejecucion = '" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Rendido=1,Codigo_Estado_Caja_Movimientos='02' Where Año_Ejecucion = '" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM Set Rendido=1,FechaRendicion=GetDate(),Certificado='" & Certificado_Rendicion & "' Where Año_Ejecucion = '" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "02"
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Caja_Chica_SBLM Set Codigo_Estado_Caja='02',UsuarioRendicion='" & Usuario_Rendicion & "',FechaRendicion = GetDate(),Certificado='" & Certificado_Rendicion & "', Rendido=1 Where Año_Ejecucion = '" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM_Movimientos Set Rendido=1,Codigo_Estado_Caja_Movimientos='02' Where Año_Ejecucion = '" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Caja_Chica_SBLM Set Rendido=1,FechaRendicion=GetDate(),Certificado='" & Certificado_Rendicion & "' Where Año_Ejecucion = '" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Dim Da As New OleDb.OleDbDataAdapter("Select Sum(Monto) As Monto From Detalle_Caja_Chica_SBLM_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                Dim Monto As Double = 0
                If Ds.Tables(0).Rows.Count > 0 Then
                    Monto = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString)
                Else
                    Monto = 0
                End If
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Caja_Chica_SBLM Set Monto=" & Monto & " Where Año_Ejecucion = '" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Ejecutar_Movimiento_Certificado_Caja_Chica_SBLM(ByVal Año_Ejecucion As String, ByVal Numero_Caja As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, ByVal Certificado As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso, Sum(Monto) As Monto From Detalle_Caja_Chica_SBLM_movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "' Group By Codigo_FF, Codigo_Rubro, Tipo_Transaccion, Generica, Sub_Generica, Sub_Generica_Detalle, Especifica, Especifica_Detalle, Codigo_Secuencia_Funcional, Codigo_Unidad_Organica, Codigo_Actividad,Codigo_Tipo_Recurso", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            Dim Correlativo As String = Me.Generar_Numero_Correlativo_Certificado(My.Settings.Año_Ejecucion, Certificado)
            Select Case Codigo_Tipo_Caja
                Case "01"
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Certificado_Movimiento(Correlativo, "37", Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Numero_Caja, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto") * -1), "03", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                    Next
                Case "02"
                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        Me.Nuevo_Detalle_Certificado_Movimiento(Correlativo, "38", Año_Ejecucion, Certificado, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), Ds.Tables(0).Rows(Recorrido).Item("Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"), Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Especifica"), Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"), Numero_Caja, Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto") * -1), "03", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                    Next
            End Select
        Else
            Exit Sub
        End If
    End Sub
    Public Sub Obtener_Codigos_Cajas_Importar_Compromisos(ByVal Año_Ejecucion As String, ByVal Expediente As String)
        Dim Da As New OleDb.OleDbDataAdapter("select * from Lista_Caja_Chica_SBLM_Basica Where Año_Ejecucion ='" & Año_Ejecucion & "' And Expediente ='" & Expediente & "' ", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Chica_Codigo_Tipo_Caja = Ds.Tables(0).Rows(0).Item("Codigo_Tipo_Caja").ToString
            Caja_Chica_Codigo_Unidad_Organica = Ds.Tables(0).Rows(0).Item("Codigo_Unidad_Organica").ToString
        End If
    End Sub
    Public Function Mostrar_Glosa(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Giro As String) As String
        Mostrar_Glosa = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Comprobante_Pago Where Año_Ejecucion ='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Numero_Giro='" & Numero_Giro & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Mostrar_Glosa = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
        End If
        Return Mostrar_Glosa
    End Function
    Public Sub Mostrar_Datos_CP_Anulacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Giro As String, Optional ByVal Caja_Numero As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Emision As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Giro As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Expediente As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Retenciones As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Liquido As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Estado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_RUC As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Proveedor As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Glosa As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Certificado As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Tipo_Pago As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Operacion As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Comprobantes_Formato_2018 Where Año_Ejecucion ='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Numero_Giro='" & Numero_Giro & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Numero.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
            Caja_Emision.Text = Microsoft.VisualBasic.Left(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString, 10)
            Caja_Giro.Text = Ds.Tables(0).Rows(0).Item("Numero_Giro").ToString
            Caja_Expediente.Text = Ds.Tables(0).Rows(0).Item("Expediente").ToString
            Caja_Monto.Text = Ds.Tables(0).Rows(0).Item("Total").ToString
            Caja_Retenciones.Text = Ds.Tables(0).Rows(0).Item("Deducciones").ToString
            Caja_Liquido.Text = Ds.Tables(0).Rows(0).Item("Liquido Pagar").ToString
            Caja_Estado.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Estado_Comprobante").ToString
            Caja_RUC.Text = Ds.Tables(0).Rows(0).Item("RUC_Proveedor").ToString
            Caja_Proveedor.Text = Ds.Tables(0).Rows(0).Item("Razon_Social").ToString
            Caja_Glosa.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            Caja_Certificado.Text = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Caja_Tipo_Pago.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Tipo_Pago").ToString
            Caja_Operacion.Text = Ds.Tables(0).Rows(0).Item("Operacion").ToString
        End If
    End Sub
    Public Sub Actualizat_Glosa(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Giro As String, ByVal Glosa As String, ByVal Año_Ejecucion_Referido As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Comprobante_Pago Set Justificacion='" & Glosa & "' Where Año_Ejecucion ='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Numero_Giro='" & Numero_Giro & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Girado Set Notas='" & Glosa & "' Where Año_Ejecucion ='" & Año_Ejecucion & "' And Numero='" & Numero_Giro & "' And Numero_Comprobante='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Comprobante_Pago(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Giro As String, ByVal Memo_Anulacion As String, ByVal Usuario As String, Optional ByVal Codigo_Tipo_Documento As String = Nothing, Optional ByVal Año_Ejecucion_Referido As String = Nothing)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Comprobante_Pago Set Codigo_Estado_Comprobante='04', Memo_Anulacion='" & Memo_Anulacion & "',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Numero_Giro='" & Numero_Giro & "' And Año_Ejecucion_Referido='" & Año_Ejecucion_Referido & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Girado Set Codigo_Estado_Giro='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Giro & "' And Numero_Comprobante='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Girado_Movimientos Set Codigo_Estado_Girado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Giro & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Select Case Codigo_Tipo_Documento
            Case "08"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero_Giro & "' And Codigo_Tipo_Operacion='29'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "09"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero_Giro & "' And Codigo_Tipo_Operacion='30'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "22"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero_Giro & "' And Codigo_Tipo_Operacion='41'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "23"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero_Giro & "' And Codigo_Tipo_Operacion='42'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "19"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero_Giro & "' And Codigo_Tipo_Operacion='34'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "31"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero_Giro & "' And Codigo_Tipo_Operacion='45'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case "34"
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Codigo_Estado_Devengado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero_Giro & "' And Codigo_Tipo_Operacion='54'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Function Mostrar_Monto_Apertura_Caja_Original(ByVal Año_Ejecucion As String, ByVal Numero_Caja As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer) As Double
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Caja & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Mostrar_Monto_Apertura_Caja_Original = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString)
        Else
            Mostrar_Monto_Apertura_Caja_Original = 0
        End If
        Return Mostrar_Monto_Apertura_Caja_Original
    End Function
    Public Function Probar_Numeracion_Caja_Rendicion(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, Optional ByVal Numero As String = Nothing) As Boolean
        Probar_Numeracion_Caja_Rendicion = True
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Caja_Chica_SBLM Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion='" & Numero_Rendicion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Probar_Numeracion_Caja_Rendicion = False
        End If
        Return Probar_Numeracion_Caja_Rendicion
    End Function
    
    Public Sub Cargar_Distribucion_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, Optional ByVal Caja_Numero As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Fecha As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Documento As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Justificacion As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Tipo_Operacion As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Certificado_Distribucion Where Año_ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            DataGridView.Rows.Clear()

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Enero").ToString), "###,###,#.00")
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Febrero").ToString), "###,###,#.00")
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Marzo").ToString), "###,###,#.00")
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Abril").ToString), "###,###,#.00")
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Mayo").ToString), "###,###,#.00")
                DataGridView.Item(23, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Junio").ToString), "###,###,#.00")
                DataGridView.Item(24, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Julio").ToString), "###,###,#.00")
                DataGridView.Item(25, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Agosto").ToString), "###,###,#.00")
                DataGridView.Item(26, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Septiembre").ToString), "###,###,#.00")
                DataGridView.Item(27, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Octubre").ToString), "###,###,#.00")
                DataGridView.Item(28, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Noviembre").ToString), "###,###,#.00")
                DataGridView.Item(29, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Diciembre").ToString), "###,###,#.00")
                DataGridView.Item(30, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Total").ToString), "###,###,#.00")
            Next
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Caja_Numero Is System.Windows.Forms.TextBox Then Caja_Numero.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Año_Ejecucion
            If TypeOf Caja_Fecha Is System.Windows.Forms.TextBox Then Caja_Fecha.Text = Convert.ToDateTime(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString)
            If TypeOf Caja_Monto Is System.Windows.Forms.TextBox Then Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
            If TypeOf Caja_Documento Is System.Windows.Forms.TextBox Then Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento").ToString
            If TypeOf Caja_Justificacion Is System.Windows.Forms.TextBox Then Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            If TypeOf Caja_Tipo_Operacion Is System.Windows.Forms.TextBox Then Caja_Tipo_Operacion.Text = Ds.Tables(0).Rows(0).Item("Tipo_Operacion").ToString
        End If
    End Sub
    Public Sub Cargar_Mini_Detalle_Distribucion_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Clasificador As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Tipo_Recurso As String, Optional ByVal Caja_Año As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Numero As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Rubro As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Tipo_Recurso As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Clasificador As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Secuencia_Funcional As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Centro_Costos As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Monto As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Descripcion As System.Windows.Forms.TextBox = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Certificado_Distribucion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_FF='" & Codigo_FF & "' And Codigo_Rubro ='" & Codigo_Rubro & "' And Clasificador='" & Clasificador & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Codigo_Tipo_Recurso ='" & Codigo_Tipo_Recurso & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Caja_Año Is System.Windows.Forms.TextBox Then Caja_Año.Text = Año_Ejecucion
            If TypeOf Caja_Numero Is System.Windows.Forms.TextBox Then Caja_Numero.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString & " - " & Año_Ejecucion
            If TypeOf Caja_Rubro Is System.Windows.Forms.TextBox Then Caja_Rubro.Text = Ds.Tables(0).Rows(0).Item("Rubro").ToString
            If TypeOf Caja_Rubro Is System.Windows.Forms.TextBox Then Caja_Rubro.Text = Ds.Tables(0).Rows(0).Item("Rubro").ToString
            If TypeOf Caja_Tipo_Recurso Is System.Windows.Forms.TextBox Then Caja_Tipo_Recurso.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Tipo_Recurso").ToString
            If TypeOf Caja_Clasificador Is System.Windows.Forms.TextBox Then Caja_Clasificador.Text = Ds.Tables(0).Rows(0).Item("Clasificador").ToString
            If TypeOf Caja_Secuencia_Funcional Is System.Windows.Forms.TextBox Then Caja_Secuencia_Funcional.Text = Ds.Tables(0).Rows(0).Item("Codigo_Secuencia_Funcional").ToString
            If TypeOf Caja_Centro_Costos Is System.Windows.Forms.TextBox Then Caja_Centro_Costos.Text = Ds.Tables(0).Rows(0).Item("Abreviatura").ToString
            If TypeOf Caja_Descripcion Is System.Windows.Forms.TextBox Then Caja_Descripcion.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Especifica_Detalle").ToString
            If TypeOf Caja_Monto Is System.Windows.Forms.TextBox Then Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
        End If
    End Sub
    Public Function Evaluar_Montos_Distribucion_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Clasificador As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Tipo_Recurso As String, ByVal Monto As Double) As Boolean
        Evaluar_Montos_Distribucion_Certificado = True
        If Evaluar_Montos_Distribucion_Certificado = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Certificado_Distribucion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_FF='" & Codigo_FF & "' And Codigo_Rubro ='" & Codigo_Rubro & "' And Clasificador='" & Clasificador & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "' And Codigo_Tipo_Recurso ='" & Codigo_Tipo_Recurso & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                If Math.Round(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString), 2) = Math.Round(Monto, 2) Then
                    Evaluar_Montos_Distribucion_Certificado = True
                Else
                    Evaluar_Montos_Distribucion_Certificado = False
                End If
            Else
                Evaluar_Montos_Distribucion_Certificado = False
            End If
        End If
        Return Evaluar_Montos_Distribucion_Certificado
    End Function
    Public Sub Nuevo_Detalle_Certificado_Distribucion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Codigo_Tipo_Recurso As String, ByVal Enero As Double, ByVal Febrero As Double, ByVal Marzo As Double, ByVal Abril As Double, ByVal Mayo As Double, ByVal Junio As Double, ByVal Julio As Double, ByVal Agosto As Double, ByVal Septiembre As Double, ByVal Octubre As Double, ByVal Noviembre As Double, ByVal Diciembre As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Certificado_Distribucion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Enero", Enero)
        Cm.Parameters.AddWithValue("@Febrero", Febrero)
        Cm.Parameters.AddWithValue("@Marzo", Marzo)
        Cm.Parameters.AddWithValue("@Abril", Abril)
        Cm.Parameters.AddWithValue("@Mayo", Mayo)
        Cm.Parameters.AddWithValue("@Junio", Junio)
        Cm.Parameters.AddWithValue("@Julio", Julio)
        Cm.Parameters.AddWithValue("@Agosto", Agosto)
        Cm.Parameters.AddWithValue("@Septiembre", Septiembre)
        Cm.Parameters.AddWithValue("@Octubre", Octubre)
        Cm.Parameters.AddWithValue("@Noviembre", Noviembre)
        Cm.Parameters.AddWithValue("@Diciembre", Diciembre)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Cambiar_Estado_Certificado_Distribucion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Estado As Boolean)
        Select Case Estado
            Case True
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Certificado Set Distribuido = 1 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
            Case False
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Certificado Set Distribuido = 0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
        End Select
    End Sub
    Public Sub Extornar_Distribucion_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Certificado Set Distribuido = 0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Certificado_Distribucion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Generar_Codigo_Personal() As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Codigo_Personal)+1),1) As Numero From Personal", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Codigo_Personal = Right("00000" & Numero.ToString, 5)
        Return Generar_Codigo_Personal
    End Function
    Public Sub Nuevo_Personal(ByVal Codigo_Personal As String, ByVal DNI_Personal As String, ByVal Nombre_Completo As String, ByVal Domicilio As String, ByVal Ubigeo As String, ByVal Telefono As String, ByVal Celular As String, ByVal Correo As String, ByVal Observaciones As String, ByVal Codigo_Tipo_Planilla As String, ByVal Activo As Boolean, ByVal Fecha_Nacimiento As Date)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Personal"
        Cm.Parameters.AddWithValue("@Codigo_Personal", Codigo_Personal)
        Cm.Parameters.AddWithValue("@DNI_Personal", DNI_Personal)
        Cm.Parameters.AddWithValue("@Nombre_Completo", Nombre_Completo)
        Cm.Parameters.AddWithValue("@Domicilio", Domicilio)
        Cm.Parameters.AddWithValue("@Ubigeo", Ubigeo)
        Cm.Parameters.AddWithValue("@Telefono", Telefono)
        Cm.Parameters.AddWithValue("@Celular", Celular)
        Cm.Parameters.AddWithValue("@Correo", Correo)
        Cm.Parameters.AddWithValue("@Observaciones", Observaciones)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Planilla", Codigo_Tipo_Planilla)
        Cm.Parameters.AddWithValue("@Activo", Activo)
        Cm.Parameters.AddWithValue("@Fecha_Nacimiento", Fecha_Nacimiento)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Personal(ByVal Codigo_Personal As String, ByVal DNI_Personal As String, ByVal Nombre_Completo As String, ByVal Domicilio As String, ByVal Ubigeo As String, ByVal Telefono As String, ByVal Celular As String, ByVal Correo As String, ByVal Observaciones As String, ByVal Codigo_Tipo_Planilla As String, ByVal Activo As Boolean, ByVal Fecha_Nacimiento As Date)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Personal"
        Cm.Parameters.AddWithValue("@Codigo_Personal", Codigo_Personal)
        Cm.Parameters.AddWithValue("@DNI_Personal", DNI_Personal)
        Cm.Parameters.AddWithValue("@Nombre_Completo", Nombre_Completo)
        Cm.Parameters.AddWithValue("@Domicilio", Domicilio)
        Cm.Parameters.AddWithValue("@Ubigeo", Ubigeo)
        Cm.Parameters.AddWithValue("@Telefono", Telefono)
        Cm.Parameters.AddWithValue("@Celular", Celular)
        Cm.Parameters.AddWithValue("@Correo", Correo)
        Cm.Parameters.AddWithValue("@Observaciones", Observaciones)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Planilla", Codigo_Tipo_Planilla)
        Cm.Parameters.AddWithValue("@Activo", Activo)
        Cm.Parameters.AddWithValue("@Fecha_Nacimiento", Fecha_Nacimiento)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Verificar_Duplicidad_DNI_Personal(ByVal DNI As String, ByVal Nuevo As Boolean, Optional ByVal ID As String = Nothing) As Boolean
        Verificar_Duplicidad_DNI_Personal = True
        If Verificar_Duplicidad_DNI_Personal = True Then
            Select Case Nuevo
                Case True
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Personal Where DNI_Personal='" & DNI.Trim & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Verificar_Duplicidad_DNI_Personal = False
                        Exit Function
                    Else
                        Return Verificar_Duplicidad_DNI_Personal
                        Exit Function
                    End If
                Case False
                    Dim Da As New OleDb.OleDbDataAdapter("Select * From Personal Where DNI_Personal='" & DNI.Trim & "' And DNI_Personal <>'" & ID.Trim & "'", Cn)
                    Dim Ds As New Data.DataSet
                    Da.Fill(Ds)
                    If Ds.Tables(0).Rows.Count > 0 Then
                        Verificar_Duplicidad_DNI_Personal = False
                        Exit Function
                    Else
                        Return Verificar_Duplicidad_DNI_Personal
                        Exit Function
                    End If
            End Select
        End If
        Return Verificar_Duplicidad_DNI_Personal
    End Function
    Public Sub Cargar_Personal(ByVal Codigo As String, Optional ByVal Caja_Codigo_Personal As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_DNI_Personal As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Nombre As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Domicilio As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Codigo_Ubigeo As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Ubigeo As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Telefono As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Celular As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Correo As System.Windows.Forms.TextBox = Nothing, Optional ByVal Caja_Observaciones As System.Windows.Forms.TextBox = Nothing, Optional ByVal Check_Activo As System.Windows.Forms.CheckBox = Nothing, Optional ByVal Combo_Planilla As System.Windows.Forms.ComboBox = Nothing, Optional ByVal Fecha_Nacimiento As System.Windows.Forms.DateTimePicker = Nothing)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Personal_SBLM Where Codigo='" & Codigo & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            If TypeOf Caja_Codigo_Personal Is System.Windows.Forms.TextBox Then Caja_Codigo_Personal.Text = Ds.Tables(0).Rows(0).Item("Codigo").ToString
            If TypeOf Caja_DNI_Personal Is System.Windows.Forms.TextBox Then Caja_DNI_Personal.Text = Ds.Tables(0).Rows(0).Item("DNI").ToString
            If TypeOf Caja_Nombre Is System.Windows.Forms.TextBox Then Caja_Nombre.Text = Ds.Tables(0).Rows(0).Item("Nombre").ToString
            If TypeOf Caja_Domicilio Is System.Windows.Forms.TextBox Then Caja_Domicilio.Text = Ds.Tables(0).Rows(0).Item("Domicilio").ToString
            If TypeOf Caja_Codigo_Ubigeo Is System.Windows.Forms.TextBox Then Caja_Codigo_Ubigeo.Text = Ds.Tables(0).Rows(0).Item("Ubigeo").ToString
            If TypeOf Caja_Ubigeo Is System.Windows.Forms.TextBox Then Caja_Ubigeo.Text = Ds.Tables(0).Rows(0).Item("Distrito").ToString
            If TypeOf Caja_Telefono Is System.Windows.Forms.TextBox Then Caja_Telefono.Text = Ds.Tables(0).Rows(0).Item("Telefono").ToString
            If TypeOf Caja_Celular Is System.Windows.Forms.TextBox Then Caja_Celular.Text = Ds.Tables(0).Rows(0).Item("Celular").ToString
            If TypeOf Caja_Correo Is System.Windows.Forms.TextBox Then Caja_Correo.Text = Ds.Tables(0).Rows(0).Item("Correo").ToString
            If TypeOf Caja_Observaciones Is System.Windows.Forms.TextBox Then Caja_Observaciones.Text = Ds.Tables(0).Rows(0).Item("Observaciones").ToString
            If TypeOf Check_Activo Is System.Windows.Forms.CheckBox Then Check_Activo.Checked = Ds.Tables(0).Rows(0).Item("Activo")
            If TypeOf Combo_Planilla Is System.Windows.Forms.ComboBox Then Combo_Planilla.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Tipo_Planilla").ToString
            If TypeOf Fecha_Nacimiento Is System.Windows.Forms.DateTimePicker Then Fecha_Nacimiento.Value = DateValue(Ds.Tables(0).Rows(0).Item("Fec.Nac.").ToString)
        End If
    End Sub
    Public Sub Nuevo_Personal_Contratos(ByVal Año_Ejecucion As String, ByVal Correlativo As String, ByVal Codigo_Personal As String, ByVal Numero_Contrato As Integer, ByVal Año_Contrato As String, ByVal Addenda As Boolean, ByVal Numero_Addenda As Integer, ByVal Salario As Double, ByVal Fecha_Inicio As Date, ByVal Fecha_Fin As Date, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Fecha_Contrato As Date)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Personal_Contratos"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Personal", Codigo_Personal)
        Cm.Parameters.AddWithValue("@Numero_Contrato", Numero_Contrato)
        Cm.Parameters.AddWithValue("@Año_Contrato", Año_Contrato)
        Cm.Parameters.AddWithValue("@Addenda", Addenda)
        Cm.Parameters.AddWithValue("@Numero_Addenda", Numero_Addenda)
        Cm.Parameters.AddWithValue("@Salario", Salario)
        Cm.Parameters.AddWithValue("@Fecha_Inicio", Fecha_Inicio)
        Cm.Parameters.AddWithValue("@Fecha_Fin", Fecha_Fin)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Fecha_Contrato", Fecha_Contrato)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Correlativo_Personal_Contrato(ByVal Codigo_Personal As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Personal_Contratos Where Codigo_Personal='" & Codigo_Personal & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Personal_Contrato = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Personal_Contrato
    End Function
    Public Sub Limpiar_Personal_Contratos(ByVal Codigo_Personal As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Personal_Contratos Where Codigo_Personal='" & Codigo_Personal & "'"
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Listar_Personal_Contratos(ByVal Codigo_Personal As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Personal_Contratos Where Codigo_Personal='" & Codigo_Personal & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Contrato").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Contrato").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Addenda")
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Addenda").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Format(DateValue(Ds.Tables(0).Rows(Recorrido).Item("Fecha_Contrato").ToString), "dd/MM/yyyy")
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Format(DateValue(Ds.Tables(0).Rows(Recorrido).Item("Fecha_Inicio").ToString), "dd/MM/yyyy")
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Format(DateValue(Ds.Tables(0).Rows(Recorrido).Item("Fecha_Fin").ToString), "dd/MM/yyyy")
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Salario").ToString), "###,###,#.00")
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Fuente").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Actividad").ToString
                DataGridView.Item(20, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(21, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                DataGridView.Item(22, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Recurso").ToString
            Next
        End If
    End Sub
    Public Sub Exportar_Lista_Precios(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Orden"
            Excel.Application.Cells(1, "C") = "Código"
            Excel.Application.Cells(1, "D") = "Ítem"
            Excel.Application.Cells(1, "E") = "Und.Med."
            Excel.Application.Cells(1, "F") = "Emision"
            Excel.Application.Cells(1, "G") = "Meta"
            Excel.Application.Cells(1, "H") = "Usuario"
            Excel.Application.Cells(1, "I") = "Clasificador"
            Excel.Application.Cells(1, "J") = "Cant."
            Excel.Application.Cells(1, "K") = "Costo"
            Excel.Application.Cells(1, "L") = "Importe"
            Excel.Application.Cells(1, "M") = "RUC"
            Excel.Application.Cells(1, "N") = "Proveedor"
            Excel.Application.Cells(1, "O") = "Procedimiento"
            Excel.Application.Cells(1, "P") = "C.Costos"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = "'" & DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Cells(Recorrido + 2, "J") = DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Cells(Recorrido + 2, "K") = DataGridView.Rows(Recorrido).Cells(10).Value
                Excel.Application.Cells(Recorrido + 2, "L") = DataGridView.Rows(Recorrido).Cells(11).Value
                Excel.Application.Cells(Recorrido + 2, "M") = DataGridView.Rows(Recorrido).Cells(12).Value
                Excel.Application.Cells(Recorrido + 2, "N") = DataGridView.Rows(Recorrido).Cells(13).Value
                Excel.Application.Cells(Recorrido + 2, "O") = DataGridView.Rows(Recorrido).Cells(14).Value
                Excel.Application.Cells(Recorrido + 2, "P") = DataGridView.Rows(Recorrido).Cells(15).Value
                Excel.Application.Range("A" & Recorrido + 1, "P" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 15
            Hoja.Range("D1").ColumnWidth = 45
            Hoja.Range("E1").ColumnWidth = 15
            Hoja.Range("F1").ColumnWidth = 10
            Hoja.Range("G1").ColumnWidth = 5
            Hoja.Range("H1").ColumnWidth = 18
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("J1").ColumnWidth = 10
            Hoja.Range("K1").ColumnWidth = 10
            Hoja.Range("L1").ColumnWidth = 10
            Hoja.Range("M1").ColumnWidth = 11
            Hoja.Range("N1").ColumnWidth = 40
            Hoja.Range("O1").ColumnWidth = 24
            Hoja.Range("P1").ColumnWidth = 15
            Hoja.Range("A1", "P1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "M" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("J2", "J" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("K2", "K" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("L2", "L" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "HISTORICO PRECIOS"
            Hoja.Range("A" & Recorrido + 2, "P" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "P" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    public sub Exportar_Lista_Cuadro_Necesidades(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet
            Dim Recorrido2 as integer
            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data CN"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Tipo.Catalogo"
            Excel.Application.Cells(1, "C") = "Partida"
            Excel.Application.Cells(1, "D") = "Nombre.Partida"
            Excel.Application.Cells(1, "E") = "Codigo"
            Excel.Application.Cells(1, "F") = "Descripcion.Bien.Servicio"
            Excel.Application.Cells(1, "G") = "U.Medida"
            Excel.Application.Cells(1, "H") = "Precio.Unit"
            Excel.Application.Cells(1, "I") = "Importe.Total"
            Excel.Application.Cells(1, "J") = "Enero"
            Excel.Application.Cells(1, "K") = "Febrero"
            Excel.Application.Cells(1, "L") = "Marzo"
            Excel.Application.Cells(1, "M") = "Abril"
            Excel.Application.Cells(1, "N") = "Mayo"
            Excel.Application.Cells(1, "O") = "Junio"
            Excel.Application.Cells(1, "P") = "Julio"
            Excel.Application.Cells(1, "Q") = "Agosto"
            Excel.Application.Cells(1, "R") = "Septiembre"
            Excel.Application.Cells(1, "S") = "Octubre"
            Excel.Application.Cells(1, "T") = "Noviembre"
            Excel.Application.Cells(1, "U") = "Diciembre"
            Excel.Application.Cells(1, "V") = "Total.Anual"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = IIf(DataGridView.Rows(Recorrido).Cells(36).Value.ToString="01","Bien","Servicio")
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(37).Value
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(17).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(18).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(20).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(22).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(38).Value
                Excel.Application.Cells(Recorrido + 2, "J") = DataGridView.Rows(Recorrido).Cells(23).Value
                Excel.Application.Cells(Recorrido + 2, "K") = DataGridView.Rows(Recorrido).Cells(24).Value
                Excel.Application.Cells(Recorrido + 2, "L") = DataGridView.Rows(Recorrido).Cells(25).Value
                Excel.Application.Cells(Recorrido + 2, "M") = DataGridView.Rows(Recorrido).Cells(26).Value
                Excel.Application.Cells(Recorrido + 2, "N") = DataGridView.Rows(Recorrido).Cells(27).Value
                Excel.Application.Cells(Recorrido + 2, "O") = DataGridView.Rows(Recorrido).Cells(28).Value
                Excel.Application.Cells(Recorrido + 2, "P") = DataGridView.Rows(Recorrido).Cells(29).Value
                Excel.Application.Cells(Recorrido + 2, "Q") = DataGridView.Rows(Recorrido).Cells(30).Value
                Excel.Application.Cells(Recorrido + 2, "R") = DataGridView.Rows(Recorrido).Cells(31).Value
                Excel.Application.Cells(Recorrido + 2, "S") = DataGridView.Rows(Recorrido).Cells(32).Value
                Excel.Application.Cells(Recorrido + 2, "T") = DataGridView.Rows(Recorrido).Cells(33).Value
                Excel.Application.Cells(Recorrido + 2, "U") = DataGridView.Rows(Recorrido).Cells(34).Value
                Excel.Application.Cells(Recorrido + 2, "V") = DataGridView.Rows(Recorrido).Cells(21).Value
                Excel.Application.Range("A" & Recorrido + 1, "V" & Recorrido + 2).Borders.LineStyle = 2
                Recorrido2 = Recorrido
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 15
            Hoja.Range("D1").ColumnWidth = 30'nom partida
            Hoja.Range("E1").ColumnWidth = 17'codigo
            Hoja.Range("F1").ColumnWidth = 40
            Hoja.Range("G1").ColumnWidth = 15
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 15
            Hoja.Range("J1").ColumnWidth = 10
            Hoja.Range("K1").ColumnWidth = 10
            Hoja.Range("L1").ColumnWidth = 10
            Hoja.Range("M1").ColumnWidth = 10
            Hoja.Range("N1").ColumnWidth = 10
            Hoja.Range("O1").ColumnWidth = 10
            Hoja.Range("P1").ColumnWidth = 10
            Hoja.Range("Q1").ColumnWidth = 10
            Hoja.Range("R1").ColumnWidth = 10
            Hoja.Range("S1").ColumnWidth = 10
            Hoja.Range("T1").ColumnWidth = 10
            Hoja.Range("U1").ColumnWidth = 10
            Hoja.Range("V1").ColumnWidth = 20
            Hoja.Range("A1", "V1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("D2", "D" & Recorrido2 + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("F2", "F" & Recorrido2 + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "V" & Recorrido2 + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            'Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("I2", "V" & Recorrido2 + 2).NumberFormat = "#,###,##0.00"
            
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "CUADRO NECESIDADES"
            Hoja.Range("A" & Recorrido2 + 3, "V" & Recorrido2 + 3).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido2 + 3, "V" & Recorrido2 + 3).MergeCells = True
        End If
    End sub
    Public Sub Generar_Resumen_Presupuestal_Caja_Chica(ByVal DataGridView As System.Windows.Forms.DataGridView)
        Me.Generar_Numero_Operacion()
        Dim Operacion As String = Me.Obtener_Numero_Operacion
        Variable_Numero_Operacion_Externa = Operacion

        For Recorrido As Integer = 0 To DataGridView.Rows.Count - 1
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.StoredProcedure
            Cm.CommandText = "Nuevo_Temporal_Caja_Detalle"
            Cm.Parameters.AddWithValue("@Operacion", Operacion)
            Cm.Parameters.AddWithValue("@Año_Ejecucion", DataGridView.Rows(Recorrido).Cells(0).Value)
            Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", DataGridView.Rows(Recorrido).Cells(3).Value)
            Cm.Parameters.AddWithValue("@Monto", Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(21).Value))
            Cm.Parameters.AddWithValue("@Codigo_FF", DataGridView.Rows(Recorrido).Cells(24).Value)
            Cm.Parameters.AddWithValue("@Codigo_Rubro", DataGridView.Rows(Recorrido).Cells(26).Value)
            Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", DataGridView.Rows(Recorrido).Cells(28).Value)
            Cm.Parameters.AddWithValue("@Tipo_Transaccion", DataGridView.Rows(Recorrido).Cells(31).Value)
            Cm.Parameters.AddWithValue("@Generica", DataGridView.Rows(Recorrido).Cells(32).Value)
            Cm.Parameters.AddWithValue("@Sub_Generica", DataGridView.Rows(Recorrido).Cells(33).Value)
            Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", DataGridView.Rows(Recorrido).Cells(34).Value)
            Cm.Parameters.AddWithValue("@Especifica", DataGridView.Rows(Recorrido).Cells(35).Value)
            Cm.Parameters.AddWithValue("@Especifica_Detalle", DataGridView.Rows(Recorrido).Cells(36).Value)
            Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", DataGridView.Rows(Recorrido).Cells(38).Value)
            Cm.Parameters.AddWithValue("@Codigo_Actividad", DataGridView.Rows(Recorrido).Cells(39).Value)
            Cm.ExecuteNonQuery()
        Next
    End Sub

    Public Function Cadena_Denominaciones_UO_Caja(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String) As String

        Dim Cadena As String = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Unidad_Organica_Denominacion_Caja_Chica Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                With Ds.Tables(0).Rows(Recorrido)
                    Cadena = Cadena & "'" & .Item("Codigo_Denominacion") & "',"
                End With
            Next
            Cadena = Microsoft.VisualBasic.Left(Cadena, Cadena.Trim.Length - 1)
        Else
            Cadena = "'00'"
        End If
        Return Cadena
    End Function
    Public Sub Cargar_Certificado_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Certificados_Basica_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Saldo >0", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
            Next
        End If
    End Sub
    Public Sub Cargar_Certificado_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Certificados_Basica_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Saldo >0", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
            Next
        End If
    End Sub
    Public Sub Cargar_Certificado_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, Optional ByVal Precarga As Boolean = Nothing, Optional ByVal Numero_Planilla As String = Nothing)
        If Precarga = Nothing Or Precarga = False Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Certificados_Basica_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Saldo >0", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then

                DataGridView.Rows.Clear()
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridView.Rows.Add()
                    DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                    DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                    DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                    DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString & " - " & Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                    DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                    DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                    DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                    DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                    DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                    DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                    DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                    DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                    DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                    DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                    DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                    DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                    DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                    DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                    DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                Next
            End If
        Else
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Certificados_Basica_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Saldo >0", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then

                DataGridView.Rows.Clear()
                For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                    DataGridView.Rows.Add()
                    DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                    DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                    DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                    DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                    DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString & " - " & Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                    DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                    DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                    DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                    DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                    DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                    DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                    DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                    DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                    DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                    DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                    DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                    DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                    DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                    DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                    Dim DaDetalle As New OleDb.OleDbDataAdapter("Select * From Detalle_Planilla Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Planilla & "' And Codigo_FF='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString & "' And Codigo_Rubro='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString & "' And Codigo_Tipo_Recurso='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString & "' And Tipo_Transaccion='" & Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString & "' And Generica='" & Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString & "' And Sub_Generica='" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString & "' And Sub_Generica_Detalle='" & Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString & "' And Especifica='" & Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString & "' And Especifica_Detalle='" & Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString & "' And Codigo_Unidad_Organica='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString & "' And Codigo_Secuencia_Funcional='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString & "' And Codigo_Actividad='" & Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString & "'", Cn)
                    Dim DsDetalle As New Data.DataSet
                    DaDetalle.Fill(DsDetalle)
                    If DsDetalle.Tables(0).Rows.Count > 0 Then
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(DsDetalle.Tables(0).Rows(0).Item("Monto").ToString), "###,###,#.00")
                    Else
                        DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
                    End If
                Next
            End If
        End If

    End Sub
    Public Sub Cargar_Certificado_Encargos_Internos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Detalle_Certificados_Basica_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then

            DataGridView.Rows.Clear()
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(12, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString
                DataGridView.Item(13, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                DataGridView.Item(14, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                DataGridView.Item(15, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(16, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                DataGridView.Item(17, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(18, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                DataGridView.Item(19, DataGridView.Rows.Count - 1).Value = Format(0, "###,###,#.00")
            Next
        End If
    End Sub
    Public Sub Nuevo_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Denominacion As String, ByVal Documento As String, ByVal Justificacion As String, ByVal FechaEmision As String, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Pago As String, ByVal Monto As Double, ByVal Certificado As String, ByVal Codigo_Proveedor As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Pagos_Varios"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Denominacion", Codigo_Denominacion)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Pago", Codigo_Estado_Pago)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Denominacion As String, ByVal Documento As String, ByVal Justificacion As String, ByVal Monto As Double, ByVal Certificado As String, ByVal Codigo_Proveedor As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Pagos_Varios"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Denominacion", Codigo_Denominacion)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Pagos_Varios"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Pagos_Varios_Movimientos(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Numero_Documento As String, ByVal Codigo_Estado_Pagos_Varios_Movimientos As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Pagos_Varios_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Pagos_Varios_Movimientos", Codigo_Estado_Pagos_Varios_Movimientos)
        Cm.ExecuteNonQuery()
    End Sub

    Public Function Generar_Numero_Correlativo_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero_Pago As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Pagos_Varios_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Pago & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Pagos_Varios = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Pagos_Varios
    End Function
    Public Function Generar_Numero_Correlativo_Contrato(ByVal Año_Ejecucion As String, ByVal Numero_Contrato As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Contrato_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Contrato & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Contrato = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Contrato
    End Function
    Public Function Generar_Numero_Pagos_Varios(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Pagos_Varios Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Pagos_Varios = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Pagos_Varios
    End Function
    Public Function Generar_Numero_Contrato(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Contrato Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Contrato = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Contrato
    End Function
    Public Sub Autorizar_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Pagos_Varios Set Codigo_Estado_Pago='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Codigo_Estado_Pagos_Varios_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='52'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Pagos_Varios Set Codigo_Estado_Pago='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Codigo_Estado_Pagos_Varios_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='43'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Contrato Set Codigo_Estado_Contrato='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Contrato_Movimientos Set Codigo_Estado_Contrato_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='61'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Autorizar_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Contrato Set Codigo_Estado_Contrato='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Contrato_Movimientos Set Codigo_Estado_Contrato_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='61'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Pagos_Varios Set Codigo_Estado_Pago='01',FechaAprobacion=Null,UsuarioAprobacion=Null,FechaAutorizacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Codigo_Estado_Pagos_Varios_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='43'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Contrato Set Codigo_Estado_Contrato='01',FechaAprobacion=Null,UsuarioAprobacion=Null,FechaAutorizacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Contrato_Movimientos Set Codigo_Estado_Contrato_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='61'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Pagos_Varios Set Codigo_Estado_Pago='04',FechaAprobacion=Null,UsuarioAprobacion=Null,FechaAnulacion=Null,UsuarioAnulacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Pagos_Varios_Movimientos Set Codigo_Estado_Pagos_Varios_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='43'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Contrato Set Codigo_Estado_Contrato='04',FechaAprobacion=Null,UsuarioAprobacion=Null,FechaAnulacion=Null,UsuarioAnulacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Contrato_Movimientos Set Codigo_Estado_Contrato_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='61'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Eliminar_Pagos_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='43'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Pagos_Varios Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Pagos_Varios Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Pagos_Varios_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='43'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Eliminar_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='61'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Contrato Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Contrato Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Contrato_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='61'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Cargar_Pagos_Varios_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Documento As System.Windows.Forms.TextBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox, ByVal Combo_Denominacion As System.Windows.Forms.ComboBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Pagos_Varios_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento").ToString
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            Combo_Denominacion.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Denominacion").ToString
            Variable_Numero_Certificacion = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Variable_Codigo_Proveedor = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Cargar_Contrato_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Combo_Unidad_Organica As System.Windows.Forms.ComboBox, ByVal Date_Inicio As DateTimePicker, ByVal Date_Termino As DateTimePicker)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Contratos_Basica Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Combo_Unidad_Organica.Text = Ds.Tables(0).Rows(0).Item("Unidad").ToString
            Date_Inicio.Value = DateValue(Ds.Tables(0).Rows(0).Item("FechaInicio"))
            Date_Termino.Value = DateValue(Ds.Tables(0).Rows(0).Item("FechaFin"))
            Variable_Numero_Certificacion = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Variable_Codigo_Proveedor = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Sub Evaluacion_Botones_Modulo_Encargos_Internos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Nuevo As DevComponents.DotNetBar.ButtonItem, ByVal Editar As DevComponents.DotNetBar.ButtonItem, ByVal Anular As DevComponents.DotNetBar.ButtonItem, ByVal Eliminar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar As DevComponents.DotNetBar.ButtonItem, ByVal Autorizar As DevComponents.DotNetBar.ButtonItem, ByVal Aprobar As DevComponents.DotNetBar.ButtonItem, ByVal Visualizar As DevComponents.DotNetBar.ButtonItem, ByVal Imprimir As DevComponents.DotNetBar.ButtonItem, ByVal Reenumerar As DevComponents.DotNetBar.ButtonItem, ByVal Detallar As DevComponents.DotNetBar.ButtonItem, ByVal Extornar_Detalle As DevComponents.DotNetBar.ButtonItem)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Encargo_Interno_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Select Case Ds.Tables(0).Rows(0).Item("Codigo_Estado_Encargo").ToString
                Case "01" 'EMITIDO()
                    Nuevo.Enabled = True
                    Editar.Enabled = True
                    Anular.Enabled = True
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = True
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = True
                    Detallar.Enabled = False
                    Extornar_Detalle.Enabled = False
                Case "02" 'AUTORIZADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = True
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                    Detallar.Enabled = False
                    Extornar_Detalle.Enabled = False
                Case "03" 'APROBADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = True
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                    If Ds.Tables(0).Rows(0).Item("Detallado").ToString = "SI" Then
                        If Ds.Tables(0).Rows(0).Item("Rendido").ToString = "NO" Then
                            Detallar.Enabled = False
                            Extornar_Detalle.Enabled = True
                        Else
                            Detallar.Enabled = False
                            Extornar_Detalle.Enabled = False
                        End If
                    Else
                        If Ds.Tables(0).Rows(0).Item("Rendido").ToString = "NO" Then
                            Detallar.Enabled = True
                            Extornar_Detalle.Enabled = False
                        Else
                            Detallar.Enabled = False
                            Extornar_Detalle.Enabled = False
                        End If
                    End If
                Case "04" 'ANULADO()
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = True
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = True
                    Imprimir.Enabled = True
                    Reenumerar.Enabled = False
                    Detallar.Enabled = False
                    Extornar_Detalle.Enabled = False
                Case Else
                    Nuevo.Enabled = True
                    Editar.Enabled = False
                    Anular.Enabled = False
                    Eliminar.Enabled = False
                    Extornar.Enabled = False
                    Autorizar.Enabled = False
                    Aprobar.Enabled = False
                    Visualizar.Enabled = False
                    Imprimir.Enabled = False
                    Reenumerar.Enabled = False
                    Detallar.Enabled = False
                    Extornar_Detalle.Enabled = False
            End Select
        End If
    End Sub
    'Trolin
    Public Sub Nuevo_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Documento As String, ByVal Justificacion As String, ByVal FechaEmision As String, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Pago As String, ByVal Monto As Double, ByVal Certificado As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Unidad_Organica As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Encargo_Interno"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Pago", Codigo_Estado_Pago)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Documento As String, ByVal Justificacion As String, ByVal Monto As Double, ByVal Certificado As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Unidad_Organica As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Encargo_Interno"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Documento", Documento)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Encargo_Interno"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Encargo_Interno_Movimientos(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Numero_Documento As String, ByVal Codigo_Estado_Pagos_Varios_Movimientos As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Encargo_Interno_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Pagos_Varios_Movimientos", Codigo_Estado_Pagos_Varios_Movimientos)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Correlativo_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero_Pago As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Encargo_Interno_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Pago & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Encargo_Interno = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Encargo_Interno
    End Function
    Public Function Generar_Numero_Encargo_Interno(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Encargo_Interno Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Encargo_Interno = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Encargo_Interno
    End Function
    Public Sub Autorizar_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Encargo_Interno Set Codigo_Estado_Encargo='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Encargo_Interno_Movimientos Set Codigo_Estado_Encargo_Interno_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='52'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Encargo_Interno Set Codigo_Estado_Encargo='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Encargo_Interno_Movimientos Set Codigo_Estado_Encargo_Interno_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='52'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Encargo_Interno Set Codigo_Estado_Encargo='01',FechaAprobacion=Null,UsuarioAprobacion=Null,FechaAutorizacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Encargo_Interno_Movimientos Set Codigo_Estado_Encargo_Interno_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='01' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='52'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Encargo_Interno Set Codigo_Estado_Encargo='04',FechaAprobacion=Null,UsuarioAprobacion=Null,FechaAnulacion=Null,UsuarioAnulacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Encargo_Interno_Movimientos Set Codigo_Estado_Encargo_Interno_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Codigo_Estado_Certificado_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='52'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Eliminar_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = True Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='52'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Encargo_Interno Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Encargo_Interno Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Encargo_Interno_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' and Codigo_Tipo_Operacion='52'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Cargar_Encargo_Interno_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Documento As System.Windows.Forms.TextBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox, ByVal Combo_Area As System.Windows.Forms.ComboBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Encargo_Interno_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento").ToString
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            Combo_Area.Text = Ds.Tables(0).Rows(0).Item("Nombre_Unidad_Organica").ToString
            Variable_Numero_Certificacion = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Variable_Codigo_Proveedor = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Function Validar_Meta_Certificado_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String) As Boolean
        Validar_Meta_Certificado_Encargo_Interno = True
        If Validar_Meta_Certificado_Encargo_Interno = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Sum(Saldo) As Saldo From Lista_Detalle_Certificados_Basica_Reportar_Saldos where Año_Ejecucion ='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_SIAF ='A' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' Group By Codigo_Secuencia_Funcional,Codigo_Unidad_Organica", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Validar_Meta_Certificado_Encargo_Interno = True
            Else
                Validar_Meta_Certificado_Encargo_Interno = False
            End If
        End If
        Return Validar_Meta_Certificado_Encargo_Interno
    End Function
    Public Function Obtener_Tipo_Documento_Identificacion(ByVal Codigo_Proveedor As String) As String
        Obtener_Tipo_Documento_Identificacion = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Proveedores Where Codigo_Proveedor='" & Codigo_Proveedor & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Obtener_Tipo_Documento_Identificacion = Ds.Tables(0).Rows(0).Item("Tipo Documento").ToString
        End If
        Return Obtener_Tipo_Documento_Identificacion
    End Function
    Public Function Obtener_Descripcion_Documento_Identificacion(ByVal Codigo_Tipo_Documento As String) As String
        Obtener_Descripcion_Documento_Identificacion = ""
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Tipo_Documento_Identificacion Where Codigo_Tipo_Documento='" & Codigo_Tipo_Documento & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Obtener_Descripcion_Documento_Identificacion = Ds.Tables(0).Rows(0).Item("Descripcion_Larga").ToString
        End If
        Return Obtener_Descripcion_Documento_Identificacion
    End Function
    Public Function Caracteres_Tipo_Documento(ByVal Codigo_Tipo_Documento As String) As Integer
        Caracteres_Tipo_Documento = 0
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Tipo_Documento_Identificacion Where Codigo_Tipo_Documento='" & Codigo_Tipo_Documento & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caracteres_Tipo_Documento = Convert.ToInt32(Ds.Tables(0).Rows(0).Item("Caracteres").ToString)
        End If
        Return Caracteres_Tipo_Documento
    End Function
    Public Function Listar_Devengados_Detalle_Saldos_X_Rebajar(ByVal Año_Ejecucion As String, ByVal Numero As String) As DataSet
        Dim Ds As New DataSet
        Dim Da As OleDb.OleDbDataAdapter
        Da = New OleDb.OleDbDataAdapter("Listar_Devengados_Detalle_Saldos_X_Rebajar " & "'" & Año_Ejecucion & "','" & Numero & "'", Cn)
        Da.Fill(Ds, "Listar_Devengados_Detalle_Saldos_X_Rebajar")
        Return Ds
        Ds.Dispose()
        Da.Dispose()
    End Function
    Public Function Listar_Devengados_Detalle_Saldos_X_Rebajar_2(ByVal Año_Ejecucion As String, ByVal Numero As String) As DataSet
        Dim Ds As New DataSet
        Dim Da As OleDb.OleDbDataAdapter
        Da = New OleDb.OleDbDataAdapter("Listar_Devengados_Detalle_Saldos_X_Rebajar_2 " & "'" & Año_Ejecucion & "','" & Numero & "'", Cn)
        Da.Fill(Ds, "Listar_Devengados_Detalle_Saldos_X_Rebajar_2")
        Return Ds
        Ds.Dispose()
        Da.Dispose()
    End Function
    Public Sub Rebajar_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Documento As String, ByVal Saldo As Double, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Select Case Codigo_Tipo_Documento
            Case "08"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Compra_Movimientos Where Año_Ejecucion ='" & Año_Ejecucion & "' and Numero_Documento ='" & Numero & "' And Codigo_Tipo_Operacion ='07' And Codigo_Estado_Orden_Movimientos ='03'", Cn)
                Dim Ds As New Data.DataSet
                Dim Saldo_Total As Double = 0
                Dim Recorrido_Global As Integer = 0
                Dim Numero_Orden As String = ""
                Dim Correlativo_Devengado As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    If Ds.Tables(0).Rows.Count = 1 Then
                        Numero_Orden = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim Correlativo As String = Me.Generar_Numero_Correlativo_Orden_Compra(My.Settings.Año_Ejecucion, Ds.Tables(0).Rows(0).Item("Numero").ToString)
                        Me.Nuevo_Detalle_Orden_Compra_Movimiento_2(Correlativo, "15", Año_Ejecucion, Ds.Tables(0).Rows(0).Item("Numero").ToString, Ds.Tables(0).Rows(0).Item("Certificado").ToString, Ds.Tables(0).Rows(0).Item("Requerimiento").ToString, Ds.Tables(0).Rows(0).Item("Codigo_FF"), Ds.Tables(0).Rows(0).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(0).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(0).Item("Generica").ToString, Ds.Tables(0).Rows(0).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(0).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(0).Item("Especifica").ToString, Ds.Tables(0).Rows(0).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Item").ToString, 1, Saldo, Numero, "03", Ds.Tables(0).Rows(0).Item("IGV"))
                        Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_2(Año_Ejecucion, Ds.Tables(0).Rows(0).Item("Numero").ToString, Ds.Tables(0).Rows(0).Item("Certificado").ToString, Ds.Tables(0).Rows(0).Item("Requerimiento").ToString, Ds.Tables(0).Rows(0).Item("Codigo_FF"), Ds.Tables(0).Rows(0).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(0).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(0).Item("Generica").ToString, Ds.Tables(0).Rows(0).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(0).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(0).Item("Especifica").ToString, Ds.Tables(0).Rows(0).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Item").ToString, 1, Saldo, Ds.Tables(0).Rows(0).Item("IGV"))
                    End If
                    If Ds.Tables(0).Rows.Count > 1 Then
                        Numero_Orden = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim Correlativo As String = Me.Generar_Numero_Correlativo_Orden_Compra(My.Settings.Año_Ejecucion, Ds.Tables(0).Rows(0).Item("Numero").ToString)

                        Dim Valor As Double = Ds.Tables(0).Rows.Count
                        For Recorrido As Integer = 0 To Valor - 1
                            Me.Nuevo_Detalle_Orden_Compra_Movimiento_2(Correlativo, "15", Año_Ejecucion, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString, Ds.Tables(0).Rows(Recorrido).Item("Requerimiento").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, 1, Saldo / Valor, Numero, "03", Ds.Tables(0).Rows(Recorrido).Item("IGV"))
                            Me.Nuevo_Detalle_Orden_Compra_Centro_Costos_2(Año_Ejecucion, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString, Ds.Tables(0).Rows(Recorrido).Item("Requerimiento").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, 1, Saldo / Valor, Ds.Tables(0).Rows(Recorrido).Item("IGV"))
                        Next
                    End If
                Else
                    Return
                End If
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='07' And Codigo_Documento='12' And Numero_Documento='" & Numero_Orden & "' And Codigo_Estado_Devengado_Movimientos='03'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                For Recorrido_Global = 0 To DataGridView.RowCount - 1
                    If Convert.ToDouble(DataGridView.Rows(Recorrido_Global).Cells(21).Value) > 0 Then
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo_Devengado, "15", Año_Ejecucion, Numero _
                          , DataGridView.Rows(Recorrido_Global).Cells(2).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(3).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(8).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(9).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(10).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(11).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(12).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(13).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(14).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(15).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(16).Value _
                          , Convert.ToDouble(DataGridView.Rows(Recorrido_Global).Cells(21).Value) * -1 _
                          , "12", Numero_Orden, "03", DataGridView.Rows(Recorrido_Global).Cells(6).Value, DataGridView.Rows(Recorrido_Global).Cells(22).Value)
                    End If
                Next
                Me.Liberar_Asiento_Contable(Año_Ejecucion, Numero)
            Case "09"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Orden_Servicio_Movimientos Where Año_Ejecucion ='" & Año_Ejecucion & "' and Numero_Documento ='" & Numero & "' And Codigo_Tipo_Operacion ='08' And Codigo_Estado_Orden_Movimientos ='03'", Cn)
                Dim Ds As New Data.DataSet
                Dim Saldo_Total As Double = 0
                Dim Recorrido_Global As Integer = 0
                Dim Numero_Orden As String = ""
                Dim Correlativo_Devengado As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    If Ds.Tables(0).Rows.Count = 1 Then
                        Numero_Orden = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim Correlativo As String = Me.Generar_Numero_Correlativo_Orden_Servicio(My.Settings.Año_Ejecucion, Ds.Tables(0).Rows(0).Item("Numero").ToString)
                        Me.Nuevo_Detalle_Orden_Servicio_Movimiento(Correlativo, "16", Año_Ejecucion, Ds.Tables(0).Rows(0).Item("Numero").ToString, Ds.Tables(0).Rows(0).Item("Certificado").ToString, Ds.Tables(0).Rows(0).Item("Requerimiento").ToString, Ds.Tables(0).Rows(0).Item("Codigo_FF"), Ds.Tables(0).Rows(0).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(0).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(0).Item("Generica").ToString, Ds.Tables(0).Rows(0).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(0).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(0).Item("Especifica").ToString, Ds.Tables(0).Rows(0).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Item").ToString, 1, Saldo, Numero, "03")
                        Me.Nuevo_Detalle_Orden_Servicio_Centro_Costos(Año_Ejecucion, Ds.Tables(0).Rows(0).Item("Numero").ToString, Ds.Tables(0).Rows(0).Item("Certificado").ToString, Ds.Tables(0).Rows(0).Item("Requerimiento").ToString, Ds.Tables(0).Rows(0).Item("Codigo_FF"), Ds.Tables(0).Rows(0).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(0).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(0).Item("Generica").ToString, Ds.Tables(0).Rows(0).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(0).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(0).Item("Especifica").ToString, Ds.Tables(0).Rows(0).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(0).Item("Codigo_Item").ToString, 1, Saldo)
                    End If
                    If Ds.Tables(0).Rows.Count > 1 Then
                        Numero_Orden = Ds.Tables(0).Rows(0).Item("Numero").ToString
                        Dim Correlativo As String = Me.Generar_Numero_Correlativo_Orden_Servicio(My.Settings.Año_Ejecucion, Ds.Tables(0).Rows(0).Item("Numero").ToString)

                        Dim Valor As Double = Ds.Tables(0).Rows.Count
                        For Recorrido As Integer = 0 To Valor - 1
                            Me.Nuevo_Detalle_Orden_Servicio_Movimiento(Correlativo, "16", Año_Ejecucion, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString, Ds.Tables(0).Rows(Recorrido).Item("Requerimiento").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, 1, Saldo / Valor, Numero, "03")
                            Me.Nuevo_Detalle_Orden_Servicio_Centro_Costos(Año_Ejecucion, Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString, Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString, Ds.Tables(0).Rows(Recorrido).Item("Requerimiento").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"), Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro").ToString, Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion").ToString, Ds.Tables(0).Rows(Recorrido).Item("Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Catalogo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Grupo").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Clase").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Familia").ToString, Ds.Tables(0).Rows(Recorrido).Item("Codigo_Item").ToString, 1, Saldo / Valor)
                        Next
                    End If
                Else
                    Return
                End If
                Da = Nothing
                Ds = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='08' And Codigo_Documento='13' And Numero_Documento='" & Numero_Orden & "' And Codigo_Estado_Devengado_Movimientos='03'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                For Recorrido_Global = 0 To DataGridView.RowCount - 1
                    If Convert.ToDouble(DataGridView.Rows(Recorrido_Global).Cells(21).Value) > 0 Then
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo_Devengado, "16", Año_Ejecucion, Numero _
                          , DataGridView.Rows(Recorrido_Global).Cells(2).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(3).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(8).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(9).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(10).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(11).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(12).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(13).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(14).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(15).Value _
                          , DataGridView.Rows(Recorrido_Global).Cells(16).Value _
                          , Convert.ToDouble(DataGridView.Rows(Recorrido_Global).Cells(21).Value) * -1 _
                          , "13", Numero_Orden, "03", DataGridView.Rows(Recorrido_Global).Cells(6).Value, DataGridView.Rows(Recorrido_Global).Cells(22).Value)
                    End If
                Next
                Me.Liberar_Asiento_Contable(Año_Ejecucion, Numero)
        End Select
    End Sub
    Public Sub Rebajar_Devengado_Varios(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Documento As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Select Case Codigo_Tipo_Documento
            Case "31"
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='44' And Codigo_Estado_Devengado_Movimientos='03'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)

                Dim Numero_Documento_Rebaja As String = Ds.Tables(0).Rows(0).Item("Numero_Documento").ToString
                Dim Correlativo_Devengado As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero)
                Dim Correlativo_Pago_Vario As String = Me.Generar_Numero_Correlativo_Devengado(Año_Ejecucion, Numero_Documento_Rebaja)
                For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                    If Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(21).Value) > 0 Then
                        Me.Nuevo_Detalle_Devengado_Movimientos(Correlativo_Devengado, "51", Año_Ejecucion, Numero _
                          , DataGridView.Rows(Recorrido).Cells(2).Value _
                          , DataGridView.Rows(Recorrido).Cells(3).Value _
                          , DataGridView.Rows(Recorrido).Cells(8).Value _
                          , DataGridView.Rows(Recorrido).Cells(9).Value _
                          , DataGridView.Rows(Recorrido).Cells(10).Value _
                          , DataGridView.Rows(Recorrido).Cells(11).Value _
                          , DataGridView.Rows(Recorrido).Cells(12).Value _
                          , DataGridView.Rows(Recorrido).Cells(13).Value _
                          , DataGridView.Rows(Recorrido).Cells(14).Value _
                          , DataGridView.Rows(Recorrido).Cells(15).Value _
                          , DataGridView.Rows(Recorrido).Cells(16).Value _
                          , Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(21).Value) * -1 _
                          , "32", Numero_Documento_Rebaja, "03", DataGridView.Rows(Recorrido).Cells(6).Value, DataGridView.Rows(Recorrido).Cells(22).Value)
                        Me.Nuevo_Detalle_Pagos_Varios_Movimientos(Correlativo_Pago_Vario, "51", Año_Ejecucion, Numero_Documento_Rebaja _
                          , DataGridView.Rows(Recorrido).Cells(2).Value _
                          , DataGridView.Rows(Recorrido).Cells(3).Value _
                          , DataGridView.Rows(Recorrido).Cells(6).Value _
                          , DataGridView.Rows(Recorrido).Cells(8).Value _
                          , DataGridView.Rows(Recorrido).Cells(9).Value _
                          , DataGridView.Rows(Recorrido).Cells(10).Value _
                          , DataGridView.Rows(Recorrido).Cells(11).Value _
                          , DataGridView.Rows(Recorrido).Cells(12).Value _
                          , DataGridView.Rows(Recorrido).Cells(13).Value _
                          , DataGridView.Rows(Recorrido).Cells(14).Value _
                          , DataGridView.Rows(Recorrido).Cells(15).Value _
                          , DataGridView.Rows(Recorrido).Cells(16).Value _
                          , Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(21).Value) _
                          , Numero_Documento_Rebaja, "03")
                        Dim Monto_Anterior As Double = Me.Paso_01_Obtener_Monto_Detalle_Devengado(Año_Ejecucion, Numero _
                          , DataGridView.Rows(Recorrido).Cells(2).Value _
                          , DataGridView.Rows(Recorrido).Cells(3).Value _
                          , DataGridView.Rows(Recorrido).Cells(6).Value _
                          , DataGridView.Rows(Recorrido).Cells(8).Value _
                          , DataGridView.Rows(Recorrido).Cells(9).Value _
                          , DataGridView.Rows(Recorrido).Cells(10).Value _
                          , DataGridView.Rows(Recorrido).Cells(11).Value _
                          , DataGridView.Rows(Recorrido).Cells(12).Value _
                          , DataGridView.Rows(Recorrido).Cells(13).Value _
                          , DataGridView.Rows(Recorrido).Cells(14).Value _
                          , DataGridView.Rows(Recorrido).Cells(15).Value _
                          , DataGridView.Rows(Recorrido).Cells(16).Value)
                        Dim Monto_Nuevo = Monto_Anterior - Math.Abs(Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(21).Value))
                        Me.Paso_02_Actualizar_Monto_Detalle_Devengado(Año_Ejecucion, Numero _
                          , DataGridView.Rows(Recorrido).Cells(2).Value _
                          , DataGridView.Rows(Recorrido).Cells(3).Value _
                          , DataGridView.Rows(Recorrido).Cells(6).Value _
                          , DataGridView.Rows(Recorrido).Cells(8).Value _
                          , DataGridView.Rows(Recorrido).Cells(9).Value _
                          , DataGridView.Rows(Recorrido).Cells(10).Value _
                          , DataGridView.Rows(Recorrido).Cells(11).Value _
                          , DataGridView.Rows(Recorrido).Cells(12).Value _
                          , DataGridView.Rows(Recorrido).Cells(13).Value _
                          , DataGridView.Rows(Recorrido).Cells(14).Value _
                          , DataGridView.Rows(Recorrido).Cells(15).Value _
                          , DataGridView.Rows(Recorrido).Cells(16).Value, Monto_Nuevo)
                        Me.Paso_03_Deletear_Monto_Detalle_Devengado_Ceros(Año_Ejecucion, Numero _
                          , DataGridView.Rows(Recorrido).Cells(2).Value _
                          , DataGridView.Rows(Recorrido).Cells(3).Value _
                          , DataGridView.Rows(Recorrido).Cells(6).Value _
                          , DataGridView.Rows(Recorrido).Cells(8).Value _
                          , DataGridView.Rows(Recorrido).Cells(9).Value _
                          , DataGridView.Rows(Recorrido).Cells(10).Value _
                          , DataGridView.Rows(Recorrido).Cells(11).Value _
                          , DataGridView.Rows(Recorrido).Cells(12).Value _
                          , DataGridView.Rows(Recorrido).Cells(13).Value _
                          , DataGridView.Rows(Recorrido).Cells(14).Value _
                          , DataGridView.Rows(Recorrido).Cells(15).Value _
                          , DataGridView.Rows(Recorrido).Cells(16).Value)
                        Me.Paso_04_Limpiar_Devengado_Monto(Año_Ejecucion, Numero)
                        Me.Liberar_Asiento_Contable(Año_Ejecucion, Numero)
                    End If
                Next
        End Select
    End Sub
    Public Function Paso_01_Obtener_Monto_Detalle_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String) As Double
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Detalle_Devengado " _
         & " Where Año_Ejecucion ='" & Año_Ejecucion & "' and numero='" & Numero & "' " _
         & " And Codigo_FF='" & Codigo_FF & "' And Codigo_Rubro='" & Codigo_Rubro & "' " _
         & " And Codigo_Tipo_Recurso='" & Codigo_Tipo_Recurso & "' And Tipo_Transaccion ='" & Tipo_Transaccion & "' " _
         & " And Generica ='" & Generica & "' And Sub_Generica ='" & Sub_Generica & "' " _
         & " And Sub_Generica_Detalle ='" & Sub_Generica & "' And Especifica='" & Especifica & "' " _
         & " And Especifica_Detalle ='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' " _
         & " And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Paso_01_Obtener_Monto_Detalle_Devengado = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString)
        Else
            Paso_01_Obtener_Monto_Detalle_Devengado = 0
        End If
        Return Paso_01_Obtener_Monto_Detalle_Devengado
        Da = Nothing
        Ds = Nothing
    End Function
    Public Sub Paso_02_Actualizar_Monto_Detalle_Devengado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Dim Query As String = "Update Detalle_Devengado Set Monto=" & Monto _
         & " Where Año_Ejecucion ='" & Año_Ejecucion & "' and numero='" & Numero & "' " _
         & " And Codigo_FF='" & Codigo_FF & "' And Codigo_Rubro='" & Codigo_Rubro & "' " _
         & " And Codigo_Tipo_Recurso='" & Codigo_Tipo_Recurso & "' And Tipo_Transaccion ='" & Tipo_Transaccion & "' " _
         & " And Generica ='" & Generica & "' And Sub_Generica ='" & Sub_Generica & "' " _
         & " And Sub_Generica_Detalle ='" & Sub_Generica & "' And Especifica='" & Especifica & "' " _
         & " And Especifica_Detalle ='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' " _
         & " And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = Query
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Paso_03_Deletear_Monto_Detalle_Devengado_Ceros(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String)
        Dim Cm As New OleDb.OleDbCommand
        Dim Query As String = "Delete From Detalle_Devengado Where Monto <=0 " _
         & " And Año_Ejecucion ='" & Año_Ejecucion & "' and numero='" & Numero & "' " _
         & " And Codigo_FF='" & Codigo_FF & "' And Codigo_Rubro='" & Codigo_Rubro & "' " _
         & " And Codigo_Tipo_Recurso='" & Codigo_Tipo_Recurso & "' And Tipo_Transaccion ='" & Tipo_Transaccion & "' " _
         & " And Generica ='" & Generica & "' And Sub_Generica ='" & Sub_Generica & "' " _
         & " And Sub_Generica_Detalle ='" & Sub_Generica & "' And Especifica='" & Especifica & "' " _
         & " And Especifica_Detalle ='" & Especifica_Detalle & "' And Codigo_Secuencia_Funcional='" & Codigo_Secuencia_Funcional & "' " _
         & " And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Codigo_Actividad='" & Codigo_Actividad & "'"
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = Query
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Paso_04_Limpiar_Devengado_Monto(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Monto As Double = 0

        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Monto = Monto + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)
            Next
        End If
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Devengado Set Sub_Total=0,Check_IGV=0,Check_Renta=0,Renta=0,Otros=0,Monto_Total=" & Monto & " Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Cargar_Detalle_Compromisos_Devengados_Asientos_Giro(ByVal Año_Ejecucion As String, ByVal Expediente As String, ByVal DataCompromisos As System.Windows.Forms.DataGridView, ByVal DataDevengados As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion As Año,Numero,'DEVENGADO' as Fase,Compromiso as [Exp.],Convert(VarChar(10), FechaEmision,103)  As [F.Emision],Nombre_Tipo_Documento As Documento,Numero_Documento +' - '+ Año_Ejecucion As [Nro.Doc.], Monto_Total as Monto,Saldo,Certificado as Certificado From Lista_Devengados_Basica Where Año_Ejecucion ='" & Año_Ejecucion & "' And Compromiso='" & Expediente & "' Order By FechaEmision", Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataDevengados.Rows.Add()
                DataDevengados.Item(0, DataDevengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                DataDevengados.Item(1, DataDevengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataDevengados.Item(2, DataDevengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Fase").ToString
                DataDevengados.Item(3, DataDevengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Exp.").ToString
                DataDevengados.Item(4, DataDevengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("F.Emision").ToString
                DataDevengados.Item(5, DataDevengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Documento").ToString
                DataDevengados.Item(6, DataDevengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Nro.Doc.").ToString
                DataDevengados.Item(7, DataDevengados.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataDevengados.Item(8, DataDevengados.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                DataDevengados.Item(9, DataDevengados.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString
            Next
        Else
            Return
        End If
        Da = Nothing
        Ds = Nothing
        Da = New OleDb.OleDbDataAdapter("Select Año,Numero,Fase,IsNull([Exp.],'[N/A]') As [Exp.],[F.Emision],Documento,Numero +' - '+ Año as [Nro.Doc.],Monto,Saldo,ISNULL(Certificado,'[N/A]') As Certificado,Tipo From Lista_Compromisos_Globales Where Año='" & Año_Ejecucion & "' And [Exp.]='" & Expediente & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataCompromisos.Rows.Add()
                DataCompromisos.Item(0, DataCompromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                DataCompromisos.Item(1, DataCompromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataCompromisos.Item(2, DataCompromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Fase").ToString
                DataCompromisos.Item(3, DataCompromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Exp.").ToString
                DataCompromisos.Item(4, DataCompromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("F.Emision").ToString
                DataCompromisos.Item(5, DataCompromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Documento").ToString
                DataCompromisos.Item(6, DataCompromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Nro.Doc.").ToString
                DataCompromisos.Item(7, DataCompromisos.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataCompromisos.Item(8, DataCompromisos.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                DataCompromisos.Item(9, DataCompromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Certificado").ToString
                DataCompromisos.Item(10, DataCompromisos.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Tipo").ToString
            Next
        Else
            Return
        End If
    End Sub
    Public Sub Cargar_Data_Basica_Certificado_Edicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Caja_Numero As System.Windows.Forms.TextBox, ByVal Caja_Fecha As System.Windows.Forms.TextBox, ByVal Caja_Documento As System.Windows.Forms.TextBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox, ByVal Caja_Tipo_Operacion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Certificados_Basica Where Año_Ejecucion = '" & Año_Ejecucion & "' And Numero ='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Numero.Text = Numero & " - " & Año_Ejecucion
            Caja_Fecha.Text = Format(Convert.ToDateTime(Ds.Tables(0).Rows(0).Item("FechaEmision").ToString), "dd/MM/yyyy")
            Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento").ToString
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Justificacion").ToString
            Caja_Tipo_Operacion.Text = Ds.Tables(0).Rows(0).Item("Tipo_Operacion").ToString
        Else
            Return
        End If
    End Sub
    Public Sub Actualizar_Glosa_Justificacion_Certificado(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Documento As String, ByVal Justificacion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Certificado Set Documento='" & Documento & "', Justificacion='" & Justificacion & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Exportar_Lista_Devengados_FOX(ByVal Query As String)
        Dim Da As New OleDb.OleDbDataAdapter(Query, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "DOCODI"
            Excel.Application.Cells(1, "B") = "DONUME"
            Excel.Application.Cells(1, "C") = "DOFECH"
            Excel.Application.Cells(1, "D") = "AUXCOD"
            Excel.Application.Cells(1, "E") = "DORFCODI"
            Excel.Application.Cells(1, "F") = "DORFFECH"
            Excel.Application.Cells(1, "G") = "DORFNUME"
            Excel.Application.Cells(1, "H") = "DONOCO"
            Excel.Application.Cells(1, "I") = "DOGLCO"
            Excel.Application.Cells(1, "J") = "PLCODI"
            Excel.Application.Cells(1, "K") = "DODEHA"
            Excel.Application.Cells(1, "L") = "DOMOVI"
            Excel.Application.Cells(1, "M") = "ANULADO"
            Excel.Application.Cells(1, "N") = "CLASE"
            Excel.Application.Cells(1, "O") = "CAMMEM"
            Excel.Application.Cells(1, "P") = "FSIS"
            Excel.Application.Cells(1, "Q") = "USER"
            Excel.Application.Cells(1, "R") = "PERIODO"
            Excel.Application.Cells(1, "S") = "GLOSA"
            Excel.Application.Cells(1, "T") = "DORGCODI"
            Excel.Application.Cells(1, "U") = "DORGNUME"
            Excel.Application.Cells(1, "V") = "MES"
            Excel.Application.Cells(1, "W") = "C.COSTOS"
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Excel.Application.Cells(Recorrido + 2, "A") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DOCODI").ToString
                Excel.Application.Cells(Recorrido + 2, "B") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DONUME").ToString
                Excel.Application.Cells(Recorrido + 2, "C") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DOFECH").ToString
                Excel.Application.Cells(Recorrido + 2, "D") = "'" & Ds.Tables(0).Rows(Recorrido).Item("AUXCOD").ToString
                Excel.Application.Cells(Recorrido + 2, "E") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORFCODI").ToString
                Excel.Application.Cells(Recorrido + 2, "F") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORFFECH").ToString
                Excel.Application.Cells(Recorrido + 2, "G") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORFNUME").ToString
                Excel.Application.Cells(Recorrido + 2, "H") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DONOCO").ToString
                Excel.Application.Cells(Recorrido + 2, "I") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DOGLCO").ToString
                Excel.Application.Cells(Recorrido + 2, "J") = "'" & Ds.Tables(0).Rows(Recorrido).Item("PLCODI").ToString
                Excel.Application.Cells(Recorrido + 2, "K") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DODEHA").ToString
                Excel.Application.Cells(Recorrido + 2, "L") = Ds.Tables(0).Rows(Recorrido).Item("DOMOVI").ToString
                Excel.Application.Cells(Recorrido + 2, "M") = "'" & Ds.Tables(0).Rows(Recorrido).Item("ANULADO").ToString
                Excel.Application.Cells(Recorrido + 2, "N") = "'" & Ds.Tables(0).Rows(Recorrido).Item("CLASE").ToString
                Excel.Application.Cells(Recorrido + 2, "O") = "'" & Ds.Tables(0).Rows(Recorrido).Item("CAMMEM").ToString
                Excel.Application.Cells(Recorrido + 2, "P") = "'" & Ds.Tables(0).Rows(Recorrido).Item("FSIS").ToString
                Excel.Application.Cells(Recorrido + 2, "Q") = "'" & Ds.Tables(0).Rows(Recorrido).Item("USER").ToString
                Excel.Application.Cells(Recorrido + 2, "R") = "'" & Ds.Tables(0).Rows(Recorrido).Item("PERIODO").ToString
                Excel.Application.Cells(Recorrido + 2, "S") = "'" & Ds.Tables(0).Rows(Recorrido).Item("GLOSA").ToString
                Excel.Application.Cells(Recorrido + 2, "T") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORGCODI").ToString
                Excel.Application.Cells(Recorrido + 2, "U") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORGNUME").ToString
                Excel.Application.Cells(Recorrido + 2, "V") = "'" & Ds.Tables(0).Rows(Recorrido).Item("MES").ToString
                Excel.Application.Cells(Recorrido + 2, "W") = "'" & Ds.Tables(0).Rows(Recorrido).Item("C.Costos").ToString
                Excel.Application.Range("A" & Recorrido + 1, "W" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 7.45
            Hoja.Range("B1").ColumnWidth = 8.45
            Hoja.Range("C1").ColumnWidth = 10
            Hoja.Range("D1").ColumnWidth = 11.3
            Hoja.Range("E1").ColumnWidth = 9.6
            Hoja.Range("F1").ColumnWidth = 9.6
            Hoja.Range("G1").ColumnWidth = 10.6
            Hoja.Range("H1").ColumnWidth = 8.5
            Hoja.Range("I1").ColumnWidth = 7.75
            Hoja.Range("J1").ColumnWidth = 16.5
            Hoja.Range("K1").ColumnWidth = 8
            Hoja.Range("L1").ColumnWidth = 9.5
            Hoja.Range("M1").ColumnWidth = 9.15
            Hoja.Range("N1").ColumnWidth = 5.6
            Hoja.Range("O1").ColumnWidth = 8.9
            Hoja.Range("P1").ColumnWidth = 10
            Hoja.Range("Q1").ColumnWidth = 17
            Hoja.Range("R1").ColumnWidth = 8.3
            Hoja.Range("S1").ColumnWidth = 40
            Hoja.Range("T1").ColumnWidth = 9.9
            Hoja.Range("U1").ColumnWidth = 35
            Hoja.Range("V1").ColumnWidth = 4
            Hoja.Range("W1").ColumnWidth = 10
            Hoja.Range("A1", "W1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A2", "I" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("K2", "K" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("M2", "P" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("R2", "R" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("V2", "V" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("S2", "S" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "W" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("S2", "S" & Recorrido + 2).WrapText = True
            Hoja.Range("L2", "L" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE DEVENGADOS"
            Hoja.Range("A" & Recorrido + 2, "W" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "W" & Recorrido + 2).MergeCells = True
        Else
            MessageBox.Show("No Hay Registros para Mostrar de Acuerdo a los Parámetros seleccionados", "Reporte Devengados", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
            Exit Sub
        End If
    End Sub

    Public Sub Exportar_Lista_CN(ByVal Query As String)
        Dim Da As New OleDb.OleDbDataAdapter(Query, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Excel As New Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet
            Dim Recorrido2 as integer
            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data CN"
            Excel.Application.Cells(1, "A") = "Unidad.Organica"
            Excel.Application.Cells(1, "B") = "Año"
            Excel.Application.Cells(1, "C") = "Tipo.Catalogo"
            Excel.Application.Cells(1, "D") = "Partida"
            Excel.Application.Cells(1, "E") = "Nombre.Partida"
            Excel.Application.Cells(1, "F") = "Codigo"
            Excel.Application.Cells(1, "G") = "Descripcion.Bien.Servicio"
            Excel.Application.Cells(1, "H") = "U.Medida"
            Excel.Application.Cells(1, "I") = "Precio.Unit"
            Excel.Application.Cells(1, "J") = "Cantidad.Total"
            Excel.Application.Cells(1, "K") = "Enero"
            Excel.Application.Cells(1, "L") = "Febrero"
            Excel.Application.Cells(1, "M") = "Marzo"
            Excel.Application.Cells(1, "N") = "Abril"
            Excel.Application.Cells(1, "O") = "Mayo"
            Excel.Application.Cells(1, "P") = "Junio"
            Excel.Application.Cells(1, "Q") = "Julio"
            Excel.Application.Cells(1, "R") = "Agosto"
            Excel.Application.Cells(1, "S") = "Septiembre"
            Excel.Application.Cells(1, "T") = "Octubre"
            Excel.Application.Cells(1, "U") = "Noviembre"
            Excel.Application.Cells(1, "V") = "Diciembre"
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Excel.Application.Cells(Recorrido + 2, "A") = Ds.Tables(0).Rows(Recorrido).Item(0).ToString()
                Excel.Application.Cells(Recorrido + 2, "B") = Ds.Tables(0).Rows(Recorrido).Item(1).ToString()
                Excel.Application.Cells(Recorrido + 2, "C") = Ds.Tables(0).Rows(Recorrido).Item(2).ToString()
                Excel.Application.Cells(Recorrido + 2, "D") = Ds.Tables(0).Rows(Recorrido).Item(3).ToString()
                Excel.Application.Cells(Recorrido + 2, "E") = Ds.Tables(0).Rows(Recorrido).Item(4).ToString()
                Excel.Application.Cells(Recorrido + 2, "F") = Ds.Tables(0).Rows(Recorrido).Item(5).ToString()
                Excel.Application.Cells(Recorrido + 2, "G") = Ds.Tables(0).Rows(Recorrido).Item(6).ToString()
                Excel.Application.Cells(Recorrido + 2, "H") = Ds.Tables(0).Rows(Recorrido).Item(7).ToString()
                Excel.Application.Cells(Recorrido + 2, "I") = Ds.Tables(0).Rows(Recorrido).Item(8).ToString()
                Excel.Application.Cells(Recorrido + 2, "J") = Ds.Tables(0).Rows(Recorrido).Item(9).ToString()
                Excel.Application.Cells(Recorrido + 2, "K") = Ds.Tables(0).Rows(Recorrido).Item(10).ToString()
                Excel.Application.Cells(Recorrido + 2, "L") = Ds.Tables(0).Rows(Recorrido).Item(11).ToString()
                Excel.Application.Cells(Recorrido + 2, "M") = Ds.Tables(0).Rows(Recorrido).Item(12).ToString()
                Excel.Application.Cells(Recorrido + 2, "N") = Ds.Tables(0).Rows(Recorrido).Item(13).ToString()
                Excel.Application.Cells(Recorrido + 2, "O") = Ds.Tables(0).Rows(Recorrido).Item(14).ToString()
                Excel.Application.Cells(Recorrido + 2, "P") = Ds.Tables(0).Rows(Recorrido).Item(15).ToString()
                Excel.Application.Cells(Recorrido + 2, "Q") = Ds.Tables(0).Rows(Recorrido).Item(16).ToString()
                Excel.Application.Cells(Recorrido + 2, "R") = Ds.Tables(0).Rows(Recorrido).Item(17).ToString()
                Excel.Application.Cells(Recorrido + 2, "S") = Ds.Tables(0).Rows(Recorrido).Item(17).ToString()
                Excel.Application.Cells(Recorrido + 2, "T") = Ds.Tables(0).Rows(Recorrido).Item(18).ToString()
                Excel.Application.Cells(Recorrido + 2, "U") = Ds.Tables(0).Rows(Recorrido).Item(19).ToString()
                Excel.Application.Cells(Recorrido + 2, "V") = Ds.Tables(0).Rows(Recorrido).Item(20).ToString()
                Excel.Application.Range("A" & Recorrido + 1, "V" & Recorrido + 2).Borders.LineStyle = 2
                Recorrido2 = Recorrido
            Next
            Hoja.Range("A1").ColumnWidth = 30
            Hoja.Range("B1").ColumnWidth = 5
            Hoja.Range("C1").ColumnWidth = 15
            Hoja.Range("D1").ColumnWidth = 17'nom partida
            Hoja.Range("E1").ColumnWidth = 30'codigo
            Hoja.Range("F1").ColumnWidth = 20
            Hoja.Range("G1").ColumnWidth = 30
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 15
            Hoja.Range("J1").ColumnWidth = 15
            Hoja.Range("K1").ColumnWidth = 10
            Hoja.Range("L1").ColumnWidth = 10
            Hoja.Range("M1").ColumnWidth = 10
            Hoja.Range("N1").ColumnWidth = 10
            Hoja.Range("O1").ColumnWidth = 10
            Hoja.Range("P1").ColumnWidth = 10
            Hoja.Range("Q1").ColumnWidth = 10
            Hoja.Range("R1").ColumnWidth = 10
            Hoja.Range("S1").ColumnWidth = 10
            Hoja.Range("T1").ColumnWidth = 10
            Hoja.Range("U1").ColumnWidth = 10
            Hoja.Range("V1").ColumnWidth = 10
            Hoja.Range("A1", "V1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("D2", "D" & Recorrido2 + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("F2", "F" & Recorrido2 + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "V" & Recorrido2 + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            'Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("I2", "V" & Recorrido2 + 2).NumberFormat = "#,###,##0.00"
            
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "CUADRO NECESIDADES"
            Hoja.Range("A" & Recorrido2 + 3, "V" & Recorrido2 + 3).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido2 + 3, "V" & Recorrido2 + 3).MergeCells = True
        End If
    End Sub

    Public Sub Exportar_Lista_Comprobantes_FOX(ByVal Query As String)
        Dim Da As New OleDb.OleDbDataAdapter(Query, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "DOCODI"
            Excel.Application.Cells(1, "B") = "DONUME"
            Excel.Application.Cells(1, "C") = "DOFECH"
            Excel.Application.Cells(1, "D") = "AUXCOD"
            Excel.Application.Cells(1, "E") = "DORFCODI"
            Excel.Application.Cells(1, "F") = "DORFFECH"
            Excel.Application.Cells(1, "G") = "DORFNUME"
            Excel.Application.Cells(1, "H") = "DONOCO"
            Excel.Application.Cells(1, "I") = "DOGLCO"
            Excel.Application.Cells(1, "J") = "PLCODI"
            Excel.Application.Cells(1, "K") = "DODEHA"
            Excel.Application.Cells(1, "L") = "DOMOVI"
            Excel.Application.Cells(1, "M") = "ANULADO"
            Excel.Application.Cells(1, "N") = "CLASE"
            Excel.Application.Cells(1, "O") = "CAMMEM"
            Excel.Application.Cells(1, "P") = "FSIS"
            Excel.Application.Cells(1, "Q") = "USER"
            Excel.Application.Cells(1, "R") = "PERIODO"
            Excel.Application.Cells(1, "S") = "GLOSA"
            Excel.Application.Cells(1, "T") = "DORGCODI"
            Excel.Application.Cells(1, "U") = "DORGNUME"
            Excel.Application.Cells(1, "V") = "MES"
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Excel.Application.Cells(Recorrido + 2, "A") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DOCODI").ToString
                Excel.Application.Cells(Recorrido + 2, "B") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DONUME").ToString
                Excel.Application.Cells(Recorrido + 2, "C") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DOFECH").ToString
                Excel.Application.Cells(Recorrido + 2, "D") = "'" & Ds.Tables(0).Rows(Recorrido).Item("AUXCOD").ToString
                Excel.Application.Cells(Recorrido + 2, "E") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORFCODI").ToString
                Excel.Application.Cells(Recorrido + 2, "F") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORFFECH").ToString
                Excel.Application.Cells(Recorrido + 2, "G") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORFNUME").ToString
                Excel.Application.Cells(Recorrido + 2, "H") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DONOCO").ToString
                Excel.Application.Cells(Recorrido + 2, "I") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DOGLCO").ToString
                Excel.Application.Cells(Recorrido + 2, "J") = "'" & Ds.Tables(0).Rows(Recorrido).Item("PLCODI").ToString
                Excel.Application.Cells(Recorrido + 2, "K") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DODEHA").ToString
                Excel.Application.Cells(Recorrido + 2, "L") = Ds.Tables(0).Rows(Recorrido).Item("DOMOVI").ToString
                Excel.Application.Cells(Recorrido + 2, "M") = "'" & Ds.Tables(0).Rows(Recorrido).Item("ANULADO").ToString
                Excel.Application.Cells(Recorrido + 2, "N") = "'" & Ds.Tables(0).Rows(Recorrido).Item("CLASE").ToString
                Excel.Application.Cells(Recorrido + 2, "O") = "'" & Ds.Tables(0).Rows(Recorrido).Item("CAMMEM").ToString
                Excel.Application.Cells(Recorrido + 2, "P") = "'" & Ds.Tables(0).Rows(Recorrido).Item("FSIS").ToString
                Excel.Application.Cells(Recorrido + 2, "Q") = "'" & Ds.Tables(0).Rows(Recorrido).Item("USER").ToString
                Excel.Application.Cells(Recorrido + 2, "R") = "'" & Ds.Tables(0).Rows(Recorrido).Item("PERIODO").ToString
                Excel.Application.Cells(Recorrido + 2, "S") = "'" & Ds.Tables(0).Rows(Recorrido).Item("GLOSA").ToString
                Excel.Application.Cells(Recorrido + 2, "T") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORGCODI").ToString
                Excel.Application.Cells(Recorrido + 2, "U") = "'" & Ds.Tables(0).Rows(Recorrido).Item("DORGNUME").ToString
                Excel.Application.Cells(Recorrido + 2, "V") = "'" & Ds.Tables(0).Rows(Recorrido).Item("MES").ToString
                Excel.Application.Range("A" & Recorrido + 1, "V" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 7.45
            Hoja.Range("B1").ColumnWidth = 8.45
            Hoja.Range("C1").ColumnWidth = 10
            Hoja.Range("D1").ColumnWidth = 11.3
            Hoja.Range("E1").ColumnWidth = 9.6
            Hoja.Range("F1").ColumnWidth = 9.6
            Hoja.Range("G1").ColumnWidth = 10.6
            Hoja.Range("H1").ColumnWidth = 8.5
            Hoja.Range("I1").ColumnWidth = 7.75
            Hoja.Range("J1").ColumnWidth = 16.5
            Hoja.Range("K1").ColumnWidth = 8
            Hoja.Range("L1").ColumnWidth = 9.5
            Hoja.Range("M1").ColumnWidth = 9.15
            Hoja.Range("N1").ColumnWidth = 5.6
            Hoja.Range("O1").ColumnWidth = 8.9
            Hoja.Range("P1").ColumnWidth = 10
            Hoja.Range("Q1").ColumnWidth = 17
            Hoja.Range("R1").ColumnWidth = 8.3
            Hoja.Range("S1").ColumnWidth = 40
            Hoja.Range("T1").ColumnWidth = 9.9
            Hoja.Range("U1").ColumnWidth = 35
            Hoja.Range("V1").ColumnWidth = 4
            Hoja.Range("A1", "V1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A2", "I" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("K2", "K" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("M2", "P" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("R2", "R" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("V2", "V" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("S2", "S" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "V" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("S2", "S" & Recorrido + 2).WrapText = True
            Hoja.Range("L2", "L" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE COMPROBANTES"
            Hoja.Range("A" & Recorrido + 2, "V" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "V" & Recorrido + 2).MergeCells = True
        Else
            MessageBox.Show("No Hay Registros para Mostrar de Acuerdo a los Parámetros seleccionados", "Reporte Devengados", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
            Exit Sub
        End If
    End Sub
    Public Sub Resumenes_Caja_Chica(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As String, ByVal DataGridView_1 As System.Windows.Forms.DataGridView, ByVal DataGridView_2 As System.Windows.Forms.DataGridView, ByVal Caja_Tipo As System.Windows.Forms.TextBox, ByVal Caja_Numero As System.Windows.Forms.TextBox, ByVal Caja_Rendicion As System.Windows.Forms.TextBox, ByVal Caja_Unidad_Organica As System.Windows.Forms.TextBox, ByVal Caja_Centro_Costos As System.Windows.Forms.TextBox, ByVal Caja_Fuente As System.Windows.Forms.TextBox, ByVal Caja_Total_01 As System.Windows.Forms.TextBox, ByVal Caja_Total_02 As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Resumen_Presupuestal_Caja_Chica Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero='" & Numero & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Total_Presupuestal As Double = 0
        Dim Total_Denominacion As Double = 0

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Centro_Costos.Text = Ds.Tables(0).Rows(0).Item("Abreviatura").ToString
            Caja_Fuente.Text = Ds.Tables(0).Rows(0).Item("Rubro").ToString
            Caja_Tipo.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Tipo_Caja").ToString
            Caja_Numero.Text = Ds.Tables(0).Rows(0).Item("Numero").ToString
            Caja_Rendicion.Text = Ds.Tables(0).Rows(0).Item("Numero_Rendicion").ToString
            Caja_Unidad_Organica.Text = Ds.Tables(0).Rows(0).Item("Nombre_Unidad_Organica").ToString
        End If
        DataGridView_1.Rows.Clear()
        DataGridView_2.Rows.Clear()
        For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            DataGridView_1.Rows.Add()
            DataGridView_1.Item(0, DataGridView_1.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
            DataGridView_1.Item(1, DataGridView_1.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            DataGridView_1.Item(2, DataGridView_1.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
            DataGridView_1.Item(3, DataGridView_1.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
            Total_Presupuestal = Total_Presupuestal + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)
        Next
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Resumen_Denominacion_Caja_Chica Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero='" & Numero & "' And Numero_Rendicion='" & Numero_Rendicion & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
            DataGridView_2.Rows.Add()
            DataGridView_2.Item(0, DataGridView_2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
            DataGridView_2.Item(1, DataGridView_2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
            DataGridView_2.Item(2, DataGridView_2.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Denominacion").ToString
            DataGridView_2.Item(3, DataGridView_2.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
            Total_Denominacion = Total_Denominacion + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString)
        Next
        Caja_Total_01.Text = Format(Total_Presupuestal, "###,###,#.00")
        Caja_Total_02.Text = Format(Total_Denominacion, "###,###,#.00")
    End Sub
    Public Sub Exportar_Grilla_Resumen_Caja(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Total As Double = 0
            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = DataGridView.Columns(0).HeaderText.ToString
            Excel.Application.Cells(1, "B") = DataGridView.Columns(1).HeaderText.ToString
            Excel.Application.Cells(1, "C") = DataGridView.Columns(2).HeaderText.ToString
            Excel.Application.Cells(1, "D") = DataGridView.Columns(3).HeaderText.ToString
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value.Trim
                Excel.Application.Cells(Recorrido + 2, "B") = DataGridView.Rows(Recorrido).Cells(1).Value.ToString.Trim
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value.ToString.Trim
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Range("A" & Recorrido + 1, "D" & Recorrido + 3).Borders.LineStyle = 2
                Total = Total + Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(3).Value.ToString)
            Next
            Hoja.Range("A1").ColumnWidth = 8
            Hoja.Range("B1").ColumnWidth = 15
            Hoja.Range("C1").ColumnWidth = 68
            Hoja.Range("D1").ColumnWidth = 11
            Hoja.Range("A1", "D1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A1", "D1").Font.Bold = True
            Hoja.Range("A1", "D1").HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("A2", "A" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlRight
            Hoja.Range("D2", "D" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "Resumen Caja Chica"
            Hoja.Range("A" & Recorrido + 2, "D" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "C" & Recorrido + 2).MergeCells = True
            Excel.Application.Cells(Recorrido + 2, "A") = "Total"
            Excel.Application.Cells(Recorrido + 2, "D") = Total
            Hoja.Range("A" & Recorrido + 2, "A" & Recorrido + 2).Font.Bold = True
            Hoja.Range("D" & Recorrido + 2, "D" & Recorrido + 2).Font.Bold = True
        End If
    End Sub
    Public Sub Exportar_Caja_Chica_Detalle(ByVal Query As String)
        Dim Da As New OleDb.OleDbDataAdapter(Query, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Item"
            Excel.Application.Cells(1, "B") = "Fecha"
            Excel.Application.Cells(1, "C") = "Tipo"
            Excel.Application.Cells(1, "D") = "Serie"
            Excel.Application.Cells(1, "E") = "Número"
            Excel.Application.Cells(1, "F") = "Proveedor"
            Excel.Application.Cells(1, "G") = "Descripción Gasto"
            Excel.Application.Cells(1, "H") = "Importe"
            Excel.Application.Cells(1, "I") = "Clasificador"
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Excel.Application.Cells(Recorrido + 2, "A") = Recorrido + 1
                Excel.Application.Cells(Recorrido + 2, "B") = DateValue(Ds.Tables(0).Rows(Recorrido).Item("FechaEmision").ToString)
                Excel.Application.Cells(Recorrido + 2, "C") = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura_Comprobante").ToString
                Excel.Application.Cells(Recorrido + 2, "D") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Serie_Comprobante").ToString
                Excel.Application.Cells(Recorrido + 2, "E") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero_Comprobante").ToString
                Excel.Application.Cells(Recorrido + 2, "F") = Ds.Tables(0).Rows(Recorrido).Item("Razon_Social_Comprobante").ToString
                Excel.Application.Cells(Recorrido + 2, "G") = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Denominacion").ToString.Trim
                Excel.Application.Cells(Recorrido + 2, "H") = Ds.Tables(0).Rows(Recorrido).Item("Monto_Comprobante").ToString
                Excel.Application.Cells(Recorrido + 2, "I") = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                Excel.Application.Range("A" & Recorrido + 1, "I" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 6
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 20
            Hoja.Range("D1").ColumnWidth = 9
            Hoja.Range("E1").ColumnWidth = 9
            Hoja.Range("F1").ColumnWidth = 42
            Hoja.Range("G1").ColumnWidth = 42
            Hoja.Range("H1").ColumnWidth = 8.5
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("A1", "I1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A1", "I1").Font.Bold = True
            Hoja.Range("A1", "I" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("F2", "G" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A1", "I1").HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("H2", "H" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlRight
            Hoja.Range("H2", "H" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "Reporte Caja Chica"
            Hoja.Range("A" & Recorrido + 2, "I" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "I" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Exportar_Grilla_Compromisos_X_Devengar(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Total As Double = 0
            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = DataGridView.Columns(0).HeaderText.ToString
            Excel.Application.Cells(1, "B") = DataGridView.Columns(1).HeaderText.ToString
            Excel.Application.Cells(1, "C") = DataGridView.Columns(2).HeaderText.ToString
            Excel.Application.Cells(1, "D") = DataGridView.Columns(3).HeaderText.ToString
            Excel.Application.Cells(1, "E") = DataGridView.Columns(4).HeaderText.ToString
            Excel.Application.Cells(1, "F") = DataGridView.Columns(5).HeaderText.ToString
            Excel.Application.Cells(1, "G") = DataGridView.Columns(6).HeaderText.ToString
            Excel.Application.Cells(1, "H") = DataGridView.Columns(7).HeaderText.ToString
            Excel.Application.Cells(1, "I") = DataGridView.Columns(8).HeaderText.ToString
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value.Trim
                Excel.Application.Cells(Recorrido + 2, "B") = "'" & DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = "'" & DataGridView.Rows(Recorrido).Cells(2).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "F") = "'" & DataGridView.Rows(Recorrido).Cells(5).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "G") = "'" & DataGridView.Rows(Recorrido).Cells(6).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value.ToString
                Excel.Application.Range("A" & Recorrido + 1, "I" & Recorrido + 3).Borders.LineStyle = 2
                Total = Total + Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(8).Value.ToString)
            Next
            Hoja.Range("A1").ColumnWidth = 8
            Hoja.Range("B1").ColumnWidth = 8
            Hoja.Range("C1").ColumnWidth = 12
            Hoja.Range("D1").ColumnWidth = 15
            Hoja.Range("E1").ColumnWidth = 56
            Hoja.Range("F1").ColumnWidth = 9
            Hoja.Range("G1").ColumnWidth = 9
            Hoja.Range("H1").ColumnWidth = 14
            Hoja.Range("I1").ColumnWidth = 14
            Hoja.Range("A1", "I1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A1", "I1").Font.Bold = True
            Hoja.Range("A1", "I1").HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("B2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("A2", "A" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("F2", "G" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("H2", "H" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlRight
            Hoja.Range("H2", "I" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "Resumen Compromisos x Devengar"
            Hoja.Range("A" & Recorrido + 2, "I" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "H" & Recorrido + 2).MergeCells = True
            Excel.Application.Cells(Recorrido + 2, "A") = "Total"
            Excel.Application.Cells(Recorrido + 2, "I") = Total
            Hoja.Range("A" & Recorrido + 2, "A" & Recorrido + 2).Font.Bold = True
            Hoja.Range("I" & Recorrido + 2, "I" & Recorrido + 2).Font.Bold = True
        End If
    End Sub
    Public Sub Exportar_Grilla_Devengados_X_Girar(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet
            Dim Recorrido As Integer = 0
            Dim Total As Double = 0
            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = DataGridView.Columns(0).HeaderText.ToString
            Excel.Application.Cells(1, "B") = DataGridView.Columns(1).HeaderText.ToString
            Excel.Application.Cells(1, "C") = DataGridView.Columns(2).HeaderText.ToString
            Excel.Application.Cells(1, "D") = DataGridView.Columns(3).HeaderText.ToString
            Excel.Application.Cells(1, "E") = DataGridView.Columns(4).HeaderText.ToString
            Excel.Application.Cells(1, "F") = DataGridView.Columns(5).HeaderText.ToString
            Excel.Application.Cells(1, "G") = DataGridView.Columns(6).HeaderText.ToString
            Excel.Application.Cells(1, "H") = DataGridView.Columns(7).HeaderText.ToString
            Excel.Application.Cells(1, "I") = DataGridView.Columns(8).HeaderText.ToString
            For Recorrido = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value.Trim
                Excel.Application.Cells(Recorrido + 2, "B") = "'" & DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = "'" & DataGridView.Rows(Recorrido).Cells(2).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "F") = "'" & DataGridView.Rows(Recorrido).Cells(5).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "G") = "'" & DataGridView.Rows(Recorrido).Cells(6).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value.ToString
                Excel.Application.Range("A" & Recorrido + 1, "I" & Recorrido + 3).Borders.LineStyle = 2
                Total = Total + Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(8).Value.ToString)
            Next
            Hoja.Range("A1").ColumnWidth = 8
            Hoja.Range("B1").ColumnWidth = 8
            Hoja.Range("C1").ColumnWidth = 12
            Hoja.Range("D1").ColumnWidth = 15
            Hoja.Range("E1").ColumnWidth = 56
            Hoja.Range("F1").ColumnWidth = 9
            Hoja.Range("G1").ColumnWidth = 9
            Hoja.Range("H1").ColumnWidth = 14
            Hoja.Range("I1").ColumnWidth = 14
            Hoja.Range("A1", "I1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A1", "I1").Font.Bold = True
            Hoja.Range("A1", "I1").HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("B2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("A2", "A" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("F2", "G" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("H2", "H" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlRight
            Hoja.Range("H2", "I" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "Resumen Devengados x Girar"
            Hoja.Range("A" & Recorrido + 2, "I" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "H" & Recorrido + 2).MergeCells = True
            Excel.Application.Cells(Recorrido + 2, "A") = "Total"
            Excel.Application.Cells(Recorrido + 2, "I") = Total
            Hoja.Range("A" & Recorrido + 2, "A" & Recorrido + 2).Font.Bold = True
            Hoja.Range("I" & Recorrido + 2, "I" & Recorrido + 2).Font.Bold = True
        End If
    End Sub
    Public Sub Exportar_Grilla_Girados_X_Pagar(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Total As Double = 0
            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = DataGridView.Columns(0).HeaderText.ToString
            Excel.Application.Cells(1, "B") = DataGridView.Columns(1).HeaderText.ToString
            Excel.Application.Cells(1, "C") = DataGridView.Columns(2).HeaderText.ToString
            Excel.Application.Cells(1, "D") = DataGridView.Columns(3).HeaderText.ToString
            Excel.Application.Cells(1, "E") = DataGridView.Columns(4).HeaderText.ToString
            Excel.Application.Cells(1, "F") = DataGridView.Columns(5).HeaderText.ToString
            Excel.Application.Cells(1, "G") = DataGridView.Columns(6).HeaderText.ToString
            Excel.Application.Cells(1, "H") = DataGridView.Columns(7).HeaderText.ToString
            Excel.Application.Cells(1, "I") = DataGridView.Columns(8).HeaderText.ToString
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value.Trim
                Excel.Application.Cells(Recorrido + 2, "B") = "'" & DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = "'" & DataGridView.Rows(Recorrido).Cells(2).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "E") = DataGridView.Rows(Recorrido).Cells(4).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "F") = "'" & DataGridView.Rows(Recorrido).Cells(5).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "G") = "'" & DataGridView.Rows(Recorrido).Cells(6).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(7).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(8).Value.ToString
                Excel.Application.Range("A" & Recorrido + 1, "I" & Recorrido + 3).Borders.LineStyle = 2
                Total = Total + Convert.ToDouble(DataGridView.Rows(Recorrido).Cells(8).Value.ToString)
            Next
            Hoja.Range("A1").ColumnWidth = 8
            Hoja.Range("B1").ColumnWidth = 8
            Hoja.Range("C1").ColumnWidth = 12
            Hoja.Range("D1").ColumnWidth = 15
            Hoja.Range("E1").ColumnWidth = 56
            Hoja.Range("F1").ColumnWidth = 9
            Hoja.Range("G1").ColumnWidth = 9
            Hoja.Range("H1").ColumnWidth = 14
            Hoja.Range("I1").ColumnWidth = 14
            Hoja.Range("A1", "I1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("A1", "I1").Font.Bold = True
            Hoja.Range("A1", "I1").HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("B2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("A2", "A" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("F2", "G" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("H2", "H" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlRight
            Hoja.Range("H2", "I" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "Resumen Girados x Pagar"
            Hoja.Range("A" & Recorrido + 2, "I" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "H" & Recorrido + 2).MergeCells = True
            Excel.Application.Cells(Recorrido + 2, "A") = "Total"
            Excel.Application.Cells(Recorrido + 2, "I") = Total
            Hoja.Range("A" & Recorrido + 2, "A" & Recorrido + 2).Font.Bold = True
            Hoja.Range("I" & Recorrido + 2, "I" & Recorrido + 2).Font.Bold = True
        End If
    End Sub
    Public Sub Detallar_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Documento_Rendicion As String, ByVal Fecha_Rendicion As Date, ByVal Importe_Rendido As Double, ByVal Importe_Devuelto As Double, ByVal Numero_Recibo As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Detallar_Encargo_Interno"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Documento_Rendicion", Documento_Rendicion)
        Cm.Parameters.AddWithValue("@Fecha_Rendicion", Fecha_Rendicion)
        Cm.Parameters.AddWithValue("@Importe_Rendido", Importe_Rendido)
        Cm.Parameters.AddWithValue("@Importe_Devuelto", Importe_Devuelto)
        Cm.Parameters.AddWithValue("@Numero_Recibo", Numero_Recibo)
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Encargo_Interno Set Detallado=1 where año_ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Nuevo_Detalle_Encargo_Interno_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Comprobante As String, ByVal Serie_Comprobante As String, ByVal Numero_Comprobante As String, ByVal FechaEmision As Date, ByVal Codigo_Proveedor As String, ByVal Monto As Double, ByVal Valor_Venta As Double, ByVal IGV As Double, ByVal Renta As Double, ByVal Porcentaje_IGV As Double, ByVal Porcentaje_Renta As Double, ByVal Otros As Double, ByVal Check_IGV As Boolean, ByVal CheCk_Renta As Boolean, ByVal Notas As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Actividad As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Encargo_Interno_Rendicion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Comprobante", Codigo_Comprobante)
        Cm.Parameters.AddWithValue("@Serie_Comprobante", Serie_Comprobante)
        Cm.Parameters.AddWithValue("@Numero_Comprobante", Numero_Comprobante)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Valor_Venta", Valor_Venta)
        Cm.Parameters.AddWithValue("@IGV", IGV)
        Cm.Parameters.AddWithValue("@Renta", Renta)
        Cm.Parameters.AddWithValue("@Porcentaje_IGV", Porcentaje_IGV)
        Cm.Parameters.AddWithValue("@Porcentaje_Renta", Porcentaje_Renta)
        Cm.Parameters.AddWithValue("@Otros", Otros)
        Cm.Parameters.AddWithValue("@Check_IGV", Check_IGV)
        Cm.Parameters.AddWithValue("@CheCk_Renta", CheCk_Renta)
        Cm.Parameters.AddWithValue("@Notas", Notas)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Liberar_Detalle_Encargo_Interno_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Encargo_Interno_Rendicion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Cambiar_Estado_Rendicion_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Estado As Boolean)
        Select Case Estado
            Case True
                Dim Cm As New OleDb.OleDbCommand
                Cm.Connection = Cn
                Cm.CommandTimeout = 0
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Encargo_Interno Set Rendido=1 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case False
                Dim Cm As New OleDb.OleDbCommand
                Cm.Connection = Cn
                Cm.CommandTimeout = 0
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Encargo_Interno Set Rendido=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Extornar_Detalle_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Extornar_Detalle_Encargo_Interno"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.Connection = Cn
        Cm.CommandTimeout = 0
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Encargo_Interno Set Detallado=0 where año_ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Mostrar_Data_Caja_Chica_X_Unidad(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Caja_Monto As System.Windows.Forms.TextBox, ByVal Caja_Resolucion As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Unidad_Organica Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Monto.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto_Caja").ToString), "#,###,##0.00")
            Caja_Resolucion.Text = Ds.Tables(0).Rows(0).Item("Resolucion_Caja").ToString
            Variable_Codigo_Proveedor = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor_01").ToString
        End If
    End Sub
    Public Function Datos_Caja_Chica_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String) As DataRow
        Dim Da As New OleDb.OleDbDataAdapter("select * from Lista_Caja_Chica_SBLM_Basica Where Codigo_Tipo_Caja ='01' And Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Fila As DataRow = Nothing
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Fila = Ds.Tables(0).Rows(0)
        End If
        Return Fila
    End Function
    Public Function Datos_Encargo_Interno_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String) As DataRow
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Encargo_Interno_Basica Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Fila As DataRow = Nothing
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Fila = Ds.Tables(0).Rows(0)
        End If
        Return Fila
    End Function
    Public Function Datos_Presupuestales_Encargo_Interno(ByVal Año_Ejecucion As String, ByVal Numero As String) As DataRow
        Dim Da As New OleDb.OleDbDataAdapter("Select * from Lista_Encargo_Interno_Basica_Detallada_Presupuestal Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Dim Fila As DataRow = Nothing
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Fila = Ds.Tables(0).Rows(0)
        End If
        Return Fila
    End Function
    Public Sub Cargar_Certificado_Rendiciones(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Total As System.Windows.Forms.TextBox, ByVal Caja_Saldo As System.Windows.Forms.TextBox)
        Dim Da As New OleDb.OleDbDataAdapter("select Año_Ejecucion,Numero,(Convert(VarCHar(1),Codigo_FF) + '-' + Codigo_Rubro) As Rubro,Descripcion_Tipo_Recurso as TR,Meta,Codigo_Secuencia_Funcional As [Sec.Fun.],Clasificador,Descripcion_Especifica_Detalle As Descripcion,Monto,Saldo,Total,Codigo_Tipo_Recurso From Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Total.Text = Format(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Total").ToString), "###,###,#.00")

            DataGridView.Rows.Clear()
            Dim Saldo As Double = 0
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("TR").ToString
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Meta").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Sec.Fun.").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString), "###,###,#.00")
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString), "###,###,#.00")
                Saldo = Saldo + Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString)
            Next
            Caja_Saldo.Text = Format(Saldo, "###,###,#.00")
        End If
    End Sub
    Public Sub Llenar_Detalle_Presupuestal_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As String, ByVal Codigo_Tipo_Documento As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Select Case Codigo_Tipo_Documento
            Case "22"



            Case "34"
                Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Codigo_Unidad_Organica,Codigo_Secuencia_Funcional,Codigo_Actividad,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Abreviatura,Rubro,Clasificador,Sum(Monto) As Monto From Lista_Items_Presupuestales_Encargo_Interno Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Codigo_Unidad_Organica,Codigo_Secuencia_Funcional,Codigo_Actividad,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Abreviatura,Rubro,Clasificador", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then

                    For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                        DataGridView.Rows.Add()
                        DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                        DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Rubro").ToString
                        DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Tipo_Recurso").ToString
                        DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional").ToString
                        DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                        DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad").ToString
                        DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Clasificador").ToString
                        DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Descripcion_Especifica_Detalle").ToString
                        DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                    Next
                Else
                    Exit Sub
                End If
        End Select
    End Sub
    Public Function Generar_Numero_Rendicion(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Numero)+1),1) As Numero From Rendicion Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Rendicion = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Rendicion
    End Function
    Public Sub Nueva_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String, ByVal Justificacion As String, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Rendicion As String, ByVal Monto As Double, ByVal Certificado As String, ByVal Expediente As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Moneda As String, ByVal Tipo_Cambio As Double, ByVal Documento_Rendicion As String, ByVal Numero_Rendicion As Integer)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Rendicion"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Documento", Codigo_Tipo_Documento)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Justificacion", Justificacion)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Rendicion", Codigo_Estado_Rendicion)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Expediente", Expediente)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Documento_Rendicion", Documento_Rendicion)
        Cm.Parameters.AddWithValue("@Numero_Rendicion", Numero_Rendicion)
        Cm.ExecuteNonQuery()
    End Sub

    Public Sub Ejecutar_Detalle_Rendicion_Encargo(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Rendicion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Codigo_Unidad_Organica,Codigo_Secuencia_Funcional,Codigo_Actividad,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Abreviatura,Rubro,Clasificador,Sum(Monto) As Monto From Lista_Items_Presupuestales_Encargo_Interno Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Codigo_Unidad_Organica,Codigo_Secuencia_Funcional,Codigo_Actividad,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Abreviatura,Rubro,Clasificador", Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nuevo_Detalle_Rendicion"
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
                Cm.Parameters.AddWithValue("@Numero", Numero_Rendicion)
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
                Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                Cm.Parameters.AddWithValue("@Monto", Ds.Tables(0).Rows(Recorrido).Item("Monto"))
                Cm.ExecuteNonQuery()
            Next
        End If
    End Sub
    Public Sub Ejecutar_Detalle_Rendicion_Encargo_Movimientos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Rendicion As String)
        Dim Da As New OleDb.OleDbDataAdapter("Select Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Codigo_Unidad_Organica,Codigo_Secuencia_Funcional,Codigo_Actividad,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Abreviatura,Rubro,Clasificador,Sum(Monto) As Monto From Lista_Items_Presupuestales_Encargo_Interno Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' Group By Año_Ejecucion,Numero,Codigo_FF,Codigo_Rubro,Codigo_Tipo_Recurso,Codigo_Unidad_Organica,Codigo_Secuencia_Funcional,Codigo_Actividad,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Descripcion_Especifica_Detalle,Descripcion_Tipo_Recurso,Abreviatura,Rubro,Clasificador", Cn)
        Dim Ds As New Data.DataSet

        Da.Fill(Ds)
        Dim Correlativo As String = Me.Generar_Numero_Correlativo_Rendicion(Año_Ejecucion, Numero_Rendicion)
        If Ds.Tables(0).Rows.Count > 0 Then
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.StoredProcedure
                Cm.CommandText = "Nuevo_Detalle_Rendicion_Movimientos"
                Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
                Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", "58")
                Cm.Parameters.AddWithValue("@Año_Ejecucion", Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion"))
                Cm.Parameters.AddWithValue("@Numero", Numero_Rendicion)
                Cm.Parameters.AddWithValue("@Codigo_FF", Ds.Tables(0).Rows(Recorrido).Item("Codigo_FF"))
                Cm.Parameters.AddWithValue("@Codigo_Rubro", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"))
                Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Tipo_Recurso"))
                Cm.Parameters.AddWithValue("@Tipo_Transaccion", Ds.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"))
                Cm.Parameters.AddWithValue("@Generica", Ds.Tables(0).Rows(Recorrido).Item("Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica"))
                Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"))
                Cm.Parameters.AddWithValue("@Especifica", Ds.Tables(0).Rows(Recorrido).Item("Especifica"))
                Cm.Parameters.AddWithValue("@Especifica_Detalle", Ds.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"))
                Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"))
                Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"))
                Cm.Parameters.AddWithValue("@Codigo_Actividad", Ds.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                Cm.Parameters.AddWithValue("@Monto", Ds.Tables(0).Rows(Recorrido).Item("Monto"))
                Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Rendicion)
                Cm.Parameters.AddWithValue("@Codigo_Estado_Rendicion_Movimientos", "01")
                Cm.ExecuteNonQuery()
            Next
        End If
    End Sub
    Public Sub Nuevo_Detalle_Rendicion_Movimientos(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Numero_Documento As String, ByVal Codigo_Estado_Rendicion_Movimientos As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Rendicion_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Rendicion_Movimientos", Codigo_Estado_Rendicion_Movimientos)
        Cm.ExecuteNonQuery()
    End Sub
    Public Function Generar_Numero_Correlativo_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero_Rendicion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Correlativo)+1),1) As Numero From Detalle_Rendicion_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Rendicion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Numero_Correlativo_Rendicion = Right("0000" & Numero.ToString, 4)
        Return Generar_Numero_Correlativo_Rendicion
    End Function
    Public Sub Ejecutar_Reversion_por_Rendicion(ByVal Año_Ejecucion As String, ByVal Expediente As String, ByVal Codigo_Documento As String, ByVal Numero_Documento_Rendicion As String, ByVal Certificado As String, ByVal Numero_Documento As String)
        Select Case Codigo_Documento

            Case "22"


            Case "34"
                Dim Numero_Devengado As String = ""
                Dim Numero_Girado As String = ""
                Dim Numero_Compromiso As String = Numero_Documento
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Devengado Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Documento='34' And Numero_Documento='" & Numero_Documento & "' And Compromiso='" & Expediente & "'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Numero_Devengado = Ds.Tables(0).Rows(0).Item("Numero").ToString
                Ds = Nothing
                Da = Nothing
                Da = New OleDb.OleDbDataAdapter("Select * From Girado Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Documento='34' And Numero_Documento='" & Numero_Documento & "' And Compromiso='" & Expediente & "'", Cn)
                Ds = New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then Numero_Girado = Ds.Tables(0).Rows(0).Item("Numero").ToString
                Dim Correlativo_Girado As String = Me.Generar_Numero_Correlativo_Girado(Año_Ejecucion, Numero_Girado)
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Movimientos Set Monto=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Girado & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Girado_Cuenta_Patrimonial Set Monto=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Girado & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Movimientos Set Monto=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Devengado & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Cuenta_Patrimonial Set Monto=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Devengado & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Devengado_Cuenta_Presupuestal Set Monto=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Devengado & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Encargo_Interno_Movimientos Set Monto=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Compromiso & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Detalle_Certificado_Movimientos Set Monto=0 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero_Compromiso & "' And Numero='" & Certificado & "' And Codigo_Tipo_Operacion='52'"
                Cm.ExecuteNonQuery()

        End Select
    End Sub
    Public Sub Eliminar_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Operacion As Boolean)
        If Operacion = False Then
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Rendicion_Movimientos  Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Detalle_Rendicion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
            Cm = New OleDb.OleDbCommand
        Else
            Dim Cm As New OleDb.OleDbCommand
            Cm.CommandTimeout = 0
            Cm.Connection = Cn
            Cm.CommandType = CommandType.Text
            Cm.CommandText = "Delete From Rendicion Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
            Cm.ExecuteNonQuery()
            Cm = Nothing
        End If
    End Sub
    Public Sub Autorizar_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rendicion Set Codigo_Estado_Rendicion='02',FechaAutorizacion=GetDate(),UsuarioAutorizacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Rendicion_Movimientos Set Codigo_Estado_Rendicion_Movimientos='02' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='58'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Anular_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rendicion Set Codigo_Estado_Rendicion='04',FechaAnulacion=GetDate(),UsuarioAnulacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Rendicion_Movimientos Set Codigo_Estado_Rendicion_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='58'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Extornar_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rendicion Set Codigo_Estado_Rendicion='01',FechaAutorizacion=Null,FechaAprobacion=Null,UsuarioAprobacion=Null,UsuarioAutorizacion=Null Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Rendicion_Movimientos Set Codigo_Estado_Rendicion_Movimientos='04' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='58'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Aprobar_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Rendicion Set Codigo_Estado_Rendicion='03',FechaAprobacion=GetDate(),UsuarioAprobacion='" & Usuario & "' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Rendicion_Movimientos Set Codigo_Estado_Rendicion_Movimientos='03' Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Codigo_Tipo_Operacion='58'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Verficar_Aplicabilidad_Certificado_Rendicion(ByVal Año_Ejecucion As String, ByVal Numero As String) As Boolean
        Verficar_Aplicabilidad_Certificado_Rendicion = True
        If Verficar_Aplicabilidad_Certificado_Rendicion = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select Sum(Saldo) As Saldo From  Verificador_Certificado_Rendicion_Final where  año_ejecucion='" & Año_Ejecucion & "' and Certificado='" & Numero & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Dim Variable As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Saldo").ToString)
                If Variable = 0 Then
                    Verficar_Aplicabilidad_Certificado_Rendicion = True
                Else
                    Verficar_Aplicabilidad_Certificado_Rendicion = False
                End If
            Else
                Verficar_Aplicabilidad_Certificado_Rendicion = False
            End If
        End If
        Return Verficar_Aplicabilidad_Certificado_Rendicion
    End Function
    Public Sub Ejecutar_Certificado_Rendicion(ByVal Año_Ejecucion As String, ByVal Certificado As String, ByVal Rendicion As String, ByVal Codigo_Tipo_Documento As String, ByVal Numero_Documento As String)
        Select Case Codigo_Tipo_Documento
            Case "34"
                Dim Cm As New OleDb.OleDbCommand
                Dim Cadena As String = ""
                Dim Variable As String = ""
                Dim Correlativo As String = Me.Generar_Numero_Correlativo_Certificado(Año_Ejecucion, Certificado)
                Cadena = Cadena & "Insert Into Detalle_Certificado_Movimientos(Correlativo,"
                Cadena = Cadena & "Codigo_Tipo_Operacion,Año_Ejecucion,Numero,Codigo_FF,"
                Cadena = Cadena & "Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,"
                Cadena = Cadena & "Sub_Generica_Detalle,Especifica,Especifica_Detalle,"
                Cadena = Cadena & "Codigo_Unidad_Organica,Codigo_Secuencia_Funcional,Codigo_Actividad,"
                Cadena = Cadena & "Codigo_Tipo_Recurso,Monto,Numero_Documento,"
                Cadena = Cadena & "Codigo_Estado_Certificado_Movimientos) "
                Cadena = Cadena & "Select '" & Correlativo & "' As Correlativo,'58' As Codigo_Tipo_Operacion,"
                Cadena = Cadena & "Año_Ejecucion,'" & Microsoft.VisualBasic.Right("0000" & Certificado, 4) & "' As Numero,Codigo_FF,"
                Cadena = Cadena & "Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,"
                Cadena = Cadena & "Especifica,Especifica_Detalle,Codigo_Unidad_Organica,Codigo_Secuencia_Funcional,"
                Cadena = Cadena & "Codigo_Actividad,Codigo_Tipo_Recurso,Monto * -1,'" & Rendicion & "' As Numero_Documento,"
                Cadena = Cadena & "'03' As Codigo_Estado_Certificado_Movimientos  From Detalle_Rendicion_Movimientos "
                Cadena = Cadena & "Where Año_Ejecucion ='" & Año_Ejecucion & "' And Numero ='" & Rendicion & "'"
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = Cadena
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Rendicion Set Certificacion=1 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Rendicion & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Encargo_Interno Set Rendido=1 Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero_Documento & "'"
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select

    End Sub
    Public Sub Crear_Asiento_Cuenta_Comprobante_Emision(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DONOCO As String)
        Select Case DONOCO
            Case "050"
                Dim Da As New OleDb.OleDbDataAdapter("Select Sum(Monto) As Monto From [dbo].[Detalle_Girado_Cuenta_Patrimonial] where Año_Ejecucion ='" & Año_Ejecucion & "' and numero = '" & Numero & "' And Naturaleza ='H' And Mayor in ('1041','1061','1063','1073')", Cn)
                'Dim Da As New OleDb.OleDbDataAdapter("Select Sum(Monto) As Monto From [dbo].[Detalle_Girado_Cuenta_Patrimonial] where Año_Ejecucion ='" & Año_Ejecucion & "' and numero = '" & Numero & "' And Naturaleza ='H' And Mayor='1101'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.StoredProcedure
                    Cm.CommandText = "Nuevo_Detalle_Girado_Asiento_Contable_Comprobante"
                    Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
                    Cm.Parameters.AddWithValue("@Numero", Numero)
                    Cm.Parameters.AddWithValue("@DONOCO", "050")
                    Cm.Parameters.AddWithValue("@Mayor", "0103")
                    Cm.Parameters.AddWithValue("@Sub_Cuenta", "0901")
                    'Cm.Parameters.AddWithValue("@Mayor", "9103")
                    'Cm.Parameters.AddWithValue("@Sub_Cuenta", "990000.01")
                    Cm.Parameters.AddWithValue("@Naturaleza", "D")
                    Cm.Parameters.AddWithValue("@Monto", Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString))
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.StoredProcedure
                    Cm.CommandText = "Nuevo_Detalle_Girado_Asiento_Contable_Comprobante"
                    Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
                    Cm.Parameters.AddWithValue("@Numero", Numero)
                    Cm.Parameters.AddWithValue("@DONOCO", "050")
                    Cm.Parameters.AddWithValue("@Mayor", "0104")
                    Cm.Parameters.AddWithValue("@Sub_Cuenta", "0901")
                    'Cm.Parameters.AddWithValue("@Mayor", "9104")
                    'Cm.Parameters.AddWithValue("@Sub_Cuenta", "990000.01")
                    Cm.Parameters.AddWithValue("@Naturaleza", "H")
                    Cm.Parameters.AddWithValue("@Monto", Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString))
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If

            Case "051"
                Dim Da As New OleDb.OleDbDataAdapter("Select Sum(Monto) As Monto From [dbo].[Detalle_Girado_Cuenta_Patrimonial] where Año_Ejecucion ='" & Año_Ejecucion & "' and numero = '" & Numero & "' And Naturaleza ='H' And Mayor in ('1041','1061','1063','1073')", Cn)
                'Dim Da As New OleDb.OleDbDataAdapter("Select Sum(Monto) As Monto From [dbo].[Detalle_Girado_Cuenta_Patrimonial] where Año_Ejecucion ='" & Año_Ejecucion & "' and numero = '" & Numero & "' And Naturaleza ='H' And Mayor='1101'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.StoredProcedure
                    Cm.CommandText = "Nuevo_Detalle_Girado_Asiento_Contable_Comprobante"
                    Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
                    Cm.Parameters.AddWithValue("@Numero", Numero)
                    Cm.Parameters.AddWithValue("@DONOCO", "051")
                    Cm.Parameters.AddWithValue("@Mayor", "0104")
                    Cm.Parameters.AddWithValue("@Sub_Cuenta", "0901")
                    'Cm.Parameters.AddWithValue("@Mayor", "9104")
                    'Cm.Parameters.AddWithValue("@Sub_Cuenta", "990000.01")
                    Cm.Parameters.AddWithValue("@Naturaleza", "D")
                    Cm.Parameters.AddWithValue("@Monto", Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString))
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.StoredProcedure
                    Cm.CommandText = "Nuevo_Detalle_Girado_Asiento_Contable_Comprobante"
                    Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
                    Cm.Parameters.AddWithValue("@Numero", Numero)
                    Cm.Parameters.AddWithValue("@DONOCO", "051")
                    Cm.Parameters.AddWithValue("@Mayor", "0103")
                    Cm.Parameters.AddWithValue("@Sub_Cuenta", "0901")
                    'Cm.Parameters.AddWithValue("@Mayor", "9103")
                    'Cm.Parameters.AddWithValue("@Sub_Cuenta", "990000.01")
                    Cm.Parameters.AddWithValue("@Naturaleza", "H")
                    Cm.Parameters.AddWithValue("@Monto", Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString))
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
            Case "052"
                Dim Da As New OleDb.OleDbDataAdapter("Select Sum(Monto) As Monto From [dbo].[Detalle_Girado_Cuenta_Patrimonial] where Año_Ejecucion ='" & Año_Ejecucion & "' and numero = '" & Numero & "' And Naturaleza ='H' And Mayor in ('1041','1061','1063','1073')", Cn)
                'Dim Da As New OleDb.OleDbDataAdapter("Select Sum(Monto) As Monto From [dbo].[Detalle_Girado_Cuenta_Patrimonial] where Año_Ejecucion ='" & Año_Ejecucion & "' and numero = '" & Numero & "' And Naturaleza ='H' And Mayor='1101'", Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Dim Cm As New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.StoredProcedure
                    Cm.CommandText = "Nuevo_Detalle_Girado_Asiento_Contable_Comprobante"
                    Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
                    Cm.Parameters.AddWithValue("@Numero", Numero)
                    Cm.Parameters.AddWithValue("@DONOCO", "052")
                    Cm.Parameters.AddWithValue("@Mayor", "0104")
                    Cm.Parameters.AddWithValue("@Sub_Cuenta", "0901")
                    'Cm.Parameters.AddWithValue("@Mayor", "9104")
                    'Cm.Parameters.AddWithValue("@Sub_Cuenta", "990000.01")
                    Cm.Parameters.AddWithValue("@Naturaleza", "D")
                    Cm.Parameters.AddWithValue("@Monto", Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString))
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                    Cm = New OleDb.OleDbCommand
                    Cm.CommandTimeout = 0
                    Cm.Connection = Cn
                    Cm.CommandType = CommandType.StoredProcedure
                    Cm.CommandText = "Nuevo_Detalle_Girado_Asiento_Contable_Comprobante"
                    Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
                    Cm.Parameters.AddWithValue("@Numero", Numero)
                    Cm.Parameters.AddWithValue("@DONOCO", "052")
                    Cm.Parameters.AddWithValue("@Mayor", "0103")
                    Cm.Parameters.AddWithValue("@Sub_Cuenta", "0901")
                    'Cm.Parameters.AddWithValue("@Mayor", "9103")
                    'Cm.Parameters.AddWithValue("@Sub_Cuenta", "990000.01")
                    Cm.Parameters.AddWithValue("@Naturaleza", "H")
                    Cm.Parameters.AddWithValue("@Monto", Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Monto").ToString))
                    Cm.ExecuteNonQuery()
                    Cm = Nothing
                End If
        End Select
    End Sub
    Public Sub Generar_Cadenas(ByVal Año_Ejecucion As String, ByVal Año_Ejecucion_Referencial As String, ByVal Nivel As Integer)
        Select Case Nivel
            Case 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Tipo_Programa Select '" & Año_Ejecucion & "' As Año_Ejecucion,Codigo_Tipo_Programa,Nombre_Tipo_Programa From Tipo_Programa Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
                Cm = New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Programa Select '" & Año_Ejecucion & "' As Año_Ejecucion,Codigo_Programa,Nombre_Programa,Codigo_Tipo_Programa From Programa Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 2
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Funcion Select '" & Año_Ejecucion & "' As Año_Ejecucion,Codigo_Funcion,Nombre_Funcion From Funcion Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 3
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Actividad_Obra Select '" & Año_Ejecucion & "' As Año_Ejecucion,Codigo_Actividad_Obra,Nombre_Actividad_Obra From Actividad_Obra Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 4
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Division_Funcional Select '" & Año_Ejecucion & "' As Año_Ejecucion,Codigo_Division_Funcional,Nombre_Division_Funcional From Division_Funcional Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 5
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Grupo_Funcional Select '" & Año_Ejecucion & "' As Año_Ejecucion,Codigo_Grupo_Funcional,Nombre_Grupo_Funcional From Grupo_Funcional Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 6
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Finalidad Select '" & Año_Ejecucion & "' As Año_Ejecucion,Codigo_Finalidad,Nombre_Finalidad,Estado,Ambito,Es_Presupuestal From Finalidad Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 7
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Actividad_Proyecto Select '" & Año_Ejecucion & "' As Año_Ejecucion,Codigo_Actividad_Proyecto,Nombre_Actividad_Proyecto From Actividad_Proyecto Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Sub Generar_Clasificadores(ByVal Año_Ejecucion As String, ByVal Año_Ejecucion_Referencial As String, ByVal Nivel As Integer)
        Select Case Nivel
            Case 1
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Tipo_Transaccion Select '" & Año_Ejecucion & "' As Año_Ejecucion,Tipo_Transaccion,Descripcion From Tipo_Transaccion Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 2
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Generica Select '" & Año_Ejecucion & "' As Año_Ejecucion,Tipo_Transaccion,Generica,Descripcion_Generica,Id_Grupo_Clasificador,Ambito_Generica,Estado From Generica Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 3
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Sub_Generica Select '" & Año_Ejecucion & "' As Año_Ejecucion,Tipo_Transaccion,Generica,Sub_Generica,Descripcion_Sub_Generica,Ambito_Sub_Generica,Estado From Sub_Generica Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 4
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Sub_Generica_Detalle Select '" & Año_Ejecucion & "' As Año_Ejecucion,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Descripcion_Sub_Generica_Detalle,Categoria_Gasto,Tipo_Actividad_Proyecto,Tipo_Gasto,Ambito_Sub_Generica_Detalle,Estado,Categoria_Ingreso From Sub_Generica_Detalle Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 5
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Especifica Select '" & Año_Ejecucion & "' As Año_Ejecucion,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Descripcion_Especifica,Ambito_Especifica,Estado From Especifica Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
            Case 6
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Insert Into Especifica_Detalle Select '" & Año_Ejecucion & "' As Año_Ejecucion,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Id_Clasificador,Descripcion_Especifica_Detalle,Ambito_Especifica,Estado,Exclusivo_TP From Especifica_Detalle Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
                Cm.ExecuteNonQuery()
                Cm = Nothing
        End Select
    End Sub
    Public Function Verificar_Unidad_Organica(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String) As Integer
        Verificar_Unidad_Organica = 0
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Detalle_PIA Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Unidad_Organica = Verificar_Unidad_Organica + 1
        Else
            Verificar_Unidad_Organica = Verificar_Unidad_Organica + 0
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Detalle_Nota_Modificatoria Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Unidad_Organica = Verificar_Unidad_Organica + 1
        Else
            Verificar_Unidad_Organica = Verificar_Unidad_Organica + 0
        End If
        Ds = Nothing
        Da = Nothing
        Da = New OleDb.OleDbDataAdapter("Select * From Detalle_Certificado Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'", Cn)
        Ds = New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Verificar_Unidad_Organica = Verificar_Unidad_Organica + 1
        Else
            Verificar_Unidad_Organica = Verificar_Unidad_Organica + 0
        End If
        Return Verificar_Unidad_Organica
    End Function
    Public Sub Eliminar_Unidad_Organica(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Unidad_Organica Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Generar_Unidades_Organicas(ByVal Año_Ejecucion As String, ByVal Año_Ejecucion_Referencial As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Insert Into Unidad_Organica Select '" & Año_Ejecucion & "' As Año_Ejecucion,Codigo_Unidad_Organica,Nombre_Unidad_Organica,Abreviatura,Caja_Chica,Codigo_Partida,Resolucion_Caja,Monto_Caja,Codigo_Proveedor_01,Codigo_Proveedor_02,Correlativo_Cuenta From Unidad_Organica Where Abs(Año_Ejecucion)=" & Año_Ejecucion_Referencial & ""
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Cargar_Unidad_Organica(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String) As DataRow
        Cargar_Unidad_Organica = Nothing
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Unidad_Organica Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Return Ds.Tables(0).Rows(0)
        End If
    End Function
    Public Sub Nueva_Unidad_Organica_Basica(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Nombre_Unidad_Organica As String, ByVal Abreviatura As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Unidad_Organica_Basica"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Nombre_Unidad_Organica", Nombre_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Abreviatura", Abreviatura)
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Nueva_Unidad_Organica_Detallada(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Nombre_Unidad_Organica As String, ByVal Abreviatura As String, ByVal Caja_Chica As Boolean, ByVal Codigo_Partida As String, ByVal Resolucion_Caja As String, ByVal Monto_Caja As Double, ByVal Codigo_Proveedor_01 As String, ByVal Codigo_Proveedor_02 As String, ByVal Correlativo_Cuenta As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nueva_Unidad_Organica_Detallada"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Nombre_Unidad_Organica", Nombre_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Abreviatura", Abreviatura)
        Cm.Parameters.AddWithValue("@Caja_Chica", Caja_Chica)
        Cm.Parameters.AddWithValue("@Codigo_Partida", Codigo_Partida)
        Cm.Parameters.AddWithValue("@Resolucion_Caja", Resolucion_Caja)
        Cm.Parameters.AddWithValue("@Monto_Caja", Monto_Caja)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor_01", Codigo_Proveedor_01)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor_02", Codigo_Proveedor_02)
        Cm.Parameters.AddWithValue("@Correlativo_Cuenta", Correlativo_Cuenta)
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Modificar_Unidad_Organica_Basica(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Nombre_Unidad_Organica As String, ByVal Abreviatura As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Unidad_Organica_Basica"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Nombre_Unidad_Organica", Nombre_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Abreviatura", Abreviatura)
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Sub Modificar_Unidad_Organica_Detallada(ByVal Año_Ejecucion As String, ByVal Codigo_Unidad_Organica As String, ByVal Nombre_Unidad_Organica As String, ByVal Abreviatura As String, ByVal Caja_Chica As Boolean, ByVal Codigo_Partida As String, ByVal Resolucion_Caja As String, ByVal Monto_Caja As Double, ByVal Codigo_Proveedor_01 As String, ByVal Codigo_Proveedor_02 As String, ByVal Correlativo_Cuenta As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Unidad_Organica_Detallada"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Nombre_Unidad_Organica", Nombre_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Abreviatura", Abreviatura)
        Cm.Parameters.AddWithValue("@Caja_Chica", Caja_Chica)
        Cm.Parameters.AddWithValue("@Codigo_Partida", Codigo_Partida)
        Cm.Parameters.AddWithValue("@Resolucion_Caja", Resolucion_Caja)
        Cm.Parameters.AddWithValue("@Monto_Caja", Monto_Caja)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor_01", Codigo_Proveedor_01)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor_02", Codigo_Proveedor_02)
        Cm.Parameters.AddWithValue("@Correlativo_Cuenta", Correlativo_Cuenta)
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Sub
    Public Function Generar_Codigo_Unidad_Organica(ByVal Año_Ejecucion As String) As String
        Dim Da As New OleDb.OleDbDataAdapter("Select Isnull(Max(Abs(Codigo_Unidad_Organica)+1),1) As Numero From Unidad_Organica Where Año_Ejecucion='" & Año_Ejecucion & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        Dim Numero As Double = Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Numero").ToString)
        Generar_Codigo_Unidad_Organica = Right("00" & Numero.ToString, 2)
        Return Generar_Codigo_Unidad_Organica
    End Function
    Public Function Mensaje_Evaluacion_Orden_Compra_Autorizacion_Aprobacion(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Certificado As String, ByVal Tipo_Cambio As Double) As String
        Mensaje_Evaluacion_Orden_Compra_Autorizacion_Aprobacion = ""
        Dim DaTemporal As New OleDb.OleDbDataAdapter("Select Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad,  Sum(Costo*Cantidad) As Monto from Detalle_Orden_Compra_Movimientos Where Año_Ejecucion ='" & Año_Ejecucion & "' And Numero ='" & Numero & "' Group By Codigo_FF,Codigo_Rubro,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Secuencia_Funcional,Codigo_Unidad_Organica,Codigo_Actividad", Cn)
        Dim DsTemporal As New Data.DataSet
        DaTemporal.Fill(DsTemporal)
        If DsTemporal.Tables(0).Rows.Count > 0 Then

            For Recorrido As Integer = 0 To DsTemporal.Tables(0).Rows.Count - 1
                Dim DaCertificado As New OleDb.OleDbDataAdapter("Select Saldo from Lista_Detalle_Certificados_Basica_Reportar_Saldos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Certificado & "' And Codigo_FF='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF") & "' And Codigo_Rubro='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro") & "' And Tipo_Transaccion='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion") & "' And Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Generica") & "' And Sub_Generica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica") & "' And Sub_Generica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle") & "' And Especifica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica") & "' And Especifica_Detalle='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle") & "' And Codigo_Secuencia_Funcional='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional") & "' And Codigo_Unidad_Organica='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica") & "' And Codigo_Actividad='" & DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad") & "'", Cn)
                Dim DsCertificado As New Data.DataSet
                DaCertificado.Fill(DsCertificado)
                If DsCertificado.Tables(0).Rows.Count > 0 Then
                    Dim Saldo As Double = Convert.ToDouble(DsCertificado.Tables(0).Rows(0).Item("Saldo").ToString)
                    Dim Monto As Double = Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Monto").ToString) * Tipo_Cambio
                    If Monto <= Saldo Then
                        Mensaje_Evaluacion_Orden_Compra_Autorizacion_Aprobacion = Mensaje_Evaluacion_Orden_Compra_Autorizacion_Aprobacion & ""
                    Else
                        Mensaje_Evaluacion_Orden_Compra_Autorizacion_Aprobacion = Mensaje_Evaluacion_Orden_Compra_Autorizacion_Aprobacion & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Compra(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                    End If
                Else
                    Mensaje_Evaluacion_Orden_Compra_Autorizacion_Aprobacion = Mensaje_Evaluacion_Orden_Compra_Autorizacion_Aprobacion & vbNewLine & Me.Concatenar_Mensaje_Saldos_Detalle_Orden_Compra(Año_Ejecucion, Certificado, Convert.ToDouble(DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_FF")), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Rubro"), DsTemporal.Tables(0).Rows(Recorrido).Item("Tipo_Transaccion"), DsTemporal.Tables(0).Rows(Recorrido).Item("Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Sub_Generica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Especifica_Detalle"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Secuencia_Funcional"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Unidad_Organica"), DsTemporal.Tables(0).Rows(Recorrido).Item("Codigo_Actividad"))
                End If
            Next
        End If
        Return Mensaje_Evaluacion_Orden_Compra_Autorizacion_Aprobacion
    End Function
    Public Sub Cargar_Planilla_Para_Modificacion(ByVal Año_Ejecución As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView, ByVal Caja_Documento As System.Windows.Forms.TextBox, ByVal Caja_Justificacion As System.Windows.Forms.TextBox, ByVal Combo_Tipo As System.Windows.Forms.ComboBox, ByVal Combo_Mes As System.Windows.Forms.ComboBox)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Planillas_Basica_Detallada Where Año_Ejecucion='" & Año_Ejecución & "' And Numero='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Caja_Documento.Text = Ds.Tables(0).Rows(0).Item("Documento").ToString
            Caja_Justificacion.Text = Ds.Tables(0).Rows(0).Item("Notas").ToString
            Combo_Tipo.Text = Ds.Tables(0).Rows(0).Item("Descripcion_Tipo_Planilla").ToString
            Combo_Mes.Text = Ds.Tables(0).Rows(0).Item("Nombre_Mes").ToString()
            Variable_Numero_Certificacion = Ds.Tables(0).Rows(0).Item("Certificado").ToString
            Variable_Codigo_Proveedor = Ds.Tables(0).Rows(0).Item("Codigo_Proveedor").ToString
        End If
        Ds = Nothing
        Da = Nothing
    End Sub
    Public Function Comprobador_Folio_Caja_SBLM(ByVal Año_Ejecucion As String, ByVal Codigo_Tipo_Caja As String, ByVal Numero_Caja As String, ByVal Codigo_Unidad_Organica As String, ByVal Numero_Rendicion As Integer, ByVal Folio As Integer) As Boolean
        Comprobador_Folio_Caja_SBLM = True
        If Comprobador_Folio_Caja_SBLM = True Then
            If Folio = 0 Then
                Comprobador_Folio_Caja_SBLM = True
            Else
                Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Caja_Chica_SBLM_Basica_Detallada_Folios Where Año_Ejecucion='" & Año_Ejecucion & "' And Codigo_Tipo_Caja='" & Codigo_Tipo_Caja & "' And Numero='" & Numero_Caja & "' And Codigo_Unidad_Organica='" & Codigo_Unidad_Organica & "' And Numero_Rendicion=" & Numero_Rendicion & " And Folio=" & Folio, Cn)
                Dim Ds As New Data.DataSet
                Da.Fill(Ds)
                If Ds.Tables(0).Rows.Count > 0 Then
                    Comprobador_Folio_Caja_SBLM = False
                Else
                    Comprobador_Folio_Caja_SBLM = True
                End If
            End If
        End If
        Return Comprobador_Folio_Caja_SBLM
    End Function
    Public Function Asignar_Folio(ByVal Id As Integer, ByVal Folio As Integer) As Boolean
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Update Detalle_Caja_Chica_SBLM set Folio=" & Folio & " Where ID=" & Id
        Cm.ExecuteNonQuery()
        Cm = Nothing
    End Function
    Public Sub Exportar_Lista_Pagos_Varios(ByVal Consulta As String)
        Dim Da As New OleDb.OleDbDataAdapter(Consulta, Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "Denominacion"
            Excel.Application.Cells(1, "D") = "Documento"
            Excel.Application.Cells(1, "E") = "Emisión"
            Excel.Application.Cells(1, "F") = "Autorización"
            Excel.Application.Cells(1, "G") = "Aprobacion"
            Excel.Application.Cells(1, "H") = "Monto"
            Excel.Application.Cells(1, "I") = "Saldo"
            Excel.Application.Cells(1, "J") = "CCP"
            Excel.Application.Cells(1, "K") = "Exp."
            Excel.Application.Cells(1, "L") = "RUC/DNI"
            Excel.Application.Cells(1, "M") = "Proveedor"
            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                Excel.Application.Cells(Recorrido + 2, "A") = Ds.Tables(0).Rows(Recorrido).Item("Año").ToString
                Excel.Application.Cells(Recorrido + 2, "B") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                Excel.Application.Cells(Recorrido + 2, "C") = Ds.Tables(0).Rows(Recorrido).Item("Denominacion").ToString
                Excel.Application.Cells(Recorrido + 2, "D") = Ds.Tables(0).Rows(Recorrido).Item("Documento").ToString
                Excel.Application.Cells(Recorrido + 2, "E") = Ds.Tables(0).Rows(Recorrido).Item("Emisión").ToString
                Excel.Application.Cells(Recorrido + 2, "F") = Ds.Tables(0).Rows(Recorrido).Item("Autorización").ToString
                Excel.Application.Cells(Recorrido + 2, "G") = Ds.Tables(0).Rows(Recorrido).Item("Aprobación").ToString
                Excel.Application.Cells(Recorrido + 2, "H") = Ds.Tables(0).Rows(Recorrido).Item("Monto").ToString
                Excel.Application.Cells(Recorrido + 2, "I") = Ds.Tables(0).Rows(Recorrido).Item("Saldo").ToString
                Excel.Application.Cells(Recorrido + 2, "J") = "'" & Ds.Tables(0).Rows(Recorrido).Item("CCP").ToString
                Excel.Application.Cells(Recorrido + 2, "K") = "'" & Ds.Tables(0).Rows(Recorrido).Item("Exp.").ToString
                Excel.Application.Cells(Recorrido + 2, "L") = "'" & Ds.Tables(0).Rows(Recorrido).Item("RUC").ToString
                Excel.Application.Cells(Recorrido + 2, "M") = Ds.Tables(0).Rows(Recorrido).Item("Proveedor").ToString
                Excel.Application.Range("A" & Recorrido + 1, "M" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 8
            Hoja.Range("C1").ColumnWidth = 60
            Hoja.Range("D1").ColumnWidth = 60
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("J1").ColumnWidth = 5
            Hoja.Range("K1").ColumnWidth = 5.5
            Hoja.Range("L1").ColumnWidth = 13
            Hoja.Range("M1").ColumnWidth = 50
            Hoja.Range("A1", "M1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "L" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("J2", "J" & Recorrido + 2).WrapText = True
            Hoja.Range("H2", "H" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("I2", "I" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE PAGOS"
            Hoja.Range("A" & Recorrido + 2, "M" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "M" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Limpiar_Planilla(ByVal Año_Ejecucion As String, ByVal Numero As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Planilla Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Planilla_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "'"
        Cm.ExecuteNonQuery()
        Cm = Nothing
        Cm = New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Detalle_Certificado_Movimientos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero_Documento='" & Numero & "' And Codigo_Tipo_Operacion='32'"
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal FechaInicio As Date, ByVal FechaFin As Date, ByVal FechaEmision As Date, ByVal UsuarioEmision As String, ByVal Codigo_Estado_Contrato As String, ByVal Monto As Double, ByVal Certificado As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Moneda As String, ByVal Tipo_Cambio As Double, ByVal Codigo_Unidad_Organica As String, ByVal Letras As String, ByVal Suscripcion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Contrato"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@FechaInicio", FechaInicio)
        Cm.Parameters.AddWithValue("@FechaFin", FechaFin)
        Cm.Parameters.AddWithValue("@FechaEmision", FechaEmision)
        Cm.Parameters.AddWithValue("@UsuarioEmision", UsuarioEmision)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Contrato", Codigo_Estado_Contrato)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Letras", Letras)
        Cm.Parameters.AddWithValue("@Suscripcion", Suscripcion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Modificar_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal FechaInicio As Date, ByVal FechaFin As Date, ByVal Codigo_Estado_Contrato As String, ByVal Monto As Double, ByVal Certificado As String, ByVal Codigo_Proveedor As String, ByVal Codigo_Moneda As String, ByVal Tipo_Cambio As Double, ByVal Codigo_Unidad_Organica As String, ByVal Letras As String, ByVal Suscripcion As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Modificar_Contrato"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@FechaInicio", FechaInicio)
        Cm.Parameters.AddWithValue("@FechaFin", FechaFin)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Contrato", Codigo_Estado_Contrato)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Certificado", Certificado)
        Cm.Parameters.AddWithValue("@Codigo_Proveedor", Codigo_Proveedor)
        Cm.Parameters.AddWithValue("@Codigo_Moneda", Codigo_Moneda)
        Cm.Parameters.AddWithValue("@Tipo_Cambio", Tipo_Cambio)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Letras", Letras)
        Cm.Parameters.AddWithValue("@Suscripcion", Suscripcion)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Contrato"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Nuevo_Detalle_Contrato_Movimientos(ByVal Correlativo As String, ByVal Codigo_Tipo_Operacion As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Codigo_Tipo_Recurso As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Secuencia_Funcional As String, ByVal Codigo_Unidad_Organica As String, ByVal Codigo_Actividad As String, ByVal Monto As Double, ByVal Numero_Documento As String, ByVal Codigo_Estado_Contrato_Movimientos As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Detalle_Contrato_Movimientos"
        Cm.Parameters.AddWithValue("@Correlativo", Correlativo)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Operacion", Codigo_Tipo_Operacion)
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Codigo_FF", Codigo_FF)
        Cm.Parameters.AddWithValue("@Codigo_Rubro", Codigo_Rubro)
        Cm.Parameters.AddWithValue("@Codigo_Tipo_Recurso", Codigo_Tipo_Recurso)
        Cm.Parameters.AddWithValue("@Tipo_Transaccion", Tipo_Transaccion)
        Cm.Parameters.AddWithValue("@Generica", Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica", Sub_Generica)
        Cm.Parameters.AddWithValue("@Sub_Generica_Detalle", Sub_Generica_Detalle)
        Cm.Parameters.AddWithValue("@Especifica", Especifica)
        Cm.Parameters.AddWithValue("@Especifica_Detalle", Especifica_Detalle)
        Cm.Parameters.AddWithValue("@Codigo_Secuencia_Funcional", Codigo_Secuencia_Funcional)
        Cm.Parameters.AddWithValue("@Codigo_Unidad_Organica", Codigo_Unidad_Organica)
        Cm.Parameters.AddWithValue("@Codigo_Actividad", Codigo_Actividad)
        Cm.Parameters.AddWithValue("@Monto", Monto)
        Cm.Parameters.AddWithValue("@Numero_Documento", Numero_Documento)
        Cm.Parameters.AddWithValue("@Codigo_Estado_Contrato_Movimientos", Codigo_Estado_Contrato_Movimientos)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Exportar_Lista_Detalle_Caja_Chica_Contable(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Comprobante"
            Excel.Application.Cells(1, "B") = "Serie"
            Excel.Application.Cells(1, "C") = "Número"
            Excel.Application.Cells(1, "D") = "Emisión"
            Excel.Application.Cells(1, "E") = "RUC"
            Excel.Application.Cells(1, "F") = "Proveedor"
            Excel.Application.Cells(1, "G") = "Notas"
            Excel.Application.Cells(1, "H") = "V.V."
            Excel.Application.Cells(1, "I") = "I.G.V."
            Excel.Application.Cells(1, "J") = "Renta"
            Excel.Application.Cells(1, "K") = "Monto"
            Excel.Application.Cells(1, "L") = "R.B."
            Excel.Application.Cells(1, "M") = "Clasificador"
            Excel.Application.Cells(1, "N") = "Denominacion"
            Excel.Application.Cells(1, "O") = "Meta"
            Excel.Application.Cells(1, "P") = "C.Costos"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "B") = "'" & DataGridView.Rows(Recorrido).Cells(8).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = "'" & DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(10).Value
                Excel.Application.Cells(Recorrido + 2, "E") = "'" & DataGridView.Rows(Recorrido).Cells(12).Value
                Excel.Application.Cells(Recorrido + 2, "F") = DataGridView.Rows(Recorrido).Cells(13).Value
                Excel.Application.Cells(Recorrido + 2, "G") = DataGridView.Rows(Recorrido).Cells(14).Value
                Excel.Application.Cells(Recorrido + 2, "H") = DataGridView.Rows(Recorrido).Cells(15).Value
                Excel.Application.Cells(Recorrido + 2, "I") = DataGridView.Rows(Recorrido).Cells(16).Value
                Excel.Application.Cells(Recorrido + 2, "J") = DataGridView.Rows(Recorrido).Cells(17).Value
                Excel.Application.Cells(Recorrido + 2, "K") = DataGridView.Rows(Recorrido).Cells(21).Value
                Excel.Application.Cells(Recorrido + 2, "L") = "'" & DataGridView.Rows(Recorrido).Cells(30).Value
                Excel.Application.Cells(Recorrido + 2, "M") = DataGridView.Rows(Recorrido).Cells(37).Value
                Excel.Application.Cells(Recorrido + 2, "N") = DataGridView.Rows(Recorrido).Cells(44).Value
                Excel.Application.Cells(Recorrido + 2, "O") = "'" & DataGridView.Rows(Recorrido).Cells(38).Value
                Excel.Application.Cells(Recorrido + 2, "P") = DataGridView.Rows(Recorrido).Cells(42).Value
                Excel.Application.Range("A" & Recorrido + 1, "P" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 25
            Hoja.Range("B1").ColumnWidth = 6
            Hoja.Range("C1").ColumnWidth = 8
            Hoja.Range("D1").ColumnWidth = 10
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 45
            Hoja.Range("G1").ColumnWidth = 45
            Hoja.Range("H1").ColumnWidth = 8.7
            Hoja.Range("I1").ColumnWidth = 8.7
            Hoja.Range("J1").ColumnWidth = 8.7
            Hoja.Range("K1").ColumnWidth = 8.7
            Hoja.Range("L1").ColumnWidth = 5
            Hoja.Range("M1").ColumnWidth = 12
            Hoja.Range("N1").ColumnWidth = 45
            Hoja.Range("O1").ColumnWidth = 6
            Hoja.Range("P1").ColumnWidth = 10
            Hoja.Range("A1", "P1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("C2", "C" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "P" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("N2", "O" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("G2", "G" & Recorrido + 2).WrapText = True
            Hoja.Range("H2", "H" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("I2", "I" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("J2", "J" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("K2", "K" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE CAJA CHICA"
            Hoja.Range("A" & Recorrido + 2, "P" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "P" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Setear_Fechas_Contratos(ByVal Numero_Inicial As Integer, ByVal Numero_Final As Integer)
        Dim X As Integer = 0
        For X = Numero_Final To Numero_Final
            Dim Da As New OleDb.OleDbDataAdapter("Select day(FechaInicio) As Dia,Month(FechaInicio) as Mes, year(FechaInicio) as año From Contrato Where Abs(Numero)=" & X & " And Año_Ejecucion='2019'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Dim Cm As New OleDb.OleDbCommand
                Cm.CommandTimeout = 0
                Cm.Connection = Cn
                Cm.CommandType = CommandType.Text
                Cm.CommandText = "Update Contrato Set Suscripcion ='" & LCase(Me.Numero1Letra(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Dia").ToString)) & " días del mes de " & MonthName(Convert.ToDouble(Ds.Tables(0).Rows(0).Item("mes").ToString)) & " del año " & Convert.ToDouble(Ds.Tables(0).Rows(0).Item("Año").ToString) & "'")
                Cm.ExecuteNonQuery()
            End If
        Next
    End Sub
    Public Sub Exportar_Lista_Contratos(ByVal DataGridView As System.Windows.Forms.DataGridView)
        If DataGridView.RowCount > 0 Then
            Dim Excel As New Microsoft.Office.Interop.Excel.Application
            Dim Libro As Excel.Workbook
            Dim Hoja As Excel.Worksheet

            Dim Temporal As Object = System.Reflection.Missing.Value
            Excel = New Excel.ApplicationClass
            Libro = Excel.Workbooks.Add(Temporal)
            Hoja = Libro.Sheets(1)
            Hoja.Name = "Data"
            Excel.Application.Cells(1, "A") = "Año"
            Excel.Application.Cells(1, "B") = "Número"
            Excel.Application.Cells(1, "C") = "Unidad Orgánica"
            Excel.Application.Cells(1, "D") = "C.Costos"
            Excel.Application.Cells(1, "E") = "Emisión"
            Excel.Application.Cells(1, "F") = "Autorización"
            Excel.Application.Cells(1, "G") = "Aprobación"
            Excel.Application.Cells(1, "H") = "Inicio"
            Excel.Application.Cells(1, "I") = "Término"
            Excel.Application.Cells(1, "J") = "RUC"
            Excel.Application.Cells(1, "K") = "Proveedor"
            Excel.Application.Cells(1, "L") = "Monto"
            Excel.Application.Cells(1, "M") = "Saldo"
            Excel.Application.Cells(1, "N") = "Exp."
            Excel.Application.Cells(1, "O") = "CCP"
            Excel.Application.Cells(1, "P") = "Estado"
            For Recorrido As Integer = 0 To DataGridView.RowCount - 1
                Excel.Application.Cells(Recorrido + 2, "A") = DataGridView.Rows(Recorrido).Cells(0).Value
                Excel.Application.Cells(Recorrido + 2, "B") = "'" & DataGridView.Rows(Recorrido).Cells(1).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "C") = DataGridView.Rows(Recorrido).Cells(2).Value.ToString
                Excel.Application.Cells(Recorrido + 2, "D") = DataGridView.Rows(Recorrido).Cells(3).Value
                Excel.Application.Cells(Recorrido + 2, "E") = "'" & DataGridView.Rows(Recorrido).Cells(4).Value
                Excel.Application.Cells(Recorrido + 2, "F") = "'" & DataGridView.Rows(Recorrido).Cells(5).Value
                Excel.Application.Cells(Recorrido + 2, "G") = "'" & DataGridView.Rows(Recorrido).Cells(6).Value
                Excel.Application.Cells(Recorrido + 2, "H") = "'" & DataGridView.Rows(Recorrido).Cells(7).Value
                Excel.Application.Cells(Recorrido + 2, "I") = "'" & DataGridView.Rows(Recorrido).Cells(8).Value
                Excel.Application.Cells(Recorrido + 2, "J") = "'" & DataGridView.Rows(Recorrido).Cells(9).Value
                Excel.Application.Cells(Recorrido + 2, "K") = DataGridView.Rows(Recorrido).Cells(10).Value
                Excel.Application.Cells(Recorrido + 2, "L") = DataGridView.Rows(Recorrido).Cells(11).Value
                Excel.Application.Cells(Recorrido + 2, "M") = DataGridView.Rows(Recorrido).Cells(12).Value
                Excel.Application.Cells(Recorrido + 2, "N") = DataGridView.Rows(Recorrido).Cells(13).Value
                Excel.Application.Cells(Recorrido + 2, "O") = "'" & DataGridView.Rows(Recorrido).Cells(14).Value
                Excel.Application.Cells(Recorrido + 2, "P") = DataGridView.Rows(Recorrido).Cells(15).Value
                Excel.Application.Range("A" & Recorrido + 1, "P" & Recorrido + 3).Borders.LineStyle = 2
            Next
            Hoja.Range("A1").ColumnWidth = 5
            Hoja.Range("B1").ColumnWidth = 10
            Hoja.Range("C1").ColumnWidth = 20
            Hoja.Range("D1").ColumnWidth = 10
            Hoja.Range("E1").ColumnWidth = 12
            Hoja.Range("F1").ColumnWidth = 12
            Hoja.Range("G1").ColumnWidth = 12
            Hoja.Range("H1").ColumnWidth = 12
            Hoja.Range("I1").ColumnWidth = 12
            Hoja.Range("J1").ColumnWidth = 14
            Hoja.Range("K1").ColumnWidth = 30
            Hoja.Range("L1").ColumnWidth = 10
            Hoja.Range("M1").ColumnWidth = 10
            Hoja.Range("N1").ColumnWidth = 10
            Hoja.Range("O1").ColumnWidth = 8
            Hoja.Range("P1").ColumnWidth = 12
            Hoja.Range("A1", "P1").Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Hoja.Range("D2", "D" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("E2", "E" & Recorrido + 2).HorizontalAlignment = Microsoft.Office.Interop.Excel.Constants.xlJustify
            Hoja.Range("A2", "P" & Recorrido + 2).VerticalAlignment = Microsoft.Office.Interop.Excel.Constants.xlCenter
            Hoja.Range("C2", "C" & Recorrido + 2).WrapText = True
            Hoja.Range("K2", "K" & Recorrido + 2).WrapText = True
            Hoja.Range("I2", "L" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Hoja.Range("J2", "M" & Recorrido + 2).NumberFormat = "#,###,##0.00"
            Excel.Visible = True
            Excel.WindowState = Microsoft.Office.Interop.Excel.XlWindowState.xlMaximized
            Excel.Caption = "REPORTE CONTRATOS"
            Hoja.Range("A" & Recorrido + 2, "P" & Recorrido + 2).Rows.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
            Excel.Application.Range("A" & Recorrido + 2, "P" & Recorrido + 2).MergeCells = True
        End If
    End Sub
    Public Sub Nuevo_Contrato_Informes(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Informe As String, ByVal Fecha_Informe As Date, ByVal Codigo_Comprobante As String, ByVal Serie_Comprobante As String, ByVal Numero_Comprobante As String, ByVal Monto_Informe As Double, ByVal Mes As String, ByVal Observaciones As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "Nuevo_Contrato_Informes"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@Numero_Informe", Numero_Informe)
        Cm.Parameters.AddWithValue("@Fecha_Informe", Fecha_Informe)
        Cm.Parameters.AddWithValue("@Codigo_Comprobante", Codigo_Comprobante)
        Cm.Parameters.AddWithValue("@Serie_Comprobante", Serie_Comprobante)
        Cm.Parameters.AddWithValue("@Numero_Comprobante", Numero_Comprobante)
        Cm.Parameters.AddWithValue("@Monto_Informe", Monto_Informe)
        Cm.Parameters.AddWithValue("@Mes", Mes)
        Cm.Parameters.AddWithValue("@Observaciones", Observaciones)
        Cm.ExecuteNonQuery()
    End Sub
    Public Sub Cargar_Informes_Contratos(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal DataGridView As System.Windows.Forms.DataGridView)
        Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Informes_Contratos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero ='" & Numero & "'", Cn)
        Dim Ds As New Data.DataSet
        Da.Fill(Ds)
        If Ds.Tables(0).Rows.Count > 0 Then
            DataGridView.Rows.Clear()

            For Recorrido As Integer = 0 To Ds.Tables(0).Rows.Count - 1
                DataGridView.Rows.Add()
                DataGridView.Item(0, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Año_Ejecucion").ToString
                DataGridView.Item(1, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero").ToString
                DataGridView.Item(2, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Informe").ToString
                DataGridView.Item(3, DataGridView.Rows.Count - 1).Value = Format(Ds.Tables(0).Rows(Recorrido).Item("Fecha_Informe"), "dd/MM/yyyy")
                DataGridView.Item(4, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Codigo_Comprobante").ToString
                DataGridView.Item(5, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Abreviatura").ToString
                DataGridView.Item(6, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Serie_Comprobante").ToString
                DataGridView.Item(7, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Numero_Comprobante").ToString
                DataGridView.Item(8, DataGridView.Rows.Count - 1).Value = Format(Convert.ToDouble(Ds.Tables(0).Rows(Recorrido).Item("Monto_Informe").ToString), "###,###,#.00")
                DataGridView.Item(9, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Mes").ToString
                DataGridView.Item(10, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Nombre_Mes").ToString
                DataGridView.Item(11, DataGridView.Rows.Count - 1).Value = Ds.Tables(0).Rows(Recorrido).Item("Observaciones").ToString
            Next
        End If
    End Sub
    Public Function Determinar_Duplicidad_Informe_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Informe As String) As Boolean
        Determinar_Duplicidad_Informe_Contrato = True
        If Determinar_Duplicidad_Informe_Contrato = True Then
            Dim Da As New OleDb.OleDbDataAdapter("Select * From Lista_Informes_Contratos Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Numero_Informe='" & Numero_Informe & "'", Cn)
            Dim Ds As New Data.DataSet
            Da.Fill(Ds)
            If Ds.Tables(0).Rows.Count > 0 Then
                Determinar_Duplicidad_Informe_Contrato = False
            Else
                Determinar_Duplicidad_Informe_Contrato = True
            End If
        End If
        Return Determinar_Duplicidad_Informe_Contrato
    End Function
    Public Sub Eliminar_Informe_Contrato(ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Numero_Informe As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = "Delete From Contrato_Informes Where Año_Ejecucion='" & Año_Ejecucion & "' And Numero='" & Numero & "' And Numero_Informe='" & Numero_Informe & "'"
        Cm.ExecuteNonQuery()
        Cm.Dispose()
    End Sub
    Public Sub Nueva_Cuenta_Cuenta_Contable(ByVal Año_Ejecucion As String, ByVal Mayor As String, ByVal Sub_Cuenta As String, ByVal Nombre_Sub_Cuenta As String, ByVal Naturaleza As String, ByVal Codigo_FF As Integer, ByVal Codigo_Rubro As String, ByVal Tipo_Transaccion As String, ByVal Generica As String, ByVal Sub_Generica As String, ByVal Sub_Generica_Detalle As String, ByVal Especifica As String, ByVal Especifica_Detalle As String, ByVal Codigo_Unidad_Organica As String)
        Dim Cadena As String = ""
        If Codigo_FF > 0 Then
            If Codigo_Unidad_Organica.Trim.Length > 0 Then
                Cadena = Cadena & "Insert Into Plan_Sub_Cuenta(Año_Ejecucion,Mayor,Sub_Cuenta,Nombre_Sub_Cuenta,Naturaleza,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,	Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Unidad_Organica) Values("
                Cadena = Cadena & "'" & Año_Ejecucion & "',"
                Cadena = Cadena & "'" & Mayor & "',"
                Cadena = Cadena & "'" & Sub_Cuenta & "',"
                Cadena = Cadena & "'" & Nombre_Sub_Cuenta & "',"
                Cadena = Cadena & "'" & Naturaleza & "',"
                Cadena = Cadena & "'" & Codigo_FF & "',"
                Cadena = Cadena & "'" & Codigo_Rubro & "',"
                Cadena = Cadena & "'" & Tipo_Transaccion & "',"
                Cadena = Cadena & "'" & Generica & "',"
                Cadena = Cadena & "'" & Sub_Generica & "',"
                Cadena = Cadena & "'" & Sub_Generica_Detalle & "',"
                Cadena = Cadena & "'" & Especifica & "',"
                Cadena = Cadena & "'" & Especifica_Detalle & "',"
                Cadena = Cadena & "'" & Codigo_Unidad_Organica & "')"
            Else
                Cadena = Cadena & "Insert Into Plan_Sub_Cuenta(Año_Ejecucion,Mayor,Sub_Cuenta,Nombre_Sub_Cuenta,Naturaleza,Codigo_FF,Codigo_Rubro,Tipo_Transaccion,	Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle) Values("
                Cadena = Cadena & "'" & Año_Ejecucion & "',"
                Cadena = Cadena & "'" & Mayor & "',"
                Cadena = Cadena & "'" & Sub_Cuenta & "',"
                Cadena = Cadena & "'" & Nombre_Sub_Cuenta & "',"
                Cadena = Cadena & "'" & Naturaleza & "',"
                Cadena = Cadena & "'" & Codigo_FF & "',"
                Cadena = Cadena & "'" & Codigo_Rubro & "',"
                Cadena = Cadena & "'" & Tipo_Transaccion & "',"
                Cadena = Cadena & "'" & Generica & "',"
                Cadena = Cadena & "'" & Sub_Generica & "',"
                Cadena = Cadena & "'" & Sub_Generica_Detalle & "',"
                Cadena = Cadena & "'" & Especifica & "',"
                Cadena = Cadena & "'" & Especifica_Detalle & "')"
            End If
        Else
            If Codigo_Unidad_Organica.Trim.Length > 0 Then
                Cadena = Cadena & "Insert Into Plan_Sub_Cuenta(Año_Ejecucion,Mayor,Sub_Cuenta,Nombre_Sub_Cuenta,Naturaleza,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle,Codigo_Unidad_Organica) Values("
                Cadena = Cadena & "'" & Año_Ejecucion & "',"
                Cadena = Cadena & "'" & Mayor & "',"
                Cadena = Cadena & "'" & Sub_Cuenta & "',"
                Cadena = Cadena & "'" & Nombre_Sub_Cuenta & "',"
                Cadena = Cadena & "'" & Naturaleza & "',"
                Cadena = Cadena & "'" & Tipo_Transaccion & "',"
                Cadena = Cadena & "'" & Generica & "',"
                Cadena = Cadena & "'" & Sub_Generica & "',"
                Cadena = Cadena & "'" & Sub_Generica_Detalle & "',"
                Cadena = Cadena & "'" & Especifica & "',"
                Cadena = Cadena & "'" & Especifica_Detalle & "',"
                Cadena = Cadena & "'" & Codigo_Unidad_Organica & "')"
            Else
                Cadena = Cadena & "Insert Into Plan_Sub_Cuenta(Año_Ejecucion,Mayor,Sub_Cuenta,Nombre_Sub_Cuenta,Naturaleza,Tipo_Transaccion,Generica,Sub_Generica,Sub_Generica_Detalle,Especifica,Especifica_Detalle) Values("
                Cadena = Cadena & "'" & Año_Ejecucion & "',"
                Cadena = Cadena & "'" & Mayor & "',"
                Cadena = Cadena & "'" & Sub_Cuenta & "',"
                Cadena = Cadena & "'" & Nombre_Sub_Cuenta & "',"
                Cadena = Cadena & "'" & Naturaleza & "',"
                Cadena = Cadena & "'" & Tipo_Transaccion & "',"
                Cadena = Cadena & "'" & Generica & "',"
                Cadena = Cadena & "'" & Sub_Generica & "',"
                Cadena = Cadena & "'" & Sub_Generica_Detalle & "',"
                Cadena = Cadena & "'" & Especifica & "',"
                Cadena = Cadena & "'" & Especifica_Detalle & "')"
            End If
        End If
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.Text
        Cm.CommandText = Cadena
        Cm.ExecuteNonQuery()
        Cm.Dispose()
    End Sub

    Public Sub Modificar_Fecha_Devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String, ByVal Fecha_Emision As Date,
                                         ByVal Fecha_Autorizacion As DateTime, ByVal Fecha_Aprobacion As DateTime, ByVal Fecha_Emision_Comprobante As DateTime, ByVal pc_actualiza As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "usp_Actualiza_Fecha_Devengado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@usuario", Usuario)
        Cm.Parameters.AddWithValue("@tipo_documento_devengar", Codigo_Tipo_Documento_Devengar)
        Cm.Parameters.AddWithValue("@FechaEmision", Fecha_Emision)
        Cm.Parameters.AddWithValue("@FechaAutorizacion", Fecha_Autorizacion)
        Cm.Parameters.AddWithValue("@FechaAprobacion", Fecha_Aprobacion)
        Cm.Parameters.AddWithValue("@Fecha_Emision_Comprobante", Fecha_Emision_Comprobante)
        Cm.Parameters.AddWithValue("@pc_actualiza", pc_actualiza)
        Cm.ExecuteNonQuery()
    End Sub

    Public Sub Modificar_Nota_Devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Numero As String, ByVal Usuario As String, ByVal Nota As String,
                                         ByVal pc_actualiza As String)
        Dim Cm As New OleDb.OleDbCommand
        Cm.CommandTimeout = 0
        Cm.Connection = Cn
        Cm.CommandType = CommandType.StoredProcedure
        Cm.CommandText = "usp_Actualiza_Nota_Devengado"
        Cm.Parameters.AddWithValue("@Año_Ejecucion", Año_Ejecucion)
        Cm.Parameters.AddWithValue("@Numero", Numero)
        Cm.Parameters.AddWithValue("@usuario", Usuario)
        Cm.Parameters.AddWithValue("@tipo_documento_devengar", Codigo_Tipo_Documento_Devengar)
        Cm.Parameters.AddWithValue("@Nota", Nota)
        Cm.Parameters.AddWithValue("@pc_actualiza", pc_actualiza)
        Cm.ExecuteNonQuery()
    End Sub

    Public Sub Obtiene_Nota_devengado(ByVal Codigo_Tipo_Documento_Devengar As String, ByVal Año_Ejecucion As String, ByVal Numero As String)

    End Sub

End Class



